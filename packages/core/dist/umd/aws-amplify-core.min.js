/*! For license information please see aws-amplify-core.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("aws_amplify_core",[],t):"object"==typeof exports?exports.aws_amplify_core=t():e.aws_amplify_core=t()}(this,(()=>(()=>{"use strict";var e,t={d:(e,n)=>{for(var i in n)t.o(n,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:n[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},n={};t.r(n),t.d(n,{Amplify:()=>z,AmplifyClassV6:()=>D,Cache:()=>Ct,ConsoleLogger:()=>r,CookieStorage:()=>En,Hub:()=>u,I18n:()=>xt,ServiceWorker:()=>In,clearCredentials:()=>j,cognitoIdentityPoolEndpointResolver:()=>it,createGetCredentialsForIdentityClient:()=>Je,createGetIdClient:()=>Ze,decodeJWT:()=>l,defaultStorage:()=>ut,fetchAuthSession:()=>W,sessionStorage:()=>dt,sharedInMemoryStorage:()=>lt}),function(e){e.DEBUG="DEBUG",e.ERROR="ERROR",e.INFO="INFO",e.WARN="WARN",e.VERBOSE="VERBOSE",e.NONE="NONE"}(e||(e={}));const i={VERBOSE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,NONE:6};class r{constructor(t,n=e.WARN){this.name=t,this.level=n,this._pluggables=[]}_padding(e){return e<10?"0"+e:""+e}_ts(){const e=new Date;return[this._padding(e.getMinutes()),this._padding(e.getSeconds())].join(":")+"."+e.getMilliseconds()}configure(e){return e?(this._config=e,this._config):this._config}_log(t,...n){let o=this.level;if(r.LOG_LEVEL&&(o=r.LOG_LEVEL),"undefined"!=typeof window&&window.LOG_LEVEL&&(o=window.LOG_LEVEL),!(i[t]>=i[o]))return;let s=console.log.bind(console);t===e.ERROR&&console.error&&(s=console.error.bind(console)),t===e.WARN&&console.warn&&(s=console.warn.bind(console)),r.BIND_ALL_LOG_LEVELS&&(t===e.INFO&&console.info&&(s=console.info.bind(console)),t===e.DEBUG&&console.debug&&(s=console.debug.bind(console)));const a=`[${t}] ${this._ts()} ${this.name}`;let c="";if(1===n.length&&"string"==typeof n[0])c=`${a} - ${n[0]}`,s(c);else if(1===n.length)c=`${a} ${n[0]}`,s(a,n[0]);else if("string"==typeof n[0]){let e=n.slice(1);1===e.length&&(e=e[0]),c=`${a} - ${n[0]} ${e}`,s(`${a} - ${n[0]}`,e)}else c=`${a} ${n}`,s(a,n);for(const e of this._pluggables){const t={message:c,timestamp:Date.now()};e.pushLogs([t])}}log(...t){this._log(e.INFO,...t)}info(...t){this._log(e.INFO,...t)}warn(...t){this._log(e.WARN,...t)}error(...t){this._log(e.ERROR,...t)}debug(...t){this._log(e.DEBUG,...t)}verbose(...t){this._log(e.VERBOSE,...t)}addPluggable(e){e&&"Logging"===e.getCategoryName()&&(this._pluggables.push(e),e.configure(this._config))}listPluggables(){return this._pluggables}}r.LOG_LEVEL=null,r.BIND_ALL_LOG_LEVELS=!1;class o extends Error{constructor({message:e,name:t,recoverySuggestion:n,underlyingError:i}){super(e),this.name=t,this.underlyingError=i,this.recoverySuggestion=n,this.constructor=o,Object.setPrototypeOf(this,o.prototype)}}const s="undefined"!=typeof Symbol?Symbol("amplify_default"):"@@amplify_default",a=new r("Hub");class c{constructor(e){this.listeners=new Map,this.protectedChannels=["core","auth","api","analytics","interactions","pubsub","storage","ui","xr"],this.name=e}_remove(e,t){const n=this.listeners.get(e);n?this.listeners.set(e,[...n.filter((({callback:e})=>e!==t))]):a.warn(`No listeners for ${e}`)}dispatch(e,t,n,i){"string"==typeof e&&this.protectedChannels.indexOf(e)>-1&&(i===s||a.warn(`WARNING: ${e} is protected and dispatching on it can have unintended consequences`));const r={channel:e,payload:{...t},source:n,patternInfo:[]};try{this._toListeners(r)}catch(e){a.error(e)}}listen(e,t,n="noname"){let i;if("function"!=typeof t)throw new o({name:"NoHubcallbackProvidedException",message:"No callback supplied to Hub"});i=t;let r=this.listeners.get(e);return r||(r=[],this.listeners.set(e,r)),r.push({name:n,callback:i}),()=>{this._remove(e,i)}}_toListeners(e){const{channel:t,payload:n}=e,i=this.listeners.get(t);i&&i.forEach((i=>{a.debug(`Dispatching to ${t} with `,n);try{i.callback(e)}catch(e){a.error(e)}}))}}const u=new c("__default__"),d=(new c("internal-hub"),{convert(e,t){let n=e;return t?.urlSafe&&(n=n.replace(/-/g,"+").replace(/_/g,"/")),(()=>{if("undefined"!=typeof window&&"function"==typeof window.atob)return window.atob;if("function"==typeof atob)return atob;throw new o({name:"Base64EncoderError",message:"Cannot resolve the `atob` function from the environment."})})()(n)}});function l(e){const t=e.split(".");if(3!==t.length)throw new Error("Invalid token");try{const n=t[1].replace(/-/g,"+").replace(/_/g,"/"),i=decodeURIComponent(d.convert(n).split("").map((e=>`%${`00${e.charCodeAt(0).toString(16)}`.slice(-2)}`)).join(""));return{toString:()=>e,payload:JSON.parse(i)}}catch(e){throw new Error("Invalid token payload")}}const h=e=>{const t=Reflect.ownKeys(e);for(const n of t){const t=e[n];(t&&"object"==typeof t||"function"==typeof t)&&h(t)}return Object.freeze(e)},g=Symbol("oauth-listener"),f=new r("parseAWSExports"),p={API_KEY:"apiKey",AWS_IAM:"iam",AMAZON_COGNITO_USER_POOLS:"userPool",OPENID_CONNECT:"oidc",NONE:"none",AWS_LAMBDA:"lambda",LAMBDA:"lambda"},y=e=>e?.split(",")??[],m=({domain:e,scope:t,redirectSignIn:n,redirectSignOut:i,responseType:r})=>({domain:e,scopes:t,redirectSignIn:y(n),redirectSignOut:y(i),responseType:r}),w=e=>e.map((e=>{const t=e.toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)}));const b={AMAZON_COGNITO_USER_POOLS:"userPool",API_KEY:"apiKey",AWS_IAM:"iam",AWS_LAMBDA:"lambda",OPENID_CONNECT:"oidc"};function v(e){return b[e]}const S={GOOGLE:"Google",LOGIN_WITH_AMAZON:"Amazon",FACEBOOK:"Facebook",SIGN_IN_WITH_APPLE:"Apple"};function _(e=[]){return e.reduce(((e,t)=>(void 0!==S[t]&&e.push(S[t]),e)),[])}function I(e){const t={};return e.forEach((({name:e,bucket_name:n,aws_region:i,paths:r})=>{if(e in t)throw new Error(`Duplicate friendly name found: ${e}. Name must be unique.`);t[e]={bucketName:n,region:i,paths:r}})),t}const C=e=>Object.keys(e).some((e=>e.startsWith("aws_")))?((e={})=>{if(!Object.prototype.hasOwnProperty.call(e,"aws_project_region"))throw new o({name:"InvalidParameterException",message:"Invalid config parameter.",recoverySuggestion:"Ensure passing the config object imported from  `amplifyconfiguration.json`."});const{aws_appsync_apiKey:t,aws_appsync_authenticationType:n,aws_appsync_graphqlEndpoint:i,aws_appsync_region:r,aws_bots_config:s,aws_cognito_identity_pool_id:a,aws_cognito_sign_up_verification_method:c,aws_cognito_mfa_configuration:u,aws_cognito_mfa_types:d,aws_cognito_password_protection_settings:l,aws_cognito_verification_mechanisms:h,aws_cognito_signup_attributes:g,aws_cognito_social_providers:y,aws_cognito_username_attributes:b,aws_mandatory_sign_in:v,aws_mobile_analytics_app_id:S,aws_mobile_analytics_app_region:_,aws_user_files_s3_bucket:I,aws_user_files_s3_bucket_region:C,aws_user_files_s3_dangerously_connect_to_http_endpoint_for_testing:A,aws_user_pools_id:E,aws_user_pools_web_client_id:k,geo:P,oauth:N,predictions:O,aws_cloud_logic_custom:R,Notifications:x,modelIntrospection:L}=e,U={};S&&(U.Analytics={Pinpoint:{appId:S,region:_}});const{InAppMessaging:T,Push:$}=x??{};if(T?.AWSPinpoint||$?.AWSPinpoint){if(T?.AWSPinpoint){const{appId:e,region:t}=T.AWSPinpoint;U.Notifications={InAppMessaging:{Pinpoint:{appId:e,region:t}}}}if($?.AWSPinpoint){const{appId:e,region:t}=$.AWSPinpoint;U.Notifications={...U.Notifications,PushNotification:{Pinpoint:{appId:e,region:t}}}}}if(Array.isArray(s)&&(U.Interactions={LexV1:Object.fromEntries(s.map((e=>[e.name,e])))}),i){const e=p[n];e||f.debug(`Invalid authentication type ${n}. Falling back to IAM.`),U.API={GraphQL:{endpoint:i,apiKey:t,region:r,defaultAuthMode:e??"iam"}},L&&(U.API.GraphQL.modelIntrospection=L)}const M=u?{status:u&&u.toLowerCase(),totpEnabled:d?.includes("TOTP")??!1,smsEnabled:d?.includes("SMS")??!1}:void 0,D=l?{minLength:l.passwordPolicyMinLength,requireLowercase:l.passwordPolicyCharacters?.includes("REQUIRES_LOWERCASE")??!1,requireUppercase:l.passwordPolicyCharacters?.includes("REQUIRES_UPPERCASE")??!1,requireNumbers:l.passwordPolicyCharacters?.includes("REQUIRES_NUMBERS")??!1,requireSpecialCharacters:l.passwordPolicyCharacters?.includes("REQUIRES_SYMBOLS")??!1}:void 0,z=Array.from(new Set([...h??[],...g??[]])).reduce(((e,t)=>({...e,[t.toLowerCase()]:{required:!0}})),{}),W=b?.includes("EMAIL")??!1,j=b?.includes("PHONE_NUMBER")??!1;(a||E)&&(U.Auth={Cognito:{identityPoolId:a,allowGuestAccess:"enable"!==v,signUpVerificationMethod:c,userAttributes:z,userPoolClientId:k,userPoolId:E,mfa:M,passwordFormat:D,loginWith:{username:!(W||j),email:W,phone:j}}});const B=!!N&&Object.keys(N).length>0,V=!!y&&y.length>0;if(U.Auth&&B&&(U.Auth.Cognito.loginWith={...U.Auth.Cognito.loginWith,oauth:{...m(N),...V&&{providers:w(y)}}}),I&&(U.Storage={S3:{bucket:I,region:C,dangerouslyConnectToHttpEndpointForTesting:A}}),P){const{amazon_location_service:e}=P;U.Geo={LocationService:{maps:e.maps,geofenceCollections:e.geofenceCollections,searchIndices:e.search_indices,region:e.region}}}if(R&&(U.API={...U.API,REST:R.reduce(((e,t)=>{const{name:n,endpoint:i,region:r,service:o}=t;return{...e,[n]:{endpoint:i,...o?{service:o}:void 0,...r?{region:r}:void 0}}}),{})}),O){const{VoiceId:e}=O?.convert?.speechGenerator?.defaults??{};U.Predictions=e?{...O,convert:{...O.convert,speechGenerator:{...O.convert.speechGenerator,defaults:{voiceId:e}}}}:O}return U})(e):function(e){const{version:t}=e;return!!t&&t.startsWith("1")}(e)?function(e){const t={};if(e.storage&&(t.Storage=function(e){if(!e)return;const{bucket_name:t,aws_region:n,buckets:i}=e;return{S3:{bucket:t,region:n,buckets:i&&I(i)}}}(e.storage)),e.auth&&(t.Auth=function(e){if(!e)return;const{user_pool_id:t,user_pool_client_id:n,identity_pool_id:i,password_policy:r,mfa_configuration:o,mfa_methods:s,unauthenticated_identities_enabled:a,oauth:c,username_attributes:u,standard_required_attributes:d,groups:l}=e,h={Cognito:{userPoolId:t,userPoolClientId:n,groups:l}};return i&&(h.Cognito={...h.Cognito,identityPoolId:i}),r&&(h.Cognito.passwordFormat={requireLowercase:r.require_lowercase,requireNumbers:r.require_numbers,requireUppercase:r.require_uppercase,requireSpecialCharacters:r.require_symbols,minLength:r.min_length??6}),o&&(h.Cognito.mfa={status:(g=o,"OPTIONAL"===g?"optional":"REQUIRED"===g?"on":"off"),smsEnabled:s?.includes("SMS"),totpEnabled:s?.includes("TOTP")}),a&&(h.Cognito.allowGuestAccess=a),c&&(h.Cognito.loginWith={oauth:{domain:c.domain,redirectSignIn:c.redirect_sign_in_uri,redirectSignOut:c.redirect_sign_out_uri,responseType:"token"===c.response_type?"token":"code",scopes:c.scopes,providers:_(c.identity_providers)}}),u&&(h.Cognito.loginWith={...h.Cognito.loginWith,email:u.includes("email"),phone:u.includes("phone_number"),username:u.includes("username")}),d&&(h.Cognito.userAttributes=d.reduce(((e,t)=>({...e,[t]:{required:!0}})),{})),h;var g}(e.auth)),e.analytics&&(t.Analytics=function(e){if(!e?.amazon_pinpoint)return;const{amazon_pinpoint:t}=e;return{Pinpoint:{appId:t.app_id,region:t.aws_region}}}(e.analytics)),e.geo&&(t.Geo=function(e){if(!e)return;const{aws_region:t,geofence_collections:n,maps:i,search_indices:r}=e;return{LocationService:{region:t,searchIndices:r,geofenceCollections:n,maps:i}}}(e.geo)),e.data&&(t.API=function(e){if(!e)return;const{aws_region:t,default_authorization_type:n,url:i,api_key:r,model_introspection:o}=e;return{GraphQL:{endpoint:i,defaultAuthMode:v(n),region:t,apiKey:r,modelIntrospection:o}}}(e.data)),e.custom){const n=function(e){if(!e?.events)return;const{url:t,aws_region:n,api_key:i,default_authorization_type:r}=e.events;return{Events:{endpoint:t,defaultAuthMode:v(r),region:n,apiKey:i}}}(e.custom);n&&"Events"in n&&(t.API={...t.API,...n})}return e.notifications&&(t.Notifications=function(e){if(!e)return;const{aws_region:t,channels:n,amazon_pinpoint_app_id:i}=e,r=n.includes("IN_APP_MESSAGING"),o=n.includes("APNS")||n.includes("FCM");if(!r&&!o)return;const s={};return r&&(s.InAppMessaging={Pinpoint:{appId:i,region:t}}),o&&(s.PushNotification={Pinpoint:{appId:i,region:t}}),s}(e.notifications)),t}(e):e,A=new r("Auth");class E{configure(e,t){this.authConfig=e,this.authOptions=t,e.Cognito.userPoolEndpoint&&A.warn(k("Amazon Cognito User Pool")),e.Cognito.identityPoolEndpoint&&A.warn(k("Amazon Cognito Identity Pool"))}async fetchAuthSession(e={}){let t,n;const i=await this.getTokens(e);return i?(n=i.accessToken?.payload?.sub,t=await(this.authOptions?.credentialsProvider?.getCredentialsAndIdentityId({authConfig:this.authConfig,tokens:i,authenticated:!0,forceRefresh:e.forceRefresh}))):t=await(this.authOptions?.credentialsProvider?.getCredentialsAndIdentityId({authConfig:this.authConfig,authenticated:!1,forceRefresh:e.forceRefresh})),{tokens:i,credentials:t?.credentials,identityId:t?.identityId,userSub:n}}async clearCredentials(){await(this.authOptions?.credentialsProvider?.clearCredentialsAndIdentityId())}async getTokens(e){return await(this.authOptions?.tokenProvider?.getTokens(e))??void 0}}const k=e=>`You are using a custom Amazon ${e} endpoint, ensure the endpoint is correct.`;Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var P=64,N=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),O=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],R=Math.pow(2,53)-1,x=function(){function e(){this.state=Int32Array.from(O),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");var t=0,n=e.byteLength;if(this.bytesHashed+=n,8*this.bytesHashed>R)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;n>0;)this.buffer[this.bufferLength++]=e[t++],n--,this.bufferLength===P&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var e=8*this.bytesHashed,t=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(t.setUint8(this.bufferLength++,128),n%P>=56){for(var i=this.bufferLength;i<P;i++)t.setUint8(i,0);this.hashBuffer(),this.bufferLength=0}for(i=this.bufferLength;i<56;i++)t.setUint8(i,0);t.setUint32(56,Math.floor(e/4294967296),!0),t.setUint32(60,e),this.hashBuffer(),this.finished=!0}var r=new Uint8Array(32);for(i=0;i<8;i++)r[4*i]=this.state[i]>>>24&255,r[4*i+1]=this.state[i]>>>16&255,r[4*i+2]=this.state[i]>>>8&255,r[4*i+3]=this.state[i]>>>0&255;return r},e.prototype.hashBuffer=function(){for(var e=this.buffer,t=this.state,n=t[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],c=t[6],u=t[7],d=0;d<P;d++){if(d<16)this.temp[d]=(255&e[4*d])<<24|(255&e[4*d+1])<<16|(255&e[4*d+2])<<8|255&e[4*d+3];else{var l=this.temp[d-2],h=(l>>>17|l<<15)^(l>>>19|l<<13)^l>>>10,g=((l=this.temp[d-15])>>>7|l<<25)^(l>>>18|l<<14)^l>>>3;this.temp[d]=(h+this.temp[d-7]|0)+(g+this.temp[d-16]|0)}var f=(((s>>>6|s<<26)^(s>>>11|s<<21)^(s>>>25|s<<7))+(s&a^~s&c)|0)+(u+(N[d]+this.temp[d]|0)|0)|0,p=((n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10))+(n&i^n&r^i&r)|0;u=c,c=a,a=s,s=o+f|0,o=r,r=i,i=n,n=f+p|0}t[0]+=n,t[1]+=i,t[2]+=r,t[3]+=o,t[4]+=s,t[5]+=a,t[6]+=c,t[7]+=u},e}(),L="undefined"!=typeof Buffer&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:e=>(new TextEncoder).encode(e);function U(e){return e instanceof Uint8Array?e:"string"==typeof e?L(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}var T=function(){function e(e){this.secret=e,this.hash=new x,this.reset()}return e.prototype.update=function(e){var t;if(("string"==typeof(t=e)?0!==t.length:0!==t.byteLength)&&!this.error)try{this.hash.update(U(e))}catch(e){this.error=e}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return e=this,t=void 0,i=function(){return function(e,t){var n,i,r,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,(function(e){return[2,this.digestSync()]}))},new((n=void 0)||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(e){o(e)}}function a(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}));var e,t,n,i},e.prototype.reset=function(){if(this.hash=new x,this.secret){this.outer=new x;var e=function(e){var t=U(e);if(t.byteLength>P){var n=new x;n.update(t),t=n.digest()}var i=new Uint8Array(P);return i.set(t),i}(this.secret),t=new Uint8Array(P);t.set(e);for(var n=0;n<P;n++)e[n]^=54,t[n]^=92;for(this.hash.update(e),this.outer.update(t),n=0;n<e.byteLength;n++)e[n]=0}},e}();const $={},M={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();1===t.length&&(t=`0${t}`),$[e]=t,M[t]=e}class D{constructor(){this.oAuthListener=void 0,this.resourcesConfig={},this.libraryOptions={},this.Auth=new E}configure(e,t){const n=C(e);this.resourcesConfig=n,t&&(this.libraryOptions=t),this.resourcesConfig=h(this.resourcesConfig),this.Auth.configure(this.resourcesConfig.Auth,this.libraryOptions.Auth),u.dispatch("core",{event:"configure",data:this.resourcesConfig},"Configure",s),this.notifyOAuthListener()}getConfig(){return this.resourcesConfig}[g](e){this.resourcesConfig.Auth?.Cognito.loginWith?.oauth?e(this.resourcesConfig.Auth?.Cognito):this.oAuthListener=e}notifyOAuthListener(){this.resourcesConfig.Auth?.Cognito.loginWith?.oauth&&this.oAuthListener&&(this.oAuthListener(this.resourcesConfig.Auth?.Cognito),this.oAuthListener=void 0)}}const z=new D,W=e=>((e,t)=>e.Auth.fetchAuthSession(t))(z,e);function j(){return z.Auth.clearCredentials()}const B=e=>{const{headers:t,statusCode:n}=e;return{...V(e)?e.$metadata:{},httpStatusCode:n,requestId:t["x-amzn-requestid"]??t["x-amzn-request-id"]??t["x-amz-request-id"],extendedRequestId:t["x-amz-id-2"],cfId:t["x-amz-cf-id"]}},V=e=>"object"==typeof e?.$metadata,G=async e=>{if(!e||e.statusCode<300)return;const t=await q(e),n=(e=>{const[t]=e.toString().split(/[,:]+/);return t.includes("#")?t.split("#")[1]:t})(e.headers["x-amzn-errortype"]??t.code??t.__type??"UnknownError"),i=t.message??t.Message??"Unknown error",r=new Error(i);return Object.assign(r,{name:n,$metadata:B(e)})},q=async e=>{if(!e.body)throw new Error("Missing response payload");const t=await e.body.json();return Object.assign(t,{$metadata:B(e)})},F=(e,t,n,i)=>async(r,o)=>{const s={...i,...r},a=await s.endpointResolver(s,o),c=await t(o,a),u=await e(c,{...s});return n(u)};var K,J,H,Q,Z,Y,X,ee,te,ne,ie,re,oe,se;!function(e){e.WebUnknown="0",e.React="1",e.NextJs="2",e.Angular="3",e.VueJs="4",e.Nuxt="5",e.Svelte="6",e.ServerSideUnknown="100",e.ReactSSR="101",e.NextJsSSR="102",e.AngularSSR="103",e.VueJsSSR="104",e.NuxtSSR="105",e.SvelteSSR="106",e.ReactNative="201",e.Expo="202"}(K||(K={})),function(e){e.AI="ai",e.API="api",e.Auth="auth",e.Analytics="analytics",e.DataStore="datastore",e.Geo="geo",e.InAppMessaging="inappmessaging",e.Interactions="interactions",e.Predictions="predictions",e.PubSub="pubsub",e.PushNotification="pushnotification",e.Storage="storage"}(J||(J={})),function(e){e.CreateConversation="1",e.GetConversation="2",e.ListConversations="3",e.DeleteConversation="4",e.SendMessage="5",e.ListMessages="6",e.OnMessage="7",e.Generation="8",e.UpdateConversation="9"}(H||(H={})),function(e){e.Record="1",e.IdentifyUser="2"}(Q||(Q={})),function(e){e.GraphQl="1",e.Get="2",e.Post="3",e.Put="4",e.Patch="5",e.Del="6",e.Head="7"}(Z||(Z={})),function(e){e.SignUp="1",e.ConfirmSignUp="2",e.ResendSignUpCode="3",e.SignIn="4",e.FetchMFAPreference="6",e.UpdateMFAPreference="7",e.SetUpTOTP="10",e.VerifyTOTPSetup="11",e.ConfirmSignIn="12",e.DeleteUserAttributes="15",e.DeleteUser="16",e.UpdateUserAttributes="17",e.FetchUserAttributes="18",e.ConfirmUserAttribute="22",e.SignOut="26",e.UpdatePassword="27",e.ResetPassword="28",e.ConfirmResetPassword="29",e.FederatedSignIn="30",e.RememberDevice="32",e.ForgetDevice="33",e.FetchDevices="34",e.SendUserAttributeVerificationCode="35",e.SignInWithRedirect="36",e.StartWebAuthnRegistration="37",e.CompleteWebAuthnRegistration="38",e.ListWebAuthnCredentials="39",e.DeleteWebAuthnCredential="40"}(Y||(Y={})),function(e){e.Subscribe="1",e.GraphQl="2"}(X||(X={})),function(e){e.SearchByText="0",e.SearchByCoordinates="1",e.SearchForSuggestions="2",e.SearchByPlaceId="3",e.SaveGeofences="4",e.GetGeofence="5",e.ListGeofences="6",e.DeleteGeofences="7"}(ee||(ee={})),function(e){e.SyncMessages="1",e.IdentifyUser="2",e.NotifyMessageInteraction="3"}(te||(te={})),function(e){e.None="0"}(ne||(ne={})),function(e){e.Convert="1",e.Identify="2",e.Interpret="3"}(ie||(ie={})),function(e){e.Subscribe="1"}(re||(re={})),function(e){e.InitializePushNotifications="1",e.IdentifyUser="2"}(oe||(oe={})),function(e){e.UploadData="1",e.DownloadData="2",e.List="3",e.Copy="4",e.Remove="5",e.GetProperties="6",e.GetUrl="7",e.GetDataAccess="8",e.ListCallerAccessGrants="9"}(se||(se={}));const ae="6.10.2",ce=()=>"undefined"!=typeof global,ue=()=>"undefined"!=typeof window,de=()=>"undefined"!=typeof document,le=()=>"undefined"!=typeof process,he=(e,t)=>!!Object.keys(e).find((e=>e.startsWith(t))),ge=[{platform:K.Expo,detectionMethod:function(){return ce()&&void 0!==global.expo}},{platform:K.ReactNative,detectionMethod:function(){return"undefined"!=typeof navigator&&void 0!==navigator.product&&"ReactNative"===navigator.product}},{platform:K.NextJs,detectionMethod:function(){return ue()&&window.next&&"object"==typeof window.next}},{platform:K.Nuxt,detectionMethod:function(){return ue()&&(void 0!==window.__NUXT__||void 0!==window.$nuxt)}},{platform:K.Angular,detectionMethod:function(){const e=Boolean(de()&&document.querySelector("[ng-version]")),t=Boolean(ue()&&void 0!==window.ng);return e||t}},{platform:K.React,detectionMethod:function(){const e=e=>e.startsWith("_react")||e.startsWith("__react");return de()&&Array.from(document.querySelectorAll("[id]")).some((t=>Object.keys(t).find(e)))}},{platform:K.VueJs,detectionMethod:function(){return ue()&&he(window,"__VUE")}},{platform:K.Svelte,detectionMethod:function(){return ue()&&he(window,"__SVELTE")}},{platform:K.WebUnknown,detectionMethod:function(){return ue()}},{platform:K.NextJsSSR,detectionMethod:function(){return ce()&&(he(global,"__next")||he(global,"__NEXT"))}},{platform:K.NuxtSSR,detectionMethod:function(){return ce()&&void 0!==global.__NUXT_PATHS__}},{platform:K.ReactSSR,detectionMethod:function(){return le()&&void 0!==process.env&&!!Object.keys(process.env).find((e=>e.includes("react")))}},{platform:K.VueJsSSR,detectionMethod:function(){return ce()&&he(global,"__VUE")}},{platform:K.AngularSSR,detectionMethod:function(){return le()&&"object"==typeof process.env&&process.env.npm_lifecycle_script?.startsWith("ng ")||!1}},{platform:K.SvelteSSR,detectionMethod:function(){return le()&&void 0!==process.env&&!!Object.keys(process.env).find((e=>e.includes("svelte")))}}];let fe;const pe=[];let ye=!1;const me=()=>{if(!fe){if(fe=ge.find((e=>e.detectionMethod()))?.platform||K.ServerSideUnknown,ye)for(;pe.length;)pe.pop()?.();else pe.forEach((e=>{e()}));we(K.ServerSideUnknown,10),we(K.WebUnknown,10)}return fe};function we(e,t){fe!==e||ye||setTimeout((()=>{fe=void 0,ye=!0,setTimeout(me,1e3)}),t)}const be={},ve="aws-amplify",Se=e=>e.replace(/\+.*/,"");new class{constructor(){this.userAgent=`${ve}/${Se(ae)}`}get framework(){return me()}get isReactNative(){return this.framework===K.ReactNative||this.framework===K.Expo}observeFrameworkChanges(e){(e=>{ye||pe.push(e)})(e)}};const _e=e=>(({category:e,action:t}={})=>{const n=[[ve,Se(ae)]];if(e&&n.push([e,t]),n.push(["framework",me()]),e&&t){const i=((e,t)=>be[e]?.[t]?.additionalDetails)(e,t);i&&i.forEach((e=>{n.push(e)}))}return n})(e).map((([e,t])=>e&&t?`${e}/${t}`:e)).join(" "),Ie=3e5,Ce=e=>{const t=function(e=3e5){return t=>{const n=2**t*100+100*Math.random();return!(n>e)&&n}}(Ie),n=t(e);return!1===n?Ie:n};var Ae;!function(e){e.NoEndpointId="NoEndpointId",e.PlatformNotSupported="PlatformNotSupported",e.Unknown="Unknown",e.NetworkError="NetworkError"}(Ae||(Ae={}));const Ee=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch","BadRequestException"],ke=e=>async(t,n)=>{const i=n??await e(t)??void 0,r=i?.code||i?.name,o=t?.statusCode;return{retryable:Re(n)||Oe(o,r)||(e=>!!e&&Ee.includes(e))(r)||xe(o,r)}},Pe=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException"],Ne=["TimeoutError","RequestTimeout","RequestTimeoutException"],Oe=(e,t)=>429===e||!!t&&Pe.includes(t),Re=e=>[Ae.NetworkError,"ERR_NETWORK"].includes(e?.name),xe=(e,t)=>!!e&&[500,502,503,504].includes(e)||!!t&&Ne.includes(t),Le="cognito-identity",Ue={service:Le,retryDecider:ke(G),computeDelay:Ce,cache:"no-store"},Te=({maxAttempts:e=3,retryDecider:t,computeDelay:n,abortSignal:i})=>{if(e<1)throw new Error("maxAttempts must be greater than 0");return(r,o)=>async function(s){let a,c,u=o.attemptsCount??0;const d=()=>{if(c)return Me(c,u),c;throw Me(a,u),a};for(;!i?.aborted&&u<e;){try{c=await r(s),a=void 0}catch(e){a=e,c=void 0}u=(o.attemptsCount??0)>u?o.attemptsCount??0:u+1,o.attemptsCount=u;const{isCredentialsExpiredError:l,retryable:h}=await t(c,a,o);if(!h)return d();if(o.isCredentialsExpired=!!l,!i?.aborted&&u<e){const e=n(u);await $e(e,i)}}if(i?.aborted)throw new Error("Request aborted.");return d()}},$e=(e,t)=>{if(t?.aborted)return Promise.resolve();let n,i;const r=new Promise((t=>{i=t,n=setTimeout(t,e)}));return t?.addEventListener("abort",(function e(r){clearTimeout(n),t?.removeEventListener("abort",e),i()})),r},Me=(e,t)=>{"[object Object]"===Object.prototype.toString.call(e)&&(e.$metadata={...e.$metadata??{},attempts:t})},De=({userAgentHeader:e="x-amz-user-agent",userAgentValue:t=""})=>n=>async function(i){if(0===t.trim().length)return await n(i);{const r=e.toLowerCase();return i.headers[r]=i.headers[r]?`${i.headers[r]} ${t}`:t,await n(i)}},ze=(e,t)=>(n,i)=>{const r={};let o=t=>e(t,i);for(let e=t.length-1;e>=0;e--)o=(0,t[e])(i)(o,r);return o(n)},We=e=>{let t;return()=>(t||(t=e()),t)},je=e=>!["HEAD","GET","DELETE"].includes(e.toUpperCase()),Be=async({url:e,method:t,headers:n,body:i},{abortSignal:r,cache:s,withCrossDomainCredentials:a})=>{let c;try{c=await fetch(e,{method:t,headers:n,body:je(t)?i:void 0,signal:r,cache:s,credentials:a?"include":"same-origin"})}catch(e){if(e instanceof TypeError)throw new o({name:Ae.NetworkError,message:"A network error has occurred.",underlyingError:e});throw e}const u={};return c.headers?.forEach(((e,t)=>{u[t.toLowerCase()]=e})),{statusCode:c.status,headers:u,body:null,body:Object.assign(c.body??{},{text:We((()=>c.text())),blob:We((()=>c.blob())),json:We((()=>c.json()))})}},Ve=ze(Be,[De,Te]),Ge=ze(Ve,[()=>e=>async function(t){return t.headers["cache-control"]="no-store",e(t)}]),qe=e=>(t,n)=>{const i=Fe(e),r=JSON.stringify(t);return Ke(n,i,r)},Fe=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityService.${e}`}),Ke=({url:e},t,n)=>({headers:t,url:e,body:n,method:"POST"}),Je=e=>F(Ge,qe("GetCredentialsForIdentity"),He,{...Ue,...e,userAgentValue:_e()}),He=async e=>{if(e.statusCode>=300)throw await G(e);{const t=await q(e);return{IdentityId:t.IdentityId,Credentials:Qe(t.Credentials),$metadata:B(e)}}},Qe=({Expiration:e,...t}={})=>({...t,Expiration:e&&new Date(1e3*e)}),Ze=e=>F(Ge,qe("GetId"),Ye,{...Ue,...e,userAgentValue:_e()}),Ye=async e=>{if(e.statusCode>=300)throw await G(e);return{IdentityId:(await q(e)).IdentityId,$metadata:B(e)}},Xe={id:"aws",outputs:{dnsSuffix:"amazonaws.com"},regionRegex:"^(us|eu|ap|sa|ca|me|af)\\-\\w+\\-\\d+$",regions:["aws-global"]},et={partitions:[Xe,{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn"},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:["aws-cn-global"]}]},tt=e=>{const{partitions:t}=et;for(const{regions:n,outputs:i,regionRegex:r}of t){const t=new RegExp(r);if(n.includes(e)||t.test(e))return i.dnsSuffix}return Xe.outputs.dnsSuffix},nt=URL,it=({region:e})=>({url:new nt(`https://${Le}.${e}.${tt(e)}`)});class rt extends o{constructor(){super({name:Ae.PlatformNotSupported,message:"Function not supported on current platform"})}}class ot{constructor(e){this.storage=e}async setItem(e,t){if(!this.storage)throw new rt;this.storage.setItem(e,t)}async getItem(e){if(!this.storage)throw new rt;return this.storage.getItem(e)}async removeItem(e){if(!this.storage)throw new rt;this.storage.removeItem(e)}async clear(){if(!this.storage)throw new rt;this.storage.clear()}}class st{constructor(){this.storage=new Map}get length(){return this.storage.size}key(e){return e>this.length-1?null:Array.from(this.storage.keys())[e]}setItem(e,t){this.storage.set(e,t)}getItem(e){return this.storage.get(e)??null}removeItem(e){this.storage.delete(e)}clear(){this.storage.clear()}}const at=new r("CoreStorageUtils"),ct=()=>{try{if("undefined"!=typeof window&&window.localStorage)return window.localStorage}catch(e){at.info("localStorage not found. InMemoryStorage is used as a fallback.")}return new st},ut=new class extends ot{constructor(){super(ct())}},dt=new class extends ot{constructor(){super((()=>{try{if("undefined"!=typeof window&&window.sessionStorage)return window.sessionStorage.getItem("test"),window.sessionStorage;throw new Error("sessionStorage is not defined")}catch(e){return at.info("sessionStorage not found. InMemoryStorage is used as a fallback."),new st}})())}},lt=new ot(new st),ht={keyPrefix:"aws-amplify-cache",capacityInBytes:1048576,itemMaxSize:21e4,defaultTTL:2592e5,defaultPriority:5,warningThreshold:.8},gt="CurSize";function ft(e){let t=0;t=e.length;for(let n=e.length;n>=0;n-=1){const i=e.charCodeAt(n);i>127&&i<=2047?t+=1:i>2047&&i<=65535&&(t+=2),i>=56320&&i<=57343&&(n-=1)}return t}function pt(){return(new Date).getTime()}const yt=e=>`${e}${gt}`,mt=(e,t=o)=>(n,i,r)=>{const{message:o,recoverySuggestion:s}=e[i];if(!n)throw new t({name:i,message:r?`${o} ${r}`:o,recoverySuggestion:s})};var wt;!function(e){e.NoCacheItem="NoCacheItem",e.NullNextNode="NullNextNode",e.NullPreviousNode="NullPreviousNode"}(wt||(wt={}));const bt=mt({[wt.NoCacheItem]:{message:"Item not found in the cache storage."},[wt.NullNextNode]:{message:"Next node is null."},[wt.NullPreviousNode]:{message:"Previous node is null."}}),vt=new r("StorageCache");class St{constructor({config:e,keyValueStorage:t}){this.config={...ht,...e},this.keyValueStorage=t,this.sanitizeConfig()}getModuleName(){return"Cache"}configure(e){return e&&(e.keyPrefix&&vt.warn("keyPrefix can not be re-configured on an existing Cache instance."),this.config={...this.config,...e}),this.sanitizeConfig(),this.config}async getCurrentCacheSize(){let e=await this.getStorage().getItem(yt(this.config.keyPrefix));return e||(await this.getStorage().setItem(yt(this.config.keyPrefix),"0"),e="0"),Number(e)}async setItem(e,t,n){if(vt.debug(`Set item: key is ${e}, value is ${t} with options: ${n}`),!e||e===gt)return void vt.warn(`Invalid key: should not be empty or reserved key: '${gt}'`);if(void 0===t)return void vt.warn("The value of item should not be undefined!");const i={priority:void 0!==n?.priority?n.priority:this.config.defaultPriority,expires:void 0!==n?.expires?n.expires:this.config.defaultTTL+pt()};if(i.priority<1||i.priority>5)return void vt.warn("Invalid parameter: priority due to out or range. It should be within 1 and 5.");const r=`${this.config.keyPrefix}${e}`,o=this.fillCacheItem(r,t,i);if(o.byteSize>this.config.itemMaxSize)vt.warn(`Item with key: ${e} you are trying to put into is too big!`);else try{const e=await this.getStorage().getItem(r);if(e&&await this.removeCacheItem(r,JSON.parse(e).byteSize),await this.isCacheFull(o.byteSize)){const e=await this.clearInvalidAndGetRemainingKeys();if(await this.isCacheFull(o.byteSize)){const t=await this.sizeToPop(o.byteSize);await this.popOutItems(e,t)}}return this.setCacheItem(r,o)}catch(e){vt.warn(`setItem failed! ${e}`)}}async getItem(e,t){let n;if(vt.debug(`Get item: key is ${e} with options ${t}`),!e||e===gt)return vt.warn(`Invalid key: should not be empty or reserved key: '${gt}'`),null;const i=`${this.config.keyPrefix}${e}`;try{if(n=await this.getStorage().getItem(i),null!=n){if(!await this.isExpired(i))return(await this.updateVisitedTime(JSON.parse(n),i)).data;await this.removeCacheItem(i,JSON.parse(n).byteSize)}if(t?.callback){const n=t.callback();return null!==n&&await this.setItem(e,n,t),n}return null}catch(e){return vt.warn(`getItem failed! ${e}`),null}}async removeItem(e){if(vt.debug(`Remove item: key is ${e}`),!e||e===gt)return void vt.warn(`Invalid key: should not be empty or reserved key: '${gt}'`);const t=`${this.config.keyPrefix}${e}`;try{const e=await this.getStorage().getItem(t);e&&await this.removeCacheItem(t,JSON.parse(e).byteSize)}catch(e){vt.warn(`removeItem failed! ${e}`)}}async getAllKeys(){try{return await this.getAllCacheKeys()}catch(e){return vt.warn(`getAllkeys failed! ${e}`),[]}}getStorage(){return this.keyValueStorage}async isExpired(e){const t=await this.getStorage().getItem(e);bt(null!==t,wt.NoCacheItem,`Key: ${e}`);const n=JSON.parse(t);return pt()>=n.expires}async removeCacheItem(e,t){const n=await this.getStorage().getItem(e);bt(null!==n,wt.NoCacheItem,`Key: ${e}`);const i=t??JSON.parse(n).byteSize;await this.decreaseCurrentSizeInBytes(i);try{await this.getStorage().removeItem(e)}catch(e){await this.increaseCurrentSizeInBytes(i),vt.error(`Failed to remove item: ${e}`)}}fillCacheItem(e,t,n){const i={key:e,data:t,timestamp:pt(),visitedTime:pt(),priority:n.priority??0,expires:n.expires??0,type:typeof t,byteSize:0};return i.byteSize=ft(JSON.stringify(i)),i.byteSize=ft(JSON.stringify(i)),i}sanitizeConfig(){this.config.itemMaxSize>this.config.capacityInBytes&&(vt.error("Invalid parameter: itemMaxSize. It should be smaller than capacityInBytes. Setting back to default."),this.config.itemMaxSize=ht.itemMaxSize),(this.config.defaultPriority>5||this.config.defaultPriority<1)&&(vt.error("Invalid parameter: defaultPriority. It should be between 1 and 5. Setting back to default."),this.config.defaultPriority=ht.defaultPriority),(Number(this.config.warningThreshold)>1||Number(this.config.warningThreshold)<0)&&(vt.error("Invalid parameter: warningThreshold. It should be between 0 and 1. Setting back to default."),this.config.warningThreshold=ht.warningThreshold),this.config.capacityInBytes>5242880&&(vt.error("Cache Capacity should be less than 5MB. Setting back to default. Setting back to default."),this.config.capacityInBytes=ht.capacityInBytes)}async increaseCurrentSizeInBytes(e){const t=await this.getCurrentCacheSize();await this.getStorage().setItem(yt(this.config.keyPrefix),(t+e).toString())}async decreaseCurrentSizeInBytes(e){const t=await this.getCurrentCacheSize();await this.getStorage().setItem(yt(this.config.keyPrefix),(t-e).toString())}async updateVisitedTime(e,t){return e.visitedTime=pt(),await this.getStorage().setItem(t,JSON.stringify(e)),e}async setCacheItem(e,t){await this.increaseCurrentSizeInBytes(t.byteSize);try{await this.getStorage().setItem(e,JSON.stringify(t))}catch(e){await this.decreaseCurrentSizeInBytes(t.byteSize),vt.error(`Failed to set item ${e}`)}}async sizeToPop(e){const t=await this.getCurrentCacheSize()+e-this.config.capacityInBytes,n=(1-this.config.warningThreshold)*this.config.capacityInBytes;return t>n?t:n}async isCacheFull(e){return e+await this.getCurrentCacheSize()>this.config.capacityInBytes}async popOutItems(e,t){const n=[];let i=t;for(const t of e){const e=await this.getStorage().getItem(t);if(null!=e){const t=JSON.parse(e);n.push(t)}}n.sort(((e,t)=>e.priority>t.priority?-1:e.priority<t.priority?1:e.visitedTime<t.visitedTime?-1:1));for(const e of n)if(await this.removeCacheItem(e.key,e.byteSize),i-=e.byteSize,i<=0)return}async clearInvalidAndGetRemainingKeys(){const e=[],t=await this.getAllCacheKeys({omitSizeKey:!0});for(const n of t)await this.isExpired(n)?await this.removeCacheItem(n):e.push(n);return e}async clear(){vt.debug("Clear Cache");try{const e=await this.getAllKeys();for(const t of e){const e=`${this.config.keyPrefix}${t}`;await this.getStorage().removeItem(e)}}catch(e){vt.warn(`clear failed! ${e}`)}}}const _t=new r("StorageCache");class It extends St{constructor(e){const t=ct();super({config:e,keyValueStorage:new ot(t)}),this.storage=t,this.getItem=this.getItem.bind(this),this.setItem=this.setItem.bind(this),this.removeItem=this.removeItem.bind(this)}async getAllCacheKeys(e){const{omitSizeKey:t}=e??{},n=[];for(let e=0;e<this.storage.length;e++){const i=this.storage.key(e);t&&i===yt(this.config.keyPrefix)||i?.startsWith(this.config.keyPrefix)&&n.push(i.substring(this.config.keyPrefix.length))}return n}createInstance(e){return e.keyPrefix&&e.keyPrefix!==ht.keyPrefix||(_t.error("invalid keyPrefix, setting keyPrefix with timeStamp"),e.keyPrefix=pt.toString()),new It(e)}}const Ct=new It,At=new r("I18n");let Et=class{constructor(){this._options=null,this._lang=null,this._dict={}}setDefaultLanguage(){!this._lang&&"undefined"!=typeof window&&window&&window.navigator&&(this._lang=window.navigator.language),At.debug(this._lang)}setLanguage(e){this._lang=e}get(e,t=void 0){if(this.setDefaultLanguage(),!this._lang)return void 0!==t?t:e;const n=this._lang;let i=this.getByLanguage(e,n);return i||(n.indexOf("-")>0&&(i=this.getByLanguage(e,n.split("-")[0])),i||(void 0!==t?t:e))}getByLanguage(e,t,n=null){if(!t)return n;const i=this._dict[t];return i?i[e]:n}putVocabulariesForLanguage(e,t){let n=this._dict[e];n||(n=this._dict[e]={}),this._dict[e]={...n,...t}}putVocabularies(e){Object.keys(e).forEach((t=>{this.putVocabulariesForLanguage(t,e[t])}))}};var kt;!function(e){e.NotConfigured="NotConfigured"}(kt||(kt={}));const Pt=mt({[kt.NotConfigured]:{message:"i18n is not configured."}}),Nt=new r("I18n");let Ot={language:null},Rt=null;class xt{static configure(e){return Nt.debug("configure I18n"),e?(Ot=Object.assign({},Ot,e.I18n||e),xt.createInstance(),Ot):Ot}static getModuleName(){return"I18n"}static createInstance(){Nt.debug("create I18n instance"),Rt||(Rt=new Et)}static setLanguage(e){xt.checkConfig(),Pt(!!Rt,kt.NotConfigured),Rt.setLanguage(e)}static get(e,t){return xt.checkConfig()?(Pt(!!Rt,kt.NotConfigured),Rt.get(e,t)):void 0===t?e:t}static putVocabulariesForLanguage(e,t){xt.checkConfig(),Pt(!!Rt,kt.NotConfigured),Rt.putVocabulariesForLanguage(e,t)}static putVocabularies(e){xt.checkConfig(),Pt(!!Rt,kt.NotConfigured),Rt.putVocabularies(e)}static checkConfig(){return Rt||xt.createInstance(),!0}}xt.createInstance();const Lt={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let Ut;const Tt=new Uint8Array(16);function $t(){if(!Ut&&(Ut="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Ut))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ut(Tt)}const Mt=[];for(let e=0;e<256;++e)Mt.push((e+256).toString(16).slice(1));const Dt=function(e,t,n){if(Lt.randomUUID&&!t&&!e)return Lt.randomUUID();const i=(e=e||{}).random||(e.rng||$t)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=i[e];return t}return function(e,t=0){return Mt[e[t+0]]+Mt[e[t+1]]+Mt[e[t+2]]+Mt[e[t+3]]+"-"+Mt[e[t+4]]+Mt[e[t+5]]+"-"+Mt[e[t+6]]+Mt[e[t+7]]+"-"+Mt[e[t+8]]+Mt[e[t+9]]+"-"+Mt[e[t+10]]+Mt[e[t+11]]+Mt[e[t+12]]+Mt[e[t+13]]+Mt[e[t+14]]+Mt[e[t+15]]}(i)},zt=mt({[Ae.NoEndpointId]:{message:"Endpoint ID was not found and was unable to be created."},[Ae.PlatformNotSupported]:{message:"Function not supported on current platform."},[Ae.Unknown]:{message:"An unknown error occurred."},[Ae.NetworkError]:{message:"A network error has occurred."}}),Wt=new r("getClientInfo");const jt=e=>Object.keys(e).map((e=>e.toLowerCase())).sort().join(";"),Bt="X-Amz-Date".toLowerCase(),Vt="X-Amz-Security-Token".toLowerCase(),Gt="aws4_request",qt="AWS4-HMAC-SHA256",Ft=(e,t)=>{const n=new T(e??void 0);return n.update(t),n.digestSync()},Kt=(e,t)=>function(e){let t="";for(let n=0;n<e.byteLength;n++)t+=$[e[n]];return t}(Ft(e,t)),Jt=e=>Object.entries(e).map((([e,t])=>({key:e.toLowerCase(),value:t?.trim().replace(/\s+/g," ")??""}))).sort(((e,t)=>e.key<t.key?-1:1)).map((e=>`${e.key}:${e.value}\n`)).join(""),Ht=e=>encodeURIComponent(e).replace(/[!'()*]/g,Qt),Qt=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`,Zt=(e,t=!0)=>e?t?encodeURIComponent(e).replace(/%2F/g,"/"):e:"/",Yt=e=>null==e?"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855":Xt(e)?Kt(null,e):"UNSIGNED-PAYLOAD",Xt=e=>"string"==typeof e||ArrayBuffer.isView(e)||en(e),en=e=>"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(e),tn=e=>new Date(Date.now()+e),nn=ze(Be,[De,Te,({credentials:e,region:t,service:n,uriEscapePath:i=!0})=>{let r;return(o,s)=>async function(a){r=r??0;const c={credentials:"function"==typeof e?await e({forceRefresh:!!s?.isCredentialsExpired}):e,signingDate:tn(r),signingRegion:t,signingService:n,uriEscapePath:i},u=await((e,t)=>{const n=(({credentials:e,signingDate:t=new Date,signingRegion:n,signingService:i,uriEscapePath:r=!0})=>{const{accessKeyId:o,secretAccessKey:s,sessionToken:a}=e,{longDate:c,shortDate:u}=(e=>{const t=e.toISOString().replace(/[:-]|\.\d{3}/g,"");return{longDate:t,shortDate:t.slice(0,8)}})(t);return{accessKeyId:o,credentialScope:`${u}/${n}/${i}/${Gt}`,longDate:c,secretAccessKey:s,sessionToken:a,shortDate:u,signingRegion:n,signingService:i,uriEscapePath:r}})(t),{accessKeyId:i,credentialScope:r,longDate:o,sessionToken:s}=n,a={...e.headers};a.host=e.url.host,a[Bt]=o,s&&(a[Vt]=s);const c={...e,headers:a},u=((e,{credentialScope:t,longDate:n,secretAccessKey:i,shortDate:r,signingRegion:o,signingService:s,uriEscapePath:a})=>{const c=(({body:e,headers:t,method:n,url:i},r=!0)=>{return[n,Zt(i.pathname,r),(o=i.searchParams,Array.from(o).sort((([e,t],[n,i])=>e===n?t<i?-1:1:e<n?-1:1)).map((([e,t])=>`${Ht(e)}=${Ht(t)}`)).join("&")),Jt(t),jt(t),Yt(e)].join("\n");var o})(e,a),u=((e,t,n)=>[qt,e,t,n].join("\n"))(n,t,Kt(null,c)),d=Kt(((e,t,n,i)=>{const r=Ft(`AWS4${e}`,t),o=Ft(r,n),s=Ft(o,i);return Ft(s,Gt)})(i,r,o,s),u);return d})(c,n),d=`Credential=${i}/${r}`,l=`SignedHeaders=${jt(a)}`,h=`Signature=${u}`;return a.authorization=`${qt} ${d}, ${l}, ${h}`,c})(a,c),d=await o(u),l=(({headers:e}={})=>e?.date??e?.Date??e?.["x-amz-date"])(d);return l&&(r=((e,t)=>((e,t)=>Math.abs(tn(t).getTime()-e)>=3e5)(e,t)?e-Date.now():t)(Date.parse(l),r)),d}}]),rn=e=>encodeURIComponent(e).replace(/[!'()*]/g,on),on=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`,sn={service:"mobiletargeting",endpointResolver:({region:e})=>({url:new nt(`https://pinpoint.${e}.${tt(e)}`)}),retryDecider:ke(G),computeDelay:Ce,userAgentValue:_e()},an=F(nn,(({ApplicationId:e="",EndpointId:t="",EndpointRequest:n},i)=>{const r=new nt(i.url);return r.pathname=`v1/apps/${rn(e)}/endpoints/${rn(t)}`,{method:"PUT",headers:{"content-type":"application/json"},url:r,body:JSON.stringify(n)}}),(async e=>{if(e.statusCode>=300)throw await G(e);{const{Message:t,RequestID:n}=await q(e);return{MessageBody:{Message:t,RequestID:n},$metadata:B(e)}}}),sn),cn=(e,t)=>`${t}:pinpoint:${e}`,un={},dn=async(e,t)=>{const n=cn(e,t);return await Ct.getItem(n)??void 0},ln=async({address:e,appId:t,category:n,channelType:i,credentials:r,identityId:o,optOut:s,region:a,userAttributes:c,userId:u,userProfile:d,userAgentValue:l})=>{const h=await dn(t,n),g=h?void 0:((e,t)=>{const n=cn(e,t);return un[n]||(un[n]=Dt()),un[n]})(t,n),{customProperties:f,demographic:p,email:y,location:m,metrics:w,name:b,plan:v}=d??{},S={},_=g?u??o:u;if(g){const e="undefined"==typeof window?{}:function(){if("undefined"==typeof window)return Wt.warn("No window object available to get browser client info"),{};const e=window.navigator;if(!e)return Wt.warn("No navigator object available to get browser client info"),{};const{platform:t,product:n,vendor:i,userAgent:r,language:o}=e,s=function(e){const t=/.+(Opera[\s[A-Z]*|OPR[\sA-Z]*)\/([0-9.]+).*/i.exec(e);if(t)return{type:t[1],version:t[2]};const n=/.+(Trident|Edge|Edg|EdgA|EdgiOS)\/([0-9.]+).*/i.exec(e);if(n)return{type:n[1],version:n[2]};const i=/.+(Chrome|CriOS|Firefox|FxiOS)\/([0-9.]+).*/i.exec(e);if(i)return{type:i[1],version:i[2]};const r=/.+(Safari)\/([0-9.]+).*/i.exec(e);if(r)return{type:r[1],version:r[2]};const o=/.+(AppleWebKit)\/([0-9.]+).*/i.exec(e);if(o)return{type:o[1],version:o[2]};const s=/.*([A-Z]+)\/([0-9.]+).*/i.exec(e);return s?{type:s[1],version:s[2]}:{type:"",version:""}}(r),a=function(){const e=/\(([A-Za-z\s].*)\)/.exec((new Date).toString());return e&&e[1]||""}();return{platform:t,make:n||i,model:s.type,version:s.version,appVersion:[s.type,s.version].join("/"),language:o,timezone:a}}();S.appVersion=e.appVersion,S.make=e.make,S.model=e.model,S.modelVersion=e.version,S.platform=e.platform}const I={...S,...p},C={...y&&{email:[y]},...b&&{name:[b]},...v&&{plan:[v]},...f},A=g||p,E=y||f||b||v,k=_||c,P={ApplicationId:t,EndpointId:h??g,EndpointRequest:{RequestId:Dt(),EffectiveDate:(new Date).toISOString(),ChannelType:i,Address:e,...E&&{Attributes:C},...A&&{Demographic:{AppVersion:I.appVersion,Locale:I.locale,Make:I.make,Model:I.model,ModelVersion:I.modelVersion,Platform:I.platform,PlatformVersion:I.platformVersion,Timezone:I.timezone}},...m&&{Location:{City:m.city,Country:m.country,Latitude:m.latitude,Longitude:m.longitude,PostalCode:m.postalCode,Region:m.region}},Metrics:w,OptOut:s,...k&&{User:{UserId:_,UserAttributes:c}}}};try{await an({credentials:r,region:a,userAgentValue:l},P),g&&await(async(e,t,n)=>{const i=cn(e,t),r=(new Date).getTime()+31536e8;return Ct.setItem(i,n,{expires:r,priority:1})})(t,n,g)}finally{g&&((e,t)=>{const n=cn(e,t);delete un[n]})(t,n)}};var hn;!function(e){e.NoAppId="NoAppId"}(hn||(hn={}));const gn=mt({[hn.NoAppId]:{message:"Missing application id."}}),fn=F(nn,(({ApplicationId:e,EventsRequest:t},n)=>{gn(!!e,hn.NoAppId);const i=new nt(n.url);return i.pathname=`v1/apps/${rn(e)}/events`,{method:"POST",headers:{"content-type":"application/json"},url:i,body:JSON.stringify(t??{})}}),(async e=>{if(e.statusCode>=300)throw await G(e);{const{Results:t}=await q(e);return{EventsResponse:{Results:t},$metadata:B(e)}}}),sn),pn=new r("PinpointEventBuffer"),yn=[429,500],mn=[202];class wn{constructor(e){this._interval=void 0,this._pause=!1,this._flush=!1,this._buffer=[],this._config=e,this._sendBatch=this._sendBatch.bind(this),this._startLoop()}push(e){this._buffer.length>=this._config.bufferSize?pn.debug("Exceeded Pinpoint event buffer limits, event dropped.",{eventId:e.eventId}):this._buffer.push({[e.eventId]:e})}pause(){this._pause=!0}resume(){this._pause=!1}flush(){this._flush=!0}identityHasChanged(e){return this._config.identityId!==e}flushAll(){this._putEvents(this._buffer.splice(0,this._buffer.length))}_startLoop(){this._interval&&clearInterval(this._interval);const{flushInterval:e}=this._config;this._interval=setInterval(this._sendBatch,e)}_sendBatch(){const e=this._buffer.length;if(this._flush&&!e&&this._interval&&clearInterval(this._interval),this._pause||!e)return;const{flushSize:t}=this._config,n=Math.min(t,e),i=this._buffer.splice(0,n);this._putEvents(i)}async _putEvents(e){const t=this._bufferToMap(e),n=this._generateBatchEventParams(t);try{const{credentials:e,region:i,userAgentValue:r}=this._config,o=await fn({credentials:e,region:i,userAgentValue:r},n);this._processPutEventsSuccessResponse(o,t)}catch(e){this._handlePutEventsFailure(e,t)}}_generateBatchEventParams(e){const t={};return Object.values(e).forEach((e=>{const{event:n,timestamp:i,endpointId:r,eventId:o,session:s}=e,{name:a,attributes:c,metrics:u}=n;t[r]={Endpoint:{...t[r]?.Endpoint},Events:{...t[r]?.Events,[o]:{EventType:a,Timestamp:new Date(i).toISOString(),Attributes:c,Metrics:u,Session:s}}}})),{ApplicationId:this._config.appId,EventsRequest:{BatchItem:t}}}_handlePutEventsFailure(e,t){pn.debug("putEvents call to Pinpoint failed.",e);const n=e.$metadata&&e.$metadata.httpStatusCode;if(yn.includes(n)){const e=Object.values(t);this._retry(e)}}_processPutEventsSuccessResponse(e,t){const{Results:n={}}=e.EventsResponse??{},i=[];Object.entries(n).forEach((([e,n])=>{const r=n.EventsItemResponse??{};Object.entries(r).forEach((([e,n])=>{const r=t[e];if(!r)return;const{StatusCode:o,Message:s}=n??{};if(o&&mn.includes(o))return;if(o&&yn.includes(o))return void i.push(r);const{name:a}=r.event;pn.warn("Pinpoint event failed to send.",{eventId:e,name:a,message:s})}))})),i.length&&this._retry(i)}_retry(e){const t=[];e.forEach((e=>{const{eventId:n}=e,{name:i}=e.event;if(e.resendLimit-- >0)return pn.debug("Resending event.",{eventId:n,name:i,remainingAttempts:e.resendLimit}),void t.push({[n]:e});pn.debug("No retry attempts remaining for event.",{eventId:n,name:i})})),this._buffer.unshift(...t)}_bufferToMap(e){return e.reduce(((e,t)=>{const[[n,i]]=Object.entries(t);return e[n]=i,e}),{})}}const bn={};let vn;var Sn;!function(e){e.UndefinedInstance="UndefinedInstance",e.UndefinedRegistration="UndefinedRegistration",e.Unavailable="Unavailable"}(Sn||(Sn={}));const _n=mt({[Sn.UndefinedInstance]:{message:"Service Worker instance is undefined."},[Sn.UndefinedRegistration]:{message:"Service Worker registration is undefined."},[Sn.Unavailable]:{message:"Service Worker not available."}});class In{constructor(){this._logger=new r("ServiceWorker")}get serviceWorker(){return _n(void 0!==this._serviceWorker,Sn.UndefinedInstance),this._serviceWorker}register(e="/service-worker.js",t="/"){return this._logger.debug(`registering ${e}`),this._logger.debug(`registering service worker with scope ${t}`),new Promise(((n,i)=>{navigator&&"serviceWorker"in navigator?navigator.serviceWorker.register(e,{scope:t}).then((e=>{e.installing?this._serviceWorker=e.installing:e.waiting?this._serviceWorker=e.waiting:e.active&&(this._serviceWorker=e.active),this._registration=e,this._setupListeners(),this._logger.debug(`Service Worker Registration Success: ${e}`),n(e)})).catch((e=>{this._logger.debug(`Service Worker Registration Failed ${e}`),i(new o({name:Sn.Unavailable,message:"Service Worker not available",underlyingError:e}))})):i(new o({name:Sn.Unavailable,message:"Service Worker not available"}))}))}enablePush(e){return _n(void 0!==this._registration,Sn.UndefinedRegistration),this._publicKey=e,new Promise(((t,n)=>{"undefined"!=typeof window&&void 0!==window.document?(_n(void 0!==this._registration,Sn.UndefinedRegistration),this._registration.pushManager.getSubscription().then((n=>{if(!n)return this._logger.debug("User is NOT subscribed to push"),this._registration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this._urlB64ToUint8Array(e)}).then((e=>{this._subscription=e,this._logger.debug(`User subscribed: ${JSON.stringify(e)}`),t(e)})).catch((e=>{this._logger.error(e)}));this._subscription=n,this._logger.debug(`User is subscribed to push: ${JSON.stringify(n)}`),t(n)}))):n(new o({name:Sn.Unavailable,message:"Service Worker not available"}))}))}_urlB64ToUint8Array(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(t),i=new Uint8Array(n.length);for(let e=0;e<n.length;++e)i[e]=n.charCodeAt(e);return i}send(e){this._serviceWorker&&this._serviceWorker.postMessage("object"==typeof e?JSON.stringify(e):e)}_setupListeners(){this.serviceWorker.addEventListener("statechange",(async()=>{const e=this.serviceWorker.state;this._logger.debug(`ServiceWorker statechange: ${e}`);const{appId:t,region:n,bufferSize:i,flushInterval:r,flushSize:o,resendLimit:s}=z.getConfig().Analytics?.Pinpoint??{},{credentials:a}=await W();t&&n&&a&&(async({appId:e,category:t,channelType:n,credentials:i,event:r,identityId:o,region:s,userAgentValue:a,bufferSize:c,flushInterval:u,flushSize:d,resendLimit:l})=>{let h=vn;const g=new Date,f=g.toISOString(),p=Dt(),y=(({appId:e,region:t,credentials:n,bufferSize:i,flushInterval:r,flushSize:o,resendLimit:s,identityId:a,userAgentValue:c})=>{if(bn[t]?.[e]){const n=bn[t][e];if(!n.identityHasChanged(a))return n;n.flush()}const u=new wn({appId:e,bufferSize:i,credentials:n,flushInterval:r,flushSize:o,identityId:a,region:t,resendLimit:s,userAgentValue:c});return bn[t]||(bn[t]={}),bn[t][e]=u,u})({appId:e,region:s,credentials:i,bufferSize:c??1e3,flushInterval:u??5e3,flushSize:d??100,resendLimit:l??5,identityId:o,userAgentValue:a}),m=await(async({address:e,appId:t,category:n,channelType:i,credentials:r,identityId:o,region:s,userAgentValue:a})=>{let c=await dn(t,n);return c||(await ln({address:e,appId:t,category:n,channelType:i,credentials:r,identityId:o,region:s,userAgentValue:a}),c=await dn(t,n)),zt(!!c,Ae.NoEndpointId),c})({appId:e,category:t,channelType:n,credentials:i,identityId:o,region:s,userAgentValue:a});if(!h||"_session.start"===r.name){const e=Dt();vn={Id:e,StartTimestamp:f},h=vn}vn&&"_session.stop"===r.name&&(h={...vn,StopTimestamp:f,Duration:g.getTime()-new Date(vn.StartTimestamp).getTime()},vn=void 0),y.push({eventId:p,endpointId:m,event:r,session:h,timestamp:f,resendLimit:l??5})})({appId:t,region:n,category:"Core",credentials:a,bufferSize:i,flushInterval:r,flushSize:o,resendLimit:s,event:{name:"ServiceWorker",attributes:{state:e}}})})),this.serviceWorker.addEventListener("message",(e=>{this._logger.debug(`ServiceWorker message event: ${e}`)}))}}function Cn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)e[i]=n[i]}return e}var An=function e(t,n){function i(e,i,r){if("undefined"!=typeof document){"number"==typeof(r=Cn({},n,r)).expires&&(r.expires=new Date(Date.now()+864e5*r.expires)),r.expires&&(r.expires=r.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var s in r)r[s]&&(o+="; "+s,!0!==r[s]&&(o+="="+r[s].split(";")[0]));return document.cookie=e+"="+t.write(i,e)+o}}return Object.create({set:i,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],i={},r=0;r<n.length;r++){var o=n[r].split("="),s=o.slice(1).join("=");try{var a=decodeURIComponent(o[0]);if(i[a]=t.read(s,a),e===a)break}catch(e){}}return e?i[e]:i}},remove:function(e,t){i(e,"",Cn({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,Cn({},this.attributes,t))},withConverter:function(t){return e(Cn({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});class En{constructor(e={}){const{path:t,domain:n,expires:i,sameSite:r,secure:o}=e;if(this.domain=n,this.path=t||"/",this.expires=Object.prototype.hasOwnProperty.call(e,"expires")?i:365,this.secure=!Object.prototype.hasOwnProperty.call(e,"secure")||o,Object.prototype.hasOwnProperty.call(e,"sameSite")){if(!r||!["strict","lax","none"].includes(r))throw new Error('The sameSite value of cookieStorage must be "lax", "strict" or "none".');if("none"===r&&!this.secure)throw new Error("sameSite = None requires the Secure attribute in latest browser versions.");this.sameSite=r}}async setItem(e,t){An.set(e,t,this.getData())}async getItem(e){return An.get(e)??null}async removeItem(e){An.remove(e,this.getData())}async clear(){const e=An.get(),t=Object.keys(e).map((e=>this.removeItem(e)));await Promise.all(t)}getData(){return{path:this.path,expires:this.expires,domain:this.domain,secure:this.secure,...this.sameSite&&{sameSite:this.sameSite}}}}return n})()));
//# sourceMappingURL=aws-amplify-core.min.js.map