!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("aws_amplify_core")):"function"==typeof define&&define.amd?define("aws_amplify_api-rest",["aws_amplify_core"],t):"object"==typeof exports?exports["aws_amplify_api-rest"]=t(require("aws_amplify_core")):e["aws_amplify_api-rest"]=t(e.aws_amplify_core)}(self,(e=>(()=>{"use strict";var t={556:t=>{t.exports=e}},r={};function n(e){var o=r[e];if(void 0!==o)return o.exports;var s=r[e]={exports:{}};return t[e](s,s.exports,n),s.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};n.r(o),n.d(o,{del:()=>Ae,get:()=>we,head:()=>Se,isCancelError:()=>h,patch:()=>xe,post:()=>ve,put:()=>Ee});class s extends Error{constructor({message:e,name:t,recoverySuggestion:r,underlyingError:n}){super(e),this.name=t,this.underlyingError=n,this.recoverySuggestion=r,this.constructor=s,Object.setPrototypeOf(this,s.prototype)}}class a extends s{get response(){return this._response?i(this._response):void 0}constructor(e){super(e),this.constructor=a,Object.setPrototypeOf(this,a.prototype),e.response&&(this._response=e.response)}}const i=e=>({...e,headers:{...e.headers}});class c extends a{constructor(e){super(e),this.constructor=c,Object.setPrototypeOf(this,c.prototype)}}class u extends c{constructor(e={}){super({name:"CanceledError",message:"Request is canceled by user",...e}),this.constructor=u,Object.setPrototypeOf(this,u.prototype)}}const h=e=>!!e&&e instanceof u;var d,f=n(556);!function(e){e.InvalidApiName="InvalidApiName"}(d||(d={}));const p={[d.InvalidApiName]:{message:"API name is invalid.",recoverySuggestion:"Check if the API name matches the one in your configuration or `aws-exports.js`"}},l=e=>{const{headers:t,statusCode:r}=e;return{...y(e)?e.$metadata:{},httpStatusCode:r,requestId:t["x-amzn-requestid"]??t["x-amzn-request-id"]??t["x-amz-request-id"],extendedRequestId:t["x-amz-id-2"],cfId:t["x-amz-cf-id"]}},y=e=>"object"==typeof e?.$metadata,g=async e=>{if(!e)return;const t=await(async e=>{if(!e||e.statusCode<300)return;const t=await(async e=>{if(!e.body)throw new Error("Missing response payload");const t=await e.body.json();return Object.assign(t,{$metadata:l(e)})})(e),r=(e=>{const[t]=e.toString().split(/[,:]+/);return t.includes("#")?t.split("#")[1]:t})(e.headers["x-amzn-errortype"]??t.code??t.__type??"UnknownError"),n=t.message??t.Message??"Unknown error",o=new Error(n);return Object.assign(o,{name:r,$metadata:l(e)})})(m(e));if(t){const r=await(e.body?.text());return b(t,{statusCode:e.statusCode,headers:e.headers,body:r})}},m=e=>{let t;const r=new Proxy(e.body,{get:(e,r,n)=>"json"===r?async()=>{t||(t=e.text());try{return JSON.parse(await t)}catch(e){return{}}}:"text"===r?async()=>(t||(t=e.text()),t):Reflect.get(e,r,n)});return new Proxy(e,{get:(e,t,n)=>"body"===t?r:Reflect.get(e,t,n)})},b=(e,t)=>{const r=new c({name:e?.name,message:e.message,underlyingError:e,response:t});return Object.assign(r,{$metadata:e.$metadata})},w=new f.ConsoleLogger("RestApis"),v="execute-api",E="us-east-1",A=/^.+\.([a-z0-9-]+)\.([a-z0-9-]+)\.amazonaws\.com/,S=(e,t)=>{const{service:r=v,region:n=E}=t?.amplify.getConfig()?.API?.REST?.[t?.apiName]??{},{hostname:o}=e,[,s,a]=A.exec(o)??[];return s===v?{service:s,region:a??n}:"appsync-api"===s?{service:"appsync",region:a??n}:{service:r,region:n}},x=URL,C=URLSearchParams,T=({headers:e},t)=>!e.authorization&&!!t;var j;!function(e){e.NoEndpointId="NoEndpointId",e.PlatformNotSupported="PlatformNotSupported",e.Unknown="Unknown",e.NetworkError="NetworkError"}(j||(j={}));const P=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch","BadRequestException"],L=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException"],O=["TimeoutError","RequestTimeout","RequestTimeoutException"],R=(e,t)=>429===e||!!t&&L.includes(t),D=e=>[j.NetworkError,"ERR_NETWORK"].includes(e?.name),I=(e,t)=>!!e&&[500,502,503,504].includes(e)||!!t&&O.includes(t),$=3e5,U=e=>{const t=function(e=3e5){return t=>{const r=2**t*100+100*Math.random();return!(r>e)&&r}}($),r=t(e);return!1===r?$:r},N=({maxAttempts:e=3,retryDecider:t,computeDelay:r,abortSignal:n})=>{if(e<1)throw new Error("maxAttempts must be greater than 0");return(o,s)=>async function(a){let i,c,u=s.attemptsCount??0;const h=()=>{if(c)return q(c,u),c;throw q(i,u),i};for(;!n?.aborted&&u<e;){try{c=await o(a),i=void 0}catch(e){i=e,c=void 0}u=(s.attemptsCount??0)>u?s.attemptsCount??0:u+1,s.attemptsCount=u;const{isCredentialsExpiredError:d,retryable:f}=await t(c,i,s);if(!f)return h();if(s.isCredentialsExpired=!!d,!n?.aborted&&u<e){const e=r(u);await k(e,n)}}if(n?.aborted)throw new Error("Request aborted.");return h()}},k=(e,t)=>{if(t?.aborted)return Promise.resolve();let r,n;const o=new Promise((t=>{n=t,r=setTimeout(t,e)}));return t?.addEventListener("abort",(function e(o){clearTimeout(r),t?.removeEventListener("abort",e),n()})),o},q=(e,t)=>{"[object Object]"===Object.prototype.toString.call(e)&&(e.$metadata={...e.$metadata??{},attempts:t})},_=e=>Object.keys(e).map((e=>e.toLowerCase())).sort().join(";"),z="X-Amz-Date".toLowerCase(),B="X-Amz-Security-Token".toLowerCase(),M="aws4_request",H="AWS4-HMAC-SHA256";Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var K=64,F=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),G=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],V=Math.pow(2,53)-1,J=function(){function e(){this.state=Int32Array.from(G),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");var t=0,r=e.byteLength;if(this.bytesHashed+=r,8*this.bytesHashed>V)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;r>0;)this.buffer[this.bufferLength++]=e[t++],r--,this.bufferLength===K&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var e=8*this.bytesHashed,t=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),r=this.bufferLength;if(t.setUint8(this.bufferLength++,128),r%K>=56){for(var n=this.bufferLength;n<K;n++)t.setUint8(n,0);this.hashBuffer(),this.bufferLength=0}for(n=this.bufferLength;n<56;n++)t.setUint8(n,0);t.setUint32(56,Math.floor(e/4294967296),!0),t.setUint32(60,e),this.hashBuffer(),this.finished=!0}var o=new Uint8Array(32);for(n=0;n<8;n++)o[4*n]=this.state[n]>>>24&255,o[4*n+1]=this.state[n]>>>16&255,o[4*n+2]=this.state[n]>>>8&255,o[4*n+3]=this.state[n]>>>0&255;return o},e.prototype.hashBuffer=function(){for(var e=this.buffer,t=this.state,r=t[0],n=t[1],o=t[2],s=t[3],a=t[4],i=t[5],c=t[6],u=t[7],h=0;h<K;h++){if(h<16)this.temp[h]=(255&e[4*h])<<24|(255&e[4*h+1])<<16|(255&e[4*h+2])<<8|255&e[4*h+3];else{var d=this.temp[h-2],f=(d>>>17|d<<15)^(d>>>19|d<<13)^d>>>10,p=((d=this.temp[h-15])>>>7|d<<25)^(d>>>18|d<<14)^d>>>3;this.temp[h]=(f+this.temp[h-7]|0)+(p+this.temp[h-16]|0)}var l=(((a>>>6|a<<26)^(a>>>11|a<<21)^(a>>>25|a<<7))+(a&i^~a&c)|0)+(u+(F[h]+this.temp[h]|0)|0)|0,y=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&n^r&o^n&o)|0;u=c,c=i,i=a,a=s+l|0,s=o,o=n,n=r,r=l+y|0}t[0]+=r,t[1]+=n,t[2]+=o,t[3]+=s,t[4]+=a,t[5]+=i,t[6]+=c,t[7]+=u},e}(),W="undefined"!=typeof Buffer&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:e=>(new TextEncoder).encode(e);function X(e){return e instanceof Uint8Array?e:"string"==typeof e?W(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}var Y=function(){function e(e){this.secret=e,this.hash=new J,this.reset()}return e.prototype.update=function(e){var t;if(("string"==typeof(t=e)?0!==t.length:0!==t.byteLength)&&!this.error)try{this.hash.update(X(e))}catch(e){this.error=e}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return e=this,t=void 0,n=function(){return function(e,t){var r,n,o,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=i(0),a.throw=i(1),a.return=i(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(c){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(s=0)),s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}(this,(function(e){return[2,this.digestSync()]}))},new((r=void 0)||(r=Promise))((function(o,s){function a(e){try{c(n.next(e))}catch(e){s(e)}}function i(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,i)}c((n=n.apply(e,t||[])).next())}));var e,t,r,n},e.prototype.reset=function(){if(this.hash=new J,this.secret){this.outer=new J;var e=function(e){var t=X(e);if(t.byteLength>K){var r=new J;r.update(t),t=r.digest()}var n=new Uint8Array(K);return n.set(t),n}(this.secret),t=new Uint8Array(K);t.set(e);for(var r=0;r<K;r++)e[r]^=54,t[r]^=92;for(this.hash.update(e),this.outer.update(t),r=0;r<e.byteLength;r++)e[r]=0}},e}();const Q={},Z={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();1===t.length&&(t=`0${t}`),Q[e]=t,Z[t]=e}const ee=(e,t)=>{const r=new Y(e??void 0);return r.update(t),r.digestSync()},te=(e,t)=>function(e){let t="";for(let r=0;r<e.byteLength;r++)t+=Q[e[r]];return t}(ee(e,t)),re=e=>Object.entries(e).map((([e,t])=>({key:e.toLowerCase(),value:t?.trim().replace(/\s+/g," ")??""}))).sort(((e,t)=>e.key<t.key?-1:1)).map((e=>`${e.key}:${e.value}\n`)).join(""),ne=e=>encodeURIComponent(e).replace(/[!'()*]/g,oe),oe=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`,se=(e,t=!0)=>e?t?encodeURIComponent(e).replace(/%2F/g,"/"):e:"/",ae=e=>null==e?"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855":ie(e)?te(null,e):"UNSIGNED-PAYLOAD",ie=e=>"string"==typeof e||ArrayBuffer.isView(e)||ce(e),ce=e=>"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(e),ue=e=>new Date(Date.now()+e),he=({userAgentHeader:e="x-amz-user-agent",userAgentValue:t=""})=>r=>async function(n){if(0===t.trim().length)return await r(n);{const o=e.toLowerCase();return n.headers[o]=n.headers[o]?`${n.headers[o]} ${t}`:t,await r(n)}},de=(e,t)=>(r,n)=>{const o={};let s=t=>e(t,n);for(let e=t.length-1;e>=0;e--)s=(0,t[e])(n)(s,o);return s(r)},fe=e=>{let t;return()=>(t||(t=e()),t)},pe=e=>!["HEAD","GET","DELETE"].includes(e.toUpperCase()),le=async({url:e,method:t,headers:r,body:n},{abortSignal:o,cache:a,withCrossDomainCredentials:i})=>{let c;try{c=await fetch(e,{method:t,headers:r,body:pe(t)?n:void 0,signal:o,cache:a,credentials:i?"include":"same-origin"})}catch(e){if(e instanceof TypeError)throw new s({name:j.NetworkError,message:"A network error has occurred.",underlyingError:e});throw e}const u={};return c.headers?.forEach(((e,t)=>{u[t.toLowerCase()]=e})),{statusCode:c.status,headers:u,body:null,body:Object.assign(c.body??{},{text:fe((()=>c.text())),blob:fe((()=>c.blob())),json:fe((()=>c.json()))})}},ye=de(le,[he,N,({credentials:e,region:t,service:r,uriEscapePath:n=!0})=>{let o;return(s,a)=>async function(i){o=o??0;const c={credentials:"function"==typeof e?await e({forceRefresh:!!a?.isCredentialsExpired}):e,signingDate:ue(o),signingRegion:t,signingService:r,uriEscapePath:n},u=await((e,t)=>{const r=(({credentials:e,signingDate:t=new Date,signingRegion:r,signingService:n,uriEscapePath:o=!0})=>{const{accessKeyId:s,secretAccessKey:a,sessionToken:i}=e,{longDate:c,shortDate:u}=(e=>{const t=e.toISOString().replace(/[:-]|\.\d{3}/g,"");return{longDate:t,shortDate:t.slice(0,8)}})(t);return{accessKeyId:s,credentialScope:`${u}/${r}/${n}/${M}`,longDate:c,secretAccessKey:a,sessionToken:i,shortDate:u,signingRegion:r,signingService:n,uriEscapePath:o}})(t),{accessKeyId:n,credentialScope:o,longDate:s,sessionToken:a}=r,i={...e.headers};i.host=e.url.host,i[z]=s,a&&(i[B]=a);const c={...e,headers:i},u=((e,{credentialScope:t,longDate:r,secretAccessKey:n,shortDate:o,signingRegion:s,signingService:a,uriEscapePath:i})=>{const c=(({body:e,headers:t,method:r,url:n},o=!0)=>{return[r,se(n.pathname,o),(s=n.searchParams,Array.from(s).sort((([e,t],[r,n])=>e===r?t<n?-1:1:e<r?-1:1)).map((([e,t])=>`${ne(e)}=${ne(t)}`)).join("&")),re(t),_(t),ae(e)].join("\n");var s})(e,i),u=((e,t,r)=>[H,e,t,r].join("\n"))(r,t,te(null,c)),h=te(((e,t,r,n)=>{const o=ee(`AWS4${e}`,t),s=ee(o,r),a=ee(s,n);return ee(a,M)})(n,o,s,a),u);return h})(c,r),h=`Credential=${n}/${o}`,d=`SignedHeaders=${_(i)}`,f=`Signature=${u}`;return i.authorization=`${H} ${h}, ${d}, ${f}`,c})(i,c),h=await s(u),d=(({headers:e}={})=>e?.date??e?.Date??e?.["x-amz-date"])(h);return d&&(o=((e,t)=>((e,t)=>Math.abs(ue(t).getTime()-e)>=3e5)(e,t)?e-Date.now():t)(Date.parse(d),o)),h}}]),ge=de(le,[he,N]),me=async e=>{try{const{credentials:t}=await e.Auth.fetchAuthSession();if(t)return t}catch(e){w.debug("No credentials available, the request will be unsigned.")}return null},be=(e,t,r)=>function(e){const t=new AbortController,r=t.signal;let n;const o=async()=>{try{const t=await e(r);if(t.statusCode>=300)throw await g(t);return t}catch(e){const t=r,o=n??t.reason;if("AbortError"===e.name||!0===t?.aborted){const t=new u({...o&&{message:o},underlyingError:e,recoverySuggestion:"The API request was explicitly canceled. If this is not intended, validate if you called the `cancel()` function on the API request erroneously."});throw w.debug(e),t}throw w.debug(e),e}};{const e=e=>{!0!==r.aborted&&(t.abort(e),e&&r.reason!==e&&(n=e))};return{response:o(),cancel:e}}}((async n=>{const{apiName:o,options:s={},path:a}=t,i=((e,t,r,n)=>{const o=e.getConfig()?.API?.REST?.[t]?.endpoint;!function(e,t){const{message:r,recoverySuggestion:n}=p[t];if(!e)throw new c({name:t,message:r,recoverySuggestion:n})}(!!o,d.InvalidApiName);try{const e=new x(o+r);if(n){const t=new C(e.searchParams);Object.entries(n).forEach((([e,r])=>{t.set(e,r)})),e.search=new C(t).toString()}return e}catch(e){throw new c({name:d.InvalidApiName,...p[d.InvalidApiName],recoverySuggestion:`Please make sure the REST endpoint URL is a valid URL string. Got ${o}`})}})(e,o,a,s?.queryParams),u=await(e.libraryOptions?.API?.REST?.headers?.({apiName:o})),{headers:h={}}=s,f={...u,...h},l=S(i,{amplify:e,apiName:o});return w.debug(r,i,f,`IAM signing options: ${JSON.stringify(l)}`),(async(e,t,r,n)=>{const{url:o,method:s,headers:a,body:i,withCredentials:c,abortSignal:u}=t,h=i?i instanceof FormData?i:JSON.stringify(i??""):void 0,d=((e,t)=>{const r={};for(const t in e)r[t.toLowerCase()]=e[t];return t&&(r["content-type"]="application/json; charset=UTF-8",t instanceof FormData&&delete r["content-type"]),r})(a,i),f={url:o,headers:d,method:s,body:h},p={retryDecider:(y=g,async(e,t)=>{const r=t??await y(e)??void 0,n=r?.code||r?.name,o=e?.statusCode;return{retryable:D(t)||R(o,n)||(e=>!!e&&P.includes(e))(n)||I(o,n)}}),computeDelay:U,withCrossDomainCredentials:c,abortSignal:u},l=r(f,n);var y;let m;const b=await me(e);if(l&&b){const e=S(o),t=n?.service??e.service,r=n?.region??e.region;m=await ye(f,{...p,credentials:b,region:r,service:t})}else m=await ge(f,{...p});return{statusCode:m.statusCode,headers:m.headers,body:m.body}})(e,{...s,url:i,method:r,headers:f,abortSignal:n},T,l)})),we=e=>((e,t)=>be(e,t,"GET"))(f.Amplify,e),ve=e=>((e,t)=>be(e,t,"POST"))(f.Amplify,e),Ee=e=>((e,t)=>be(e,t,"PUT"))(f.Amplify,e),Ae=e=>((e,t)=>be(e,t,"DELETE"))(f.Amplify,e),Se=e=>((e,t)=>be(e,t,"HEAD"))(f.Amplify,e),xe=e=>((e,t)=>be(e,t,"PATCH"))(f.Amplify,e);return o})()));
//# sourceMappingURL=aws-amplify-api-rest.min.js.map