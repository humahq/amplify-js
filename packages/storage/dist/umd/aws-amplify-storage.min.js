/*! For license information please see aws-amplify-storage.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("aws_amplify_core")):"function"==typeof define&&define.amd?define("aws_amplify_storage",["aws_amplify_core"],t):"object"==typeof exports?exports.aws_amplify_storage=t(require("aws_amplify_core")):e.aws_amplify_storage=t(e.aws_amplify_core)}(this,(e=>(()=>{var t={637:(e,t)=>{var n;n=function(e){e.version="1.2.2";var t=function(){for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}(),n=function(e){var t=0,n=0,o=0,r="undefined"!=typeof Int32Array?new Int32Array(4096):new Array(4096);for(o=0;256!=o;++o)r[o]=e[o];for(o=0;256!=o;++o)for(n=e[o],t=256+o;t<4096;t+=256)n=r[t]=n>>>8^e[255&n];var a=[];for(o=1;16!=o;++o)a[o-1]="undefined"!=typeof Int32Array?r.subarray(256*o,256*o+256):r.slice(256*o,256*o+256);return a}(t),o=n[0],r=n[1],a=n[2],i=n[3],s=n[4],c=n[5],u=n[6],d=n[7],p=n[8],l=n[9],f=n[10],y=n[11],g=n[12],h=n[13],m=n[14];e.table=t,e.bstr=function(e,n){for(var o=~n,r=0,a=e.length;r<a;)o=o>>>8^t[255&(o^e.charCodeAt(r++))];return~o},e.buf=function(e,n){for(var b=~n,w=e.length-15,k=0;k<w;)b=m[e[k++]^255&b]^h[e[k++]^b>>8&255]^g[e[k++]^b>>16&255]^y[e[k++]^b>>>24]^f[e[k++]]^l[e[k++]]^p[e[k++]]^d[e[k++]]^u[e[k++]]^c[e[k++]]^s[e[k++]]^i[e[k++]]^a[e[k++]]^r[e[k++]]^o[e[k++]]^t[e[k++]];for(w+=15;k<w;)b=b>>>8^t[255&(b^e[k++])];return~b},e.str=function(e,n){for(var o=~n,r=0,a=e.length,i=0,s=0;r<a;)(i=e.charCodeAt(r++))<128?o=o>>>8^t[255&(o^i)]:i<2048?o=(o=o>>>8^t[255&(o^(192|i>>6&31))])>>>8^t[255&(o^(128|63&i))]:i>=55296&&i<57344?(i=64+(1023&i),s=1023&e.charCodeAt(r++),o=(o=(o=(o=o>>>8^t[255&(o^(240|i>>8&7))])>>>8^t[255&(o^(128|i>>2&63))])>>>8^t[255&(o^(128|s>>6&15|(3&i)<<4))])>>>8^t[255&(o^(128|63&s))]):o=(o=(o=o>>>8^t[255&(o^(224|i>>12&15))])>>>8^t[255&(o^(128|i>>6&63))])>>>8^t[255&(o^(128|63&i))];return~o}},"undefined"==typeof DO_NOT_EXPORT_CRC?n(t):n({})},556:t=>{"use strict";t.exports=e},169:()=>{},655:()=>{},546:()=>{},922:()=>{},326:()=>{},278:()=>{},173:()=>{},147:()=>{},972:()=>{},816:()=>{},696:()=>{}},n={};function o(e){var r=n[e];if(void 0!==r)return r.exports;var a=n[e]={exports:{}};return t[e](a,a.exports,o),a.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return(()=>{"use strict";o.r(r),o.d(r,{DEFAULT_PART_SIZE:()=>d,StorageError:()=>i,copy:()=>Uo,downloadData:()=>Gn,getProperties:()=>wo,getUrl:()=>Po,isCancelError:()=>m,list:()=>mo,remove:()=>Yn,uploadData:()=>_n});var e,t=o(556);o(922),o(546),function(e){e.NoCredentials="NoCredentials",e.NoIdentityId="NoIdentityId",e.NoKey="NoKey",e.NoSourceKey="NoSourceKey",e.NoDestinationKey="NoDestinationKey",e.NoSourcePath="NoSourcePath",e.NoDestinationPath="NoDestinationPath",e.NoBucket="NoBucket",e.NoRegion="NoRegion",e.InvalidStorageBucket="InvalidStorageBucket",e.InvalidCopyOperationStorageBucket="InvalidCopyOperationStorageBucket",e.InvalidStorageOperationPrefixInput="InvalidStorageOperationPrefixInput",e.InvalidStorageOperationInput="InvalidStorageOperationInput",e.InvalidAWSAccountID="InvalidAWSAccountID",e.InvalidStoragePathInput="InvalidStoragePathInput",e.InvalidUploadSource="InvalidUploadSource",e.ObjectIsTooLarge="ObjectIsTooLarge",e.UrlExpirationMaxLimitExceed="UrlExpirationMaxLimitExceed",e.InvalidLocationCredentialsCacheSize="InvalidLocationCredentialsCacheSize",e.LocationCredentialsStoreDestroyed="LocationCredentialsStoreDestroyed",e.InvalidS3Uri="InvalidS3Uri",e.InvalidCustomEndpoint="InvalidCustomEndpoint",e.ForcePathStyleEndpointNotSupported="ForcePathStyleEndpointNotSupported",e.DnsIncompatibleBucketName="DnsIncompatibleBucketName"}(e||(e={}));const n={[e.NoCredentials]:{message:"Credentials should not be empty."},[e.NoIdentityId]:{message:"Missing identity ID when accessing objects in protected or private access level."},[e.NoKey]:{message:"Missing key in api call."},[e.NoSourceKey]:{message:"Missing source key in copy api call."},[e.NoDestinationKey]:{message:"Missing destination key in copy api call."},[e.NoSourcePath]:{message:"Missing source path in copy api call."},[e.NoDestinationPath]:{message:"Missing destination path in copy api call."},[e.NoBucket]:{message:"Missing bucket name while accessing object."},[e.NoRegion]:{message:"Missing region while accessing object."},[e.UrlExpirationMaxLimitExceed]:{message:"Url Expiration can not be greater than 7 Days."},[e.ObjectIsTooLarge]:{message:"Object size cannot not be greater than 5TB."},[e.InvalidUploadSource]:{message:"Upload source type can only be a `Blob`, `File`, `ArrayBuffer`, or `string`."},[e.InvalidStorageOperationInput]:{message:"Path or key parameter must be specified in the input. Both can not be specified at the same time."},[e.InvalidAWSAccountID]:{message:"Invalid AWS account ID was provided."},[e.InvalidStorageOperationPrefixInput]:{message:"Both path and prefix can not be specified at the same time."},[e.InvalidStoragePathInput]:{message:"Input `path` does not allow a leading slash (/)."},[e.InvalidLocationCredentialsCacheSize]:{message:"locationCredentialsCacheSize must be a positive integer."},[e.LocationCredentialsStoreDestroyed]:{message:"Location-specific credentials store has been destroyed."},[e.InvalidS3Uri]:{message:"Invalid S3 URI."},[e.InvalidStorageBucket]:{message:"Unable to lookup bucket from provided name in Amplify configuration."},[e.InvalidCopyOperationStorageBucket]:{message:"Missing bucket option in either source or destination."},[e.InvalidCustomEndpoint]:{message:"Invalid S3 custom endpoint."},[e.ForcePathStyleEndpointNotSupported]:{message:"Path style URLs are not supported with S3 Transfer Acceleration."},[e.DnsIncompatibleBucketName]:{message:"The bucket name isn't DNS compatible."}};class a extends Error{constructor({message:e,name:t,recoverySuggestion:n,underlyingError:o}){super(e),this.name=t,this.underlyingError=o,this.recoverySuggestion=n,this.constructor=a,Object.setPrototypeOf(this,a.prototype)}}class i extends a{constructor(e){super(e),this.constructor=i,Object.setPrototypeOf(this,i.prototype)}}function s(e,t){const{message:o,recoverySuggestion:r}=n[t];if(!e)throw new i({name:t,message:o,recoverySuggestion:r})}const c="localhost:4566",u="guest",d=5242880,p="__uploadInProgress",l="prefix",f="key",y="path",g="crc-32";class h extends i{constructor(e={}){super({name:"CanceledError",message:"Upload is canceled by user",...e}),this.constructor=h,Object.setPrototypeOf(this,h.prototype)}}const m=e=>!!e&&e instanceof h,b=new t.ConsoleLogger("Storage"),w=({job:e,onCancel:t})=>{let n;const o={cancel:e=>{const{state:r}=o;"CANCELED"!==r&&"ERROR"!==r&&"SUCCESS"!==r?(o.state="CANCELED",n=e,t(n)):b.debug(`This task cannot be canceled. State: ${r}`)},state:"IN_PROGRESS"},r=(async()=>{try{const t=await e();return o.state="SUCCESS",t}catch(e){throw m(e)&&(o.state="CANCELED",e.message=n??e.message),o.state="ERROR",e}})();return Object.assign(o,{result:r})},k=w,C=({job:e,onCancel:t,onResume:n,onPause:o,isMultipartUpload:r})=>{const a=w({job:e,onCancel:t}),i=Object.assign(a,{pause:()=>{const{state:e}=i;r&&"IN_PROGRESS"===e?(i.state="PAUSED",o?.()):b.debug(`This task cannot be paused. State: ${e}`)},resume:()=>{const{state:e}=i;r&&"PAUSED"===e?(i.state="IN_PROGRESS",n?.()):b.debug(`This task cannot be resumed. State: ${e}`)}});return i};var x,S,v,E,U,I,P,T,A,O,N,R,B,L;!function(e){e.WebUnknown="0",e.React="1",e.NextJs="2",e.Angular="3",e.VueJs="4",e.Nuxt="5",e.Svelte="6",e.ServerSideUnknown="100",e.ReactSSR="101",e.NextJsSSR="102",e.AngularSSR="103",e.VueJsSSR="104",e.NuxtSSR="105",e.SvelteSSR="106",e.ReactNative="201",e.Expo="202"}(x||(x={})),function(e){e.AI="ai",e.API="api",e.Auth="auth",e.Analytics="analytics",e.DataStore="datastore",e.Geo="geo",e.InAppMessaging="inappmessaging",e.Interactions="interactions",e.Predictions="predictions",e.PubSub="pubsub",e.PushNotification="pushnotification",e.Storage="storage"}(S||(S={})),function(e){e.CreateConversation="1",e.GetConversation="2",e.ListConversations="3",e.DeleteConversation="4",e.SendMessage="5",e.ListMessages="6",e.OnMessage="7",e.Generation="8",e.UpdateConversation="9"}(v||(v={})),function(e){e.Record="1",e.IdentifyUser="2"}(E||(E={})),function(e){e.GraphQl="1",e.Get="2",e.Post="3",e.Put="4",e.Patch="5",e.Del="6",e.Head="7"}(U||(U={})),function(e){e.SignUp="1",e.ConfirmSignUp="2",e.ResendSignUpCode="3",e.SignIn="4",e.FetchMFAPreference="6",e.UpdateMFAPreference="7",e.SetUpTOTP="10",e.VerifyTOTPSetup="11",e.ConfirmSignIn="12",e.DeleteUserAttributes="15",e.DeleteUser="16",e.UpdateUserAttributes="17",e.FetchUserAttributes="18",e.ConfirmUserAttribute="22",e.SignOut="26",e.UpdatePassword="27",e.ResetPassword="28",e.ConfirmResetPassword="29",e.FederatedSignIn="30",e.RememberDevice="32",e.ForgetDevice="33",e.FetchDevices="34",e.SendUserAttributeVerificationCode="35",e.SignInWithRedirect="36",e.StartWebAuthnRegistration="37",e.CompleteWebAuthnRegistration="38",e.ListWebAuthnCredentials="39",e.DeleteWebAuthnCredential="40"}(I||(I={})),function(e){e.Subscribe="1",e.GraphQl="2"}(P||(P={})),function(e){e.SearchByText="0",e.SearchByCoordinates="1",e.SearchForSuggestions="2",e.SearchByPlaceId="3",e.SaveGeofences="4",e.GetGeofence="5",e.ListGeofences="6",e.DeleteGeofences="7"}(T||(T={})),function(e){e.SyncMessages="1",e.IdentifyUser="2",e.NotifyMessageInteraction="3"}(A||(A={})),function(e){e.None="0"}(O||(O={})),function(e){e.Convert="1",e.Identify="2",e.Interpret="3"}(N||(N={})),function(e){e.Subscribe="1"}(R||(R={})),function(e){e.InitializePushNotifications="1",e.IdentifyUser="2"}(B||(B={})),function(e){e.UploadData="1",e.DownloadData="2",e.List="3",e.Copy="4",e.Remove="5",e.GetProperties="6",e.GetUrl="7",e.GetDataAccess="8",e.ListCallerAccessGrants="9"}(L||(L={}));const D=[1732584193,4023233417,2562383102,271733878];class M{constructor(){this.reset()}update(e){if(function(e){return"string"==typeof e?0===e.length:0===e.byteLength}(e))return;if(this.finished)throw new Error("Attempted to update an already finished hash.");const t=function(e){return"string"==typeof e?(t=e,(new TextEncoder).encode(t)):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e);var t}(e);let n=0,{byteLength:o}=t;for(this.bytesHashed+=o;o>0;)this.buffer.setUint8(this.bufferLength++,t[n++]),o--,64===this.bufferLength&&(this.hashBuffer(),this.bufferLength=0)}async digest(){if(!this.finished){const{buffer:e,bufferLength:t,bytesHashed:n}=this,o=8*n;if(e.setUint8(this.bufferLength++,128),t%64>=56){for(let t=this.bufferLength;t<64;t++)e.setUint8(t,0);this.hashBuffer(),this.bufferLength=0}for(let t=this.bufferLength;t<56;t++)e.setUint8(t,0);e.setUint32(56,o>>>0,!0),e.setUint32(60,Math.floor(o/4294967296),!0),this.hashBuffer(),this.finished=!0}const e=new DataView(new ArrayBuffer(16));for(let t=0;t<4;t++)e.setUint32(4*t,this.state[t],!0);return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}hashBuffer(){const{buffer:e,state:t}=this;let n=t[0],o=t[1],r=t[2],a=t[3];n=$(n,o,r,a,e.getUint32(0,!0),7,3614090360),a=$(a,n,o,r,e.getUint32(4,!0),12,3905402710),r=$(r,a,n,o,e.getUint32(8,!0),17,606105819),o=$(o,r,a,n,e.getUint32(12,!0),22,3250441966),n=$(n,o,r,a,e.getUint32(16,!0),7,4118548399),a=$(a,n,o,r,e.getUint32(20,!0),12,1200080426),r=$(r,a,n,o,e.getUint32(24,!0),17,2821735955),o=$(o,r,a,n,e.getUint32(28,!0),22,4249261313),n=$(n,o,r,a,e.getUint32(32,!0),7,1770035416),a=$(a,n,o,r,e.getUint32(36,!0),12,2336552879),r=$(r,a,n,o,e.getUint32(40,!0),17,4294925233),o=$(o,r,a,n,e.getUint32(44,!0),22,2304563134),n=$(n,o,r,a,e.getUint32(48,!0),7,1804603682),a=$(a,n,o,r,e.getUint32(52,!0),12,4254626195),r=$(r,a,n,o,e.getUint32(56,!0),17,2792965006),o=$(o,r,a,n,e.getUint32(60,!0),22,1236535329),n=z(n,o,r,a,e.getUint32(4,!0),5,4129170786),a=z(a,n,o,r,e.getUint32(24,!0),9,3225465664),r=z(r,a,n,o,e.getUint32(44,!0),14,643717713),o=z(o,r,a,n,e.getUint32(0,!0),20,3921069994),n=z(n,o,r,a,e.getUint32(20,!0),5,3593408605),a=z(a,n,o,r,e.getUint32(40,!0),9,38016083),r=z(r,a,n,o,e.getUint32(60,!0),14,3634488961),o=z(o,r,a,n,e.getUint32(16,!0),20,3889429448),n=z(n,o,r,a,e.getUint32(36,!0),5,568446438),a=z(a,n,o,r,e.getUint32(56,!0),9,3275163606),r=z(r,a,n,o,e.getUint32(12,!0),14,4107603335),o=z(o,r,a,n,e.getUint32(32,!0),20,1163531501),n=z(n,o,r,a,e.getUint32(52,!0),5,2850285829),a=z(a,n,o,r,e.getUint32(8,!0),9,4243563512),r=z(r,a,n,o,e.getUint32(28,!0),14,1735328473),o=z(o,r,a,n,e.getUint32(48,!0),20,2368359562),n=j(n,o,r,a,e.getUint32(20,!0),4,4294588738),a=j(a,n,o,r,e.getUint32(32,!0),11,2272392833),r=j(r,a,n,o,e.getUint32(44,!0),16,1839030562),o=j(o,r,a,n,e.getUint32(56,!0),23,4259657740),n=j(n,o,r,a,e.getUint32(4,!0),4,2763975236),a=j(a,n,o,r,e.getUint32(16,!0),11,1272893353),r=j(r,a,n,o,e.getUint32(28,!0),16,4139469664),o=j(o,r,a,n,e.getUint32(40,!0),23,3200236656),n=j(n,o,r,a,e.getUint32(52,!0),4,681279174),a=j(a,n,o,r,e.getUint32(0,!0),11,3936430074),r=j(r,a,n,o,e.getUint32(12,!0),16,3572445317),o=j(o,r,a,n,e.getUint32(24,!0),23,76029189),n=j(n,o,r,a,e.getUint32(36,!0),4,3654602809),a=j(a,n,o,r,e.getUint32(48,!0),11,3873151461),r=j(r,a,n,o,e.getUint32(60,!0),16,530742520),o=j(o,r,a,n,e.getUint32(8,!0),23,3299628645),n=_(n,o,r,a,e.getUint32(0,!0),6,4096336452),a=_(a,n,o,r,e.getUint32(28,!0),10,1126891415),r=_(r,a,n,o,e.getUint32(56,!0),15,2878612391),o=_(o,r,a,n,e.getUint32(20,!0),21,4237533241),n=_(n,o,r,a,e.getUint32(48,!0),6,1700485571),a=_(a,n,o,r,e.getUint32(12,!0),10,2399980690),r=_(r,a,n,o,e.getUint32(40,!0),15,4293915773),o=_(o,r,a,n,e.getUint32(4,!0),21,2240044497),n=_(n,o,r,a,e.getUint32(32,!0),6,1873313359),a=_(a,n,o,r,e.getUint32(60,!0),10,4264355552),r=_(r,a,n,o,e.getUint32(24,!0),15,2734768916),o=_(o,r,a,n,e.getUint32(52,!0),21,1309151649),n=_(n,o,r,a,e.getUint32(16,!0),6,4149444226),a=_(a,n,o,r,e.getUint32(44,!0),10,3174756917),r=_(r,a,n,o,e.getUint32(8,!0),15,718787259),o=_(o,r,a,n,e.getUint32(36,!0),21,3951481745),t[0]=n+t[0]&4294967295,t[1]=o+t[1]&4294967295,t[2]=r+t[2]&4294967295,t[3]=a+t[3]&4294967295}reset(){this.state=Uint32Array.from(D),this.buffer=new DataView(new ArrayBuffer(64)),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}}function K(e,t,n,o,r,a){return((t=(t+e&4294967295)+(o+a&4294967295)&4294967295)<<r|t>>>32-r)+n&4294967295}function $(e,t,n,o,r,a,i){return K(t&n|~t&o,e,t,r,a,i)}function z(e,t,n,o,r,a,i){return K(t&o|n&~o,e,t,r,a,i)}function j(e,t,n,o,r,a,i){return K(t^n^o,e,t,r,a,i)}function _(e,t,n,o,r,a,i){return K(n^(t|~o),e,t,r,a,i)}function V(e){return function(e){const t=Array.from(e,(e=>String.fromCodePoint(e))).join("");return btoa(t)}("string"==typeof e?(new TextEncoder).encode(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}o(696);const q=e=>new Promise(((t,n)=>{const o=new FileReader;o.onload=()=>{t(o.result)},o.onabort=()=>{n(new Error("Read aborted"))},o.onerror=()=>{n(o.error)},o.readAsArrayBuffer(e)})),F=async e=>{const t=new M,n=e instanceof Blob?await q(e):e;return t.update(n),V(await t.digest())},H=({accessLevel:t,targetIdentityId:n})=>"private"===t?(s(!!n,e.NoIdentityId),`private/${n}/`):"protected"===t?(s(!!n,e.NoIdentityId),`protected/${n}/`):"public/",W=async(t,n)=>{const{options:o}=n??{},{identityId:r}=await t.Auth.fetchAuthSession(),{bucket:a,region:i,dangerouslyConnectToHttpEndpointForTesting:d,buckets:p}=t.getConfig()?.Storage?.S3??{},{bucket:l=a,region:f=i}=o?.bucket&&Z(o,p)||{};s(!!l,e.NoBucket),s(!!f,e.NoRegion);const{defaultAccessLevel:y,prefixResolver:g=H,isObjectLockEnabled:h}=t.libraryOptions?.Storage?.S3??{},m=o?.accessLevel??y??u,b="protected"===m?o?.targetIdentityId??r:r,w=await g({accessLevel:m,targetIdentityId:b});return{s3Config:{credentials:async r=>{G(o)&&J(n);const{credentials:a}=G(o)?await o.locationCredentialsProvider(r):await t.Auth.fetchAuthSession();return s(!!a,e.NoCredentials),a},region:f,useAccelerateEndpoint:o?.useAccelerateEndpoint,...o?.customEndpoint?{customEndpoint:o.customEndpoint}:{},...d?{customEndpoint:c,forcePathStyle:!0}:{}},bucket:l,keyPrefix:w,identityId:r,isObjectLockEnabled:h}},G=e=>!!e?.locationCredentialsProvider,J=e=>{if((e=>X(e)||Y(e)||Q(e))(e)||(e=>e?.path&&"function"==typeof e.path||e?.destination?.path&&"function"==typeof e.destination?.path||e?.source?.path&&"function"==typeof e.source?.path)(e))throw new i({name:"InvalidStorageInput",message:"The input needs to have a path as a string value.",recoverySuggestion:"Please provide a valid path as a string value for the input."})},X=e=>!("string"!=typeof e.key),Y=e=>!("string"!=typeof e.prefix),Q=e=>!("string"!=typeof e.source?.key&&"string"!=typeof e.destination?.key),Z=(t,n)=>{if("string"==typeof t.bucket){const o=n?.[t.bucket];return s(!!o,e.InvalidStorageBucket),{bucket:o.bucketName,region:o.region}}if("object"==typeof t.bucket)return{bucket:t.bucket.bucketName,region:t.bucket.region}},ee=/^\d{12}/,te=t=>{void 0!==t&&s(ee.test(t),e.InvalidAWSAccountID)},ne=e=>void 0!==e.path,oe=t=>(s(!!t,e.NoIdentityId),t),re=(t,n)=>{if(s(!!t.key&&!t.path||!t.key&&!!t.path,e.InvalidStorageOperationInput),ne(t)){const{path:o}=t,r="string"==typeof o?o:o({identityId:oe(n)});return s(!r.startsWith("/"),e.InvalidStoragePathInput),{inputType:y,objectKey:r}}return{inputType:f,objectKey:t.key}},ae=e=>{const{headers:t,statusCode:n}=e;return{...ie(e)?e.$metadata:{},httpStatusCode:n,requestId:t["x-amzn-requestid"]??t["x-amzn-request-id"]??t["x-amz-request-id"],extendedRequestId:t["x-amz-id-2"],cfId:t["x-amz-cf-id"]}},ie=e=>"object"==typeof e?.$metadata,se=URL,ce=URLSearchParams,ue=(e,t,n,o)=>async(r,a)=>{const i={...o,...r},s=await i.endpointResolver(i,a),c=await t(a,s),u=await e(c,{...i});return n(u)},de=(e,t)=>{if(t?.aborted)return Promise.resolve();let n,o;const r=new Promise((t=>{o=t,n=setTimeout(t,e)}));return t?.addEventListener("abort",(function e(r){clearTimeout(n),t?.removeEventListener("abort",e),o()})),r},pe=(e,t)=>{"[object Object]"===Object.prototype.toString.call(e)&&(e.$metadata={...e.$metadata??{},attempts:t})},le=e=>Object.keys(e).map((e=>e.toLowerCase())).sort().join(";"),fe="X-Amz-Algorithm",ye="X-Amz-Date",ge="X-Amz-Credential",he="X-Amz-Expires",me="X-Amz-SignedHeaders",be="X-Amz-Security-Token",we="host",ke=ye.toLowerCase(),Ce=be.toLowerCase(),xe="aws4_request",Se="AWS4-HMAC-SHA256",ve="e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",Ee=({credentials:e,signingDate:t=new Date,signingRegion:n,signingService:o,uriEscapePath:r=!0})=>{const{accessKeyId:a,secretAccessKey:i,sessionToken:s}=e,{longDate:c,shortDate:u}=(e=>{const t=e.toISOString().replace(/[:-]|\.\d{3}/g,"");return{longDate:t,shortDate:t.slice(0,8)}})(t);return{accessKeyId:a,credentialScope:`${u}/${n}/${o}/${xe}`,longDate:c,secretAccessKey:i,sessionToken:s,shortDate:u,signingRegion:n,signingService:o,uriEscapePath:r}};Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var Ue=64,Ie=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Pe=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],Te=Math.pow(2,53)-1,Ae=function(){function e(){this.state=Int32Array.from(Pe),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");var t=0,n=e.byteLength;if(this.bytesHashed+=n,8*this.bytesHashed>Te)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;n>0;)this.buffer[this.bufferLength++]=e[t++],n--,this.bufferLength===Ue&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var e=8*this.bytesHashed,t=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(t.setUint8(this.bufferLength++,128),n%Ue>=56){for(var o=this.bufferLength;o<Ue;o++)t.setUint8(o,0);this.hashBuffer(),this.bufferLength=0}for(o=this.bufferLength;o<56;o++)t.setUint8(o,0);t.setUint32(56,Math.floor(e/4294967296),!0),t.setUint32(60,e),this.hashBuffer(),this.finished=!0}var r=new Uint8Array(32);for(o=0;o<8;o++)r[4*o]=this.state[o]>>>24&255,r[4*o+1]=this.state[o]>>>16&255,r[4*o+2]=this.state[o]>>>8&255,r[4*o+3]=this.state[o]>>>0&255;return r},e.prototype.hashBuffer=function(){for(var e=this.buffer,t=this.state,n=t[0],o=t[1],r=t[2],a=t[3],i=t[4],s=t[5],c=t[6],u=t[7],d=0;d<Ue;d++){if(d<16)this.temp[d]=(255&e[4*d])<<24|(255&e[4*d+1])<<16|(255&e[4*d+2])<<8|255&e[4*d+3];else{var p=this.temp[d-2],l=(p>>>17|p<<15)^(p>>>19|p<<13)^p>>>10,f=((p=this.temp[d-15])>>>7|p<<25)^(p>>>18|p<<14)^p>>>3;this.temp[d]=(l+this.temp[d-7]|0)+(f+this.temp[d-16]|0)}var y=(((i>>>6|i<<26)^(i>>>11|i<<21)^(i>>>25|i<<7))+(i&s^~i&c)|0)+(u+(Ie[d]+this.temp[d]|0)|0)|0,g=((n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10))+(n&o^n&r^o&r)|0;u=c,c=s,s=i,i=a+y|0,a=r,r=o,o=n,n=y+g|0}t[0]+=n,t[1]+=o,t[2]+=r,t[3]+=a,t[4]+=i,t[5]+=s,t[6]+=c,t[7]+=u},e}(),Oe="undefined"!=typeof Buffer&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:e=>(new TextEncoder).encode(e);function Ne(e){return e instanceof Uint8Array?e:"string"==typeof e?Oe(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}var Re=function(){function e(e){this.secret=e,this.hash=new Ae,this.reset()}return e.prototype.update=function(e){var t;if(("string"==typeof(t=e)?0!==t.length:0!==t.byteLength)&&!this.error)try{this.hash.update(Ne(e))}catch(e){this.error=e}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return e=this,t=void 0,o=function(){return function(e,t){var n,o,r,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,(function(e){return[2,this.digestSync()]}))},new((n=void 0)||(n=Promise))((function(r,a){function i(e){try{c(o.next(e))}catch(e){a(e)}}function s(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((o=o.apply(e,t||[])).next())}));var e,t,n,o},e.prototype.reset=function(){if(this.hash=new Ae,this.secret){this.outer=new Ae;var e=function(e){var t=Ne(e);if(t.byteLength>Ue){var n=new Ae;n.update(t),t=n.digest()}var o=new Uint8Array(Ue);return o.set(t),o}(this.secret),t=new Uint8Array(Ue);t.set(e);for(var n=0;n<Ue;n++)e[n]^=54,t[n]^=92;for(this.hash.update(e),this.outer.update(t),n=0;n<e.byteLength;n++)e[n]=0}},e}();const Be={},Le={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();1===t.length&&(t=`0${t}`),Be[e]=t,Le[t]=e}const De=(e,t)=>{const n=new Re(e??void 0);return n.update(t),n.digestSync()},Me=(e,t)=>function(e){let t="";for(let n=0;n<e.byteLength;n++)t+=Be[e[n]];return t}(De(e,t)),Ke=e=>Object.entries(e).map((([e,t])=>({key:e.toLowerCase(),value:t?.trim().replace(/\s+/g," ")??""}))).sort(((e,t)=>e.key<t.key?-1:1)).map((e=>`${e.key}:${e.value}\n`)).join(""),$e=e=>encodeURIComponent(e).replace(/[!'()*]/g,ze),ze=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`,je=(e,t=!0)=>e?t?encodeURIComponent(e).replace(/%2F/g,"/"):e:"/",_e=e=>null==e?ve:Ve(e)?Me(null,e):"UNSIGNED-PAYLOAD",Ve=e=>"string"==typeof e||ArrayBuffer.isView(e)||qe(e),qe=e=>"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(e),Fe=(e,{credentialScope:t,longDate:n,secretAccessKey:o,shortDate:r,signingRegion:a,signingService:i,uriEscapePath:s})=>{const c=(({body:e,headers:t,method:n,url:o},r=!0)=>{return[n,je(o.pathname,r),(a=o.searchParams,Array.from(a).sort((([e,t],[n,o])=>e===n?t<o?-1:1:e<n?-1:1)).map((([e,t])=>`${$e(e)}=${$e(t)}`)).join("&")),Ke(t),le(t),_e(e)].join("\n");var a})(e,s),u=((e,t,n)=>[Se,e,t,n].join("\n"))(n,t,Me(null,c)),d=Me(((e,t,n,o)=>{const r=De(`AWS4${e}`,t),a=De(r,n),i=De(a,o);return De(i,xe)})(o,r,a,i),u);return d},He=e=>new Date(Date.now()+e),We="Network Error",Ge="Request aborted",Je="x-amz-content-sha256",Xe=e=>{let t;return()=>(t||(t=e()),t)},Ye=new t.ConsoleLogger("xhr-http-handler"),Qe=e=>({transferredBytes:e.loaded,totalBytes:e.lengthComputable?e.total:void 0}),Ze=["host"],et=(tt=(e,t)=>{const{url:n,method:o,headers:r,body:a}=e,{onDownloadProgress:s,onUploadProgress:c,responseType:u,abortSignal:d}=t;return new Promise(((e,t)=>{let p=new XMLHttpRequest;if(p.open(o.toUpperCase(),n.toString()),Object.entries(r).filter((([e])=>!Ze.includes(e))).forEach((([e,t])=>{p.setRequestHeader(e,t)})),p.responseType=u,s&&p.addEventListener("progress",(e=>{s(Qe(e)),Ye.debug(e)})),c&&p.upload.addEventListener("progress",(e=>{c(Qe(e)),Ye.debug(e)})),p.addEventListener("error",(()=>{const e=new i({message:We,name:"ERR_NETWORK"});Ye.error(We),t(e),p=null})),p.addEventListener("abort",(()=>{if(!p||d?.aborted)return;const e=((e,t)=>{const n=new Error(e);return n.name=t,n})(Ge,"ERR_ABORTED");Ye.error(Ge),t(e),p=null})),p.addEventListener("readystatechange",(()=>{p&&p.readyState===p.DONE&&setTimeout((()=>{if(!p)return;const t=(s=p.getAllResponseHeaders())?s.split("\r\n").reduce(((e,t)=>{const n=t.split(": "),o=n.shift(),r=n.join(": ");return e[o.toLowerCase()]=r,e}),{}):{},{responseType:n}=p,o=p.response,r="text"===n?p.responseText:"",a={blob:()=>Promise.resolve(o),text:Xe((()=>"blob"===n?(e=>{const t=new FileReader;return new Promise(((n,o)=>{t.onloadend=()=>{t.readyState===FileReader.DONE&&n(t.result)},t.onerror=()=>{o(t.error)},t.readAsText(e)}))})(o):Promise.resolve(r))),json:()=>Promise.reject(new Error("Parsing response to JSON is not implemented. Please use response.text() instead."))},i={statusCode:p.status,headers:t,body:"blob"===p.responseType?Object.assign(o,a):a};var s;e(i),p=null}))})),d){const e=()=>{if(!p)return;const e=new h({name:"ERR_CANCELED",message:"canceled"});t(e),p.abort(),p=null};d.aborted?e():d.addEventListener("abort",e)}if("function"==typeof ReadableStream&&a instanceof ReadableStream)throw new Error("ReadableStream request payload is not supported.");p.send(a??null)}))},nt=[()=>e=>async function(t){if(t.headers[Je])return e(t);{const n=await _e(t.body);return t.headers[Je]=n,e(t)}},({userAgentHeader:e="x-amz-user-agent",userAgentValue:t=""})=>n=>async function(o){if(0===t.trim().length)return await n(o);{const r=e.toLowerCase();return o.headers[r]=o.headers[r]?`${o.headers[r]} ${t}`:t,await n(o)}},({maxAttempts:e=3,retryDecider:t,computeDelay:n,abortSignal:o})=>{if(e<1)throw new Error("maxAttempts must be greater than 0");return(r,a)=>async function(i){let s,c,u=a.attemptsCount??0;const d=()=>{if(c)return pe(c,u),c;throw pe(s,u),s};for(;!o?.aborted&&u<e;){try{c=await r(i),s=void 0}catch(e){s=e,c=void 0}u=(a.attemptsCount??0)>u?a.attemptsCount??0:u+1,a.attemptsCount=u;const{isCredentialsExpiredError:p,retryable:l}=await t(c,s,a);if(!l)return d();if(a.isCredentialsExpired=!!p,!o?.aborted&&u<e){const e=n(u);await de(e,o)}}if(o?.aborted)throw new Error("Request aborted.");return d()}},({credentials:e,region:t,service:n,uriEscapePath:o=!0})=>{let r;return(a,i)=>async function(s){r=r??0;const c={credentials:"function"==typeof e?await e({forceRefresh:!!i?.isCredentialsExpired}):e,signingDate:He(r),signingRegion:t,signingService:n,uriEscapePath:o},u=await((e,t)=>{const n=Ee(t),{accessKeyId:o,credentialScope:r,longDate:a,sessionToken:i}=n,s={...e.headers};s[we]=e.url.host,s[ke]=a,i&&(s[Ce]=i);const c={...e,headers:s},u=Fe(c,n),d=`Credential=${o}/${r}`,p=`SignedHeaders=${le(s)}`,l=`Signature=${u}`;return s.authorization=`${Se} ${d}, ${p}, ${l}`,c})(s,c),d=await a(u),p=(({headers:e}={})=>e?.date??e?.Date??e?.["x-amz-date"])(d);return p&&(r=((e,t)=>((e,t)=>Math.abs(He(t).getTime()-e)>=3e5)(e,t)?e-Date.now():t)(Date.parse(p),r)),d}}],(e,t)=>{const n={};let o=e=>tt(e,t);for(let e=nt.length-1;e>=0;e--)o=(0,nt[e])(t)(o,n);return o(e)});var tt,nt;o(147),o(173);const ot=(e,t)=>{const n={};for(const[o,r]of Object.entries(t)){const[t,a]=Array.isArray(r)?r:[r];Object.prototype.hasOwnProperty.call(e,t)&&(n[o]=a?a(e[t]):String(e[t]))}return n},rt=e=>e?Number(e):void 0,at=e=>e?"true"===e:void 0,it=e=>e?new Date(e):void 0,st=(e,t)=>""===e?[]:t((Array.isArray(e)?e:[e]).filter((e=>null!=e))),ct=e=>{const t="x-amz-meta-",n=Object.keys(e).filter((e=>e.startsWith(t))).reduce(((n,o)=>(n[o.replace(t,"")]=e[o],n)),{});return Object.keys(n).length>0?n:void 0},ut=(e,t)=>{const n=new i({name:e.name,message:e.message});return 404===t&&(n.recoverySuggestion="Please add the object with this key to the bucket as the key is not found."),n},dt=e=>e.map((e=>ot(e,{PartNumber:["PartNumber",rt],ETag:"ETag",ChecksumCRC32:"ChecksumCRC32"}))),pt=e=>encodeURIComponent(e).replace(/[!'()*]/g,lt),lt=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`;var ft;!function(e){e.NoEndpointId="NoEndpointId",e.PlatformNotSupported="PlatformNotSupported",e.Unknown="Unknown",e.NetworkError="NetworkError"}(ft||(ft={}));const yt=e=>{const t={};for(const[n,o]of Object.entries(e))null!=o&&(t[n]=o.toString());return t},gt=async e=>({...yt({"x-amz-acl":e.ACL,"cache-control":e.CacheControl,"content-disposition":e.ContentDisposition,"content-language":e.ContentLanguage,"content-encoding":e.ContentEncoding,"content-type":e.ContentType,expires:e.Expires?.toUTCString(),"x-amz-tagging":e.Tagging,...ht(e.Metadata)})}),ht=(e={})=>Object.keys(e).reduce(((t,n)=>(t[`x-amz-meta-${n.toLowerCase()}`]=e[n],t)),{}),mt=(e,t)=>e.pathname.replace(/\/$/,"")+`/${t.split("/").map(pt).join("/")}`;function bt(e,t){if(!e)throw new i({name:ft.Unknown,message:"An unknown error has occurred.",underlyingError:new TypeError(`Expected a non-null value for S3 parameter ${t}`),recoverySuggestion:"This is likely to be a bug. Please reach out to library authors."})}class wt extends i{constructor(e={name:ft.Unknown,message:"An unknown error has occurred.",recoverySuggestion:"This may be a bug. Please reach out to library authors."}){super(e),this.constructor=wt,Object.setPrototypeOf(this,wt.prototype)}}function kt({bucketName:e,key:t,objectURL:n}){if(!e||!t||!n)throw new wt;const o=e.includes("."),r=pt(e),a=t.split("/").map(pt).join("/"),i=n.pathname===`/${r}/${a}`,s=n.hostname.startsWith(`${r}.`)&&n.pathname===`/${a}`;if(!(i||!o&&s))throw new wt}const Ct="6.10.2",xt=()=>"undefined"!=typeof global,St=()=>"undefined"!=typeof window,vt=()=>"undefined"!=typeof document,Et=()=>"undefined"!=typeof process,Ut=(e,t)=>!!Object.keys(e).find((e=>e.startsWith(t))),It=[{platform:x.Expo,detectionMethod:function(){return xt()&&void 0!==global.expo}},{platform:x.ReactNative,detectionMethod:function(){return"undefined"!=typeof navigator&&void 0!==navigator.product&&"ReactNative"===navigator.product}},{platform:x.NextJs,detectionMethod:function(){return St()&&window.next&&"object"==typeof window.next}},{platform:x.Nuxt,detectionMethod:function(){return St()&&(void 0!==window.__NUXT__||void 0!==window.$nuxt)}},{platform:x.Angular,detectionMethod:function(){const e=Boolean(vt()&&document.querySelector("[ng-version]")),t=Boolean(St()&&void 0!==window.ng);return e||t}},{platform:x.React,detectionMethod:function(){const e=e=>e.startsWith("_react")||e.startsWith("__react");return vt()&&Array.from(document.querySelectorAll("[id]")).some((t=>Object.keys(t).find(e)))}},{platform:x.VueJs,detectionMethod:function(){return St()&&Ut(window,"__VUE")}},{platform:x.Svelte,detectionMethod:function(){return St()&&Ut(window,"__SVELTE")}},{platform:x.WebUnknown,detectionMethod:function(){return St()}},{platform:x.NextJsSSR,detectionMethod:function(){return xt()&&(Ut(global,"__next")||Ut(global,"__NEXT"))}},{platform:x.NuxtSSR,detectionMethod:function(){return xt()&&void 0!==global.__NUXT_PATHS__}},{platform:x.ReactSSR,detectionMethod:function(){return Et()&&void 0!==process.env&&!!Object.keys(process.env).find((e=>e.includes("react")))}},{platform:x.VueJsSSR,detectionMethod:function(){return xt()&&Ut(global,"__VUE")}},{platform:x.AngularSSR,detectionMethod:function(){return Et()&&"object"==typeof process.env&&process.env.npm_lifecycle_script?.startsWith("ng ")||!1}},{platform:x.SvelteSSR,detectionMethod:function(){return Et()&&void 0!==process.env&&!!Object.keys(process.env).find((e=>e.includes("svelte")))}}];let Pt;const Tt=[];let At=!1;const Ot=()=>{if(!Pt){if(Pt=It.find((e=>e.detectionMethod()))?.platform||x.ServerSideUnknown,At)for(;Tt.length;)Tt.pop()?.();else Tt.forEach((e=>{e()}));Nt(x.ServerSideUnknown,10),Nt(x.WebUnknown,10)}return Pt};function Nt(e,t){Pt!==e||At||setTimeout((()=>{Pt=void 0,At=!0,setTimeout(Ot,1e3)}),t)}const Rt={},Bt="aws-amplify",Lt=e=>e.replace(/\+.*/,"");new class{constructor(){this.userAgent=`${Bt}/${Lt(Ct)}`}get framework(){return Ot()}get isReactNative(){return this.framework===x.ReactNative||this.framework===x.Expo}observeFrameworkChanges(e){(e=>{At||Tt.push(e)})(e)}};const Dt=e=>(({category:e,action:t}={})=>{const n=[[Bt,Lt(Ct)]];if(e&&n.push([e,t]),n.push(["framework",Ot()]),e&&t){const o=((e,t)=>Rt[e]?.[t]?.additionalDetails)(e,t);o&&o.forEach((e=>{n.push(e)}))}return n})(e).map((([e,t])=>e&&t?`${e}/${t}`:e)).join(" "),Mt={id:"aws",outputs:{dnsSuffix:"amazonaws.com"},regionRegex:"^(us|eu|ap|sa|ca|me|af)\\-\\w+\\-\\d+$",regions:["aws-global"]},Kt={partitions:[Mt,{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn"},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:["aws-cn-global"]}]},$t=e=>{const{partitions:t}=Kt;for(const{regions:n,outputs:o,regionRegex:r}of t){const t=new RegExp(r);if(n.includes(e)||t.test(e))return o.dnsSuffix}return Mt.outputs.dnsSuffix},zt=3e5,jt=e=>{const t=(new DOMParser).parseFromString(e,"text/xml"),n=_t(t);return n[Object.keys(n)[0]]},_t=e=>{if(qt(e))return{[e.documentElement.nodeName]:_t(e.documentElement)};if(e.nodeType===Node.TEXT_NODE)return e.nodeValue?.trim();if(Vt(e)){if(Ft(e))return e.childNodes[0].nodeValue;const t={};for(const n of e.attributes)Wt(n.nodeName)||(t[n.nodeName]=n.nodeValue);if(e.children.length>0)for(const n of e.children){const e=_t(n);if(void 0===e)continue;const o=n.nodeName;void 0===t[o]?t[o]=e:Array.isArray(t[o])?t[o].push(e):t[o]=[t[o],e]}return 0===Object.keys(t).length?"":t}},Vt=e=>e.nodeType===Node.ELEMENT_NODE,qt=e=>e.nodeType===Node.DOCUMENT_NODE,Ft=e=>Ht(e)&&0===e.children.length&&e.firstChild?.nodeType===Node.TEXT_NODE,Ht=e=>{for(const t of e.attributes)if(!Wt(t.nodeName))return!1;return!0},Wt=e=>"xmlns"===e||e.startsWith("xmlns:");o(972);const Gt=async e=>{if(!e.body)throw new Error("S3 aborted request.");const t=await e.body.text();if(t?.length>0)try{return jt(t)}catch(e){throw new Error(`Failed to parse XML response: ${e}`)}return{}},Jt=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch","BadRequestException"],Xt=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException"],Yt=["TimeoutError","RequestTimeout","RequestTimeoutException"],Qt=(e,t)=>429===e||!!t&&Xt.includes(t),Zt=e=>[ft.NetworkError,"ERR_NETWORK"].includes(e?.name),en=(e,t)=>!!e&&[500,502,503,504].includes(e)||!!t&&Yt.includes(t),tn=["RequestExpired","ExpiredTokenException","ExpiredToken"],nn=/^[a-z0-9][a-z0-9.-]{1,61}[a-z0-9]$/,on=/(\d+\.){3}\d+/,rn=/\.\./,an=(({noErrorWrapping:e=!1}={})=>async t=>{if(!t||t.statusCode<300)return;const{statusCode:n}=t,o=await Gt(t),r=e?o:o.Error,a=r?.Code?r.Code:404===n?"NotFound":n.toString(),i=new Error(r?.message??r?.Message??a);return Object.assign(i,{name:a,$metadata:ae(t)})})({noErrorWrapping:!0}),sn=(cn=an,async(e,t,n)=>{const o=(e=>async(t,n)=>{const o=n??await e(t)??void 0,r=o?.code||o?.name,a=t?.statusCode;return{retryable:Zt(n)||Qt(a,r)||(e=>!!e&&Jt.includes(e))(r)||en(a,r)}})(cn),r=await o(e,t);if(!e)return{retryable:r.retryable};const a=await cn(e),i=a?.name,s=a?.message,c=((e,t)=>{const n=!!e&&tn.includes(e),o=!!e&&!!t&&e.includes("Signature")&&t.includes("expired");return n||o})(i,s);return{retryable:r.retryable||!(!c||n?.isCredentialsExpired),isCredentialsExpiredError:c}});var cn;const un={service:"s3",endpointResolver:(t,n)=>{const{region:o,useAccelerateEndpoint:r,customEndpoint:a,forcePathStyle:i}=t;let u;return a?(a===c&&(u=new se(a)),s(!a.includes("://"),e.InvalidCustomEndpoint),u=new se(`http://${a}`)):r?(s(!i,e.ForcePathStyleEndpointNotSupported),u=new se(`https://s3-accelerate.${$t(o)}`)):u=new se(`https://s3.${o}.${$t(o)}`),n?.Bucket&&(s((d=n.Bucket,nn.test(d)&&!on.test(d)&&!rn.test(d)),e.DnsIncompatibleBucketName),i||n.Bucket.includes(".")?u.pathname=`/${n.Bucket}`:u.host=`${n.Bucket}.${u.host}`),{url:u};var d},retryDecider:sn,computeDelay:e=>{const t=function(e=3e5){return t=>{const n=2**t*100+100*Math.random();return!(n>e)&&n}}(zt),n=t(e);return!1===n?zt:n},userAgentValue:Dt(),useAccelerateEndpoint:!1,uriEscapePath:!1},dn=ue(et,(async(e,t)=>{const n={...await gt({...e,ContentType:e.ContentType??"application/octet-stream"}),...yt({"content-md5":e.ContentMD5,"x-amz-checksum-crc32":e.ChecksumCRC32,"x-amz-expected-bucket-owner":e.ExpectedBucketOwner,"If-None-Match":e.IfNoneMatch})},o=new se(t.url.toString());return bt(!!e.Key,"Key"),o.pathname=mt(o,e.Key),kt({bucketName:e.Bucket,key:e.Key,objectURL:o}),{method:"PUT",headers:n,url:o,body:e.Body}}),(async e=>{if(e.statusCode>=300){const t=await an(e);throw ut(t,e.statusCode)}return{...ot(e.headers,{ETag:"etag",VersionId:"x-amz-version-id"}),$metadata:ae(e)}}),{...un,responseType:"text"});function pn(e){return Dt({category:S.Storage,action:e})}var ln=o(637);const fn=e=>new Uint8Array((e.match(/\w{2}/g)??[]).map((e=>parseInt(e,16)))),yn=e=>V(fn(e)),gn=1048576,hn=async(e,t=0)=>{let n=t;if(e instanceof ArrayBuffer||ArrayBuffer.isView(e)){let t;t=e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength);let o=0;for(;o<t.length;){const e=Math.min(o+gn,t.length),r=t.slice(o,e);n=ln.buf(r,n)>>>0,o=e}}else{let t;t=e instanceof Blob?e:new Blob([e]);let o=0;for(;o<t.size;){const e=Math.min(o+gn,t.size),r=t.slice(o,e),a=await q(r),i=new Uint8Array(a);n=ln.buf(i,n)>>>0,o=e}}const o=n.toString(16).padStart(8,"0");return{checksumArrayBuffer:(r=o,fn(r).buffer),checksum:yn(o),seed:n};var r},mn=e=>{if(!e)return;if("string"==typeof e)return e;const{type:t,filename:n}=e;return void 0!==n?`${t}; filename="${n}"`:t};o(655),o(169),o(816);const bn=e=>null==e,wn=(e,t)=>bn(e)&&bn(t)||e===t,kn=e=>null!=e&&"object"==typeof e&&!Array.isArray(e),Cn=(e,t)=>{if(Array.isArray(e)&&!Array.isArray(t))return!1;if(!Array.isArray(e)&&Array.isArray(t))return!1;if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every(((e,n)=>Cn(e,t[n])));if(!kn(e)||!kn(t))return e===t;const n=Object.keys(e),o=Object.keys(t);return n.length===o.length&&n.every((n=>o.includes(n)&&Cn(e[n],t[n])))},xn="Invalid parameter for ComplteMultipartUpload API",Sn=e=>{if(!e.ETag||null==e.PartNumber)throw new Error(`${xn}: ${e}`);return`<Part><ETag>${e.ETag}</ETag><PartNumber>${e.PartNumber}</PartNumber>${e.ChecksumCRC32?`<ChecksumCRC32>${e.ChecksumCRC32}</ChecksumCRC32>`:""}</Part>`},vn=ue(et,(async(e,t)=>{const n={"content-type":"application/xml",...yt({"x-amz-checksum-crc32":e.ChecksumCRC32,"x-amz-expected-bucket-owner":e.ExpectedBucketOwner,"If-None-Match":e.IfNoneMatch})},o=new se(t.url.toString());bt(!!e.Key,"Key"),o.pathname=mt(o,e.Key),bt(!!e.UploadId,"UploadId"),o.search=new ce({uploadId:e.UploadId}).toString(),bt(!!e.MultipartUpload,"MultipartUpload"),kt({bucketName:e.Bucket,key:e.Key,objectURL:o});const r=(e=>{if(!e.Parts?.length)throw new Error(`${xn}: ${e}`);return`<CompleteMultipartUpload xmlns="http://s3.amazonaws.com/doc/2006-03-01/">${e.Parts.map(Sn).join("")}</CompleteMultipartUpload>`})(e.MultipartUpload);return function(e,t){if(!e.Parts)throw new wt;const n=jt(t),o=ot(n,{Parts:["Part",e=>st(e,dt)]});if(!Cn(e,o))throw new wt}(e.MultipartUpload,r),{method:"POST",headers:n,url:o,body:'<?xml version="1.0" encoding="UTF-8"?>'+r}}),(async e=>{if(e.statusCode>=300){const t=await an(e);throw ut(t,e.statusCode)}{const t=await(async e=>{const t=await Gt(e);if(void 0!==t.Code&&void 0!==t.Message){const t=await an({...e,statusCode:500});throw ut(t,e.statusCode)}return t})(e),n=ot(t,{ETag:"ETag",Key:"Key",Location:"Location"});return{$metadata:ae(e),...n}}}),{...un,responseType:"text",retryDecider:async(e,t,n)=>{if(!e)return{retryable:!1};if(200===e.statusCode){if(!e.body)return{retryable:!0};const t=await Gt(e);return void 0!==t.Code&&void 0!==t.Message?{retryable:!0}:{retryable:!1}}return sn(e,t,n)}}),En=ue(et,((e,t)=>{const n=new se(t.url.toString());return bt(!!e.Key,"Key"),n.pathname=mt(n,e.Key),bt(!!e.UploadId,"UploadId"),n.search=new ce({uploadId:e.UploadId}).toString(),kt({bucketName:e.Bucket,key:e.Key,objectURL:n}),{method:"DELETE",headers:{...yt({"x-amz-expected-bucket-owner":e.ExpectedBucketOwner})},url:n}}),(async e=>{if(e.statusCode>=300){const t=await an(e);throw ut(t,e.statusCode)}return{$metadata:ae(e)}}),{...un,responseType:"text"}),Un=ue(et,(async(e,t)=>{const n=new se(t.url.toString());return bt(!!e.Key,"Key"),n.pathname=mt(n,e.Key),kt({bucketName:e.Bucket,key:e.Key,objectURL:n}),{method:"HEAD",headers:yt({"x-amz-expected-bucket-owner":e.ExpectedBucketOwner}),url:n}}),(async e=>{if(e.statusCode>=300){const t=await an(e);throw ut(t,e.statusCode)}{const t={...ot(e.headers,{ContentLength:["content-length",rt],ContentType:"content-type",ETag:"etag",LastModified:["last-modified",it],VersionId:"x-amz-version-id"}),Metadata:ct(e.headers)};return{$metadata:ae(e),...t}}}),{...un,responseType:"text"}),In=ue(et,(async(e,t)=>{const n={...yt({"x-amz-checksum-crc32":e.ChecksumCRC32,"content-md5":e.ContentMD5,"x-amz-expected-bucket-owner":e.ExpectedBucketOwner}),"content-type":"application/octet-stream"},o=new se(t.url.toString());return bt(!!e.Key,"Key"),o.pathname=mt(o,e.Key),bt(!!e.PartNumber,"PartNumber"),bt(!!e.UploadId,"UploadId"),o.search=new ce({partNumber:e.PartNumber+"",uploadId:e.UploadId}).toString(),kt({bucketName:e.Bucket,key:e.Key,objectURL:o}),{method:"PUT",headers:n,url:o,body:e.Body}}),(async e=>{if(e.statusCode>=300){const t=await an(e);throw ut(t,e.statusCode)}return{...ot(e.headers,{ETag:"etag"}),$metadata:ae(e)}}),{...un,responseType:"text"}),Pn=async({dataChunkerGenerator:e,completedPartNumberSet:t,s3Config:n,abortSignal:o,bucket:r,finalKey:a,uploadId:i,onPartUploadCompletion:s,onProgress:c,isObjectLockEnabled:u,useCRC32Checksum:d,expectedBucketOwner:p})=>{let l=0;for(const{data:f,partNumber:y,size:g}of e){if(o.aborted){b.debug("upload executor aborted.");break}if(t.has(y))b.debug(`part ${y} already uploaded.`),l+=g,c?.({transferredBytes:l});else{let e;d&&(e=await hn(f));const t=!e&&u?await F(f):void 0,{ETag:h}=await In({...n,abortSignal:o,onUploadProgress:e=>{const{transferredBytes:t}=e;c?.({transferredBytes:l+t})}},{Bucket:r,Key:a,UploadId:i,Body:f,PartNumber:y,ChecksumCRC32:e?.checksum,ContentMD5:t,ExpectedBucketOwner:p});l+=g,s(y,h,e?.checksum)}}},Tn=ue(et,(async(e,t)=>{const n=new se(t.url.toString());return bt(!!e.Key,"Key"),n.pathname=mt(n,e.Key),bt(!!e.UploadId,"UploadId"),n.search=new ce({uploadId:e.UploadId}).toString(),{method:"GET",headers:{},url:n}}),(async e=>{if(e.statusCode>=300){const t=await an(e);throw ut(t,e.statusCode)}{const t=await Gt(e),n=ot(t,{UploadId:"UploadId",Parts:["Part",e=>st(e,dt)]});return{$metadata:ae(e),...n}}}),{...un,responseType:"text"}),An=async e=>{try{return JSON.parse(await e.getItem(p)??"{}")}catch(e){return b.debug("failed to parse cached uploads record."),{}}},On=({file:e,size:t,contentType:n,bucket:o,accessLevel:r,key:a,optionsHash:i})=>{let s;s=void 0===r?"custom":"guest"===r?"public":r;const c=`${i}_${t}_${n??e?.type??"application/octet-stream"}_${o}_${s}_${a}`;return e?`${e.name}_${e.lastModified}_${c}`:c},Nn=async(e,t)=>{const n=await An(e);delete n[t],await e.setItem(p,JSON.stringify(n))},Rn=ue(et,(async(e,t)=>{const n={...await gt(e),...yt({"x-amz-checksum-algorithm":e.ChecksumAlgorithm,"x-amz-expected-bucket-owner":e.ExpectedBucketOwner})},o=new se(t.url.toString());return bt(!!e.Key,"Key"),o.pathname=mt(o,e.Key),o.search="uploads",kt({bucketName:e.Bucket,key:e.Key,objectURL:o}),{method:"POST",headers:n,url:o}}),(async e=>{if(e.statusCode>=300){const t=await an(e);throw ut(t,e.statusCode)}{const t=await Gt(e),n=ot(t,{UploadId:"UploadId"});return{$metadata:ae(e),...n}}}),{...un,responseType:"text"}),Bn=e=>{if(!e)return d;let t=d,n=Math.ceil(e/t);for(;n>1e4;)t*=2,n=Math.ceil(e/t);return t},Ln=(t,o)=>{const r=Bn(o);if(t instanceof Blob)return Dn(t,0,t.size,r);if(ArrayBuffer.isView(t))return Dn(t.buffer,t.byteOffset,t.byteLength,r);if(t instanceof ArrayBuffer)return Dn(t,0,t.byteLength,r);if("string"==typeof t){const e=new Blob([t]);return Ln(e,e.size)}throw new i({name:e.InvalidUploadSource,...n[e.InvalidUploadSource]})},Dn=function*(e,t,n,o){let r=1,a=t,i=t+Math.min(o,n);for(;i<n+t;)yield{partNumber:r,data:e.slice(a,i),size:o},r+=1,a=i,i=a+o;yield{partNumber:r,data:e.slice(a,n+t),size:n+t-a}},Mn=(e,n)=>{let o,r,a,s,c,u,d,l,y,m,w,k,C=!1;const{resumableUploadsCache:x}=e.options??{},S=()=>(async()=>{const{options:o,data:r}=e,h=await W(t.Amplify,e);c=new AbortController,C=!1,s=h.s3Config,d=h.bucket,y=h.identityId,k=o?.expectedBucketOwner;const{inputType:S,objectKey:v}=re(e,y),{contentDisposition:E,contentEncoding:U,contentType:I="application/octet-stream",metadata:P,preventOverwrite:T,onProgress:A}=o??{};if(w=v,S===f){const e=o?.accessLevel;l=h.keyPrefix,w=l+v,u=Kn(e)}const O=(await hn(JSON.stringify(o))).checksum;if(!a){const{uploadId:e,cachedParts:t,finalCrc32:i}=await(async({s3Config:e,data:t,size:n,contentType:o,bucket:r,accessLevel:a,keyPrefix:i,key:s,contentDisposition:c,contentEncoding:u,metadata:d,abortSignal:l,checksumAlgorithm:f,optionsHash:y,resumableUploadsCache:h,expectedBucketOwner:m})=>{const w=void 0!==i?i+s:s;let k;if(h){const i=On({size:n,contentType:o,file:t instanceof File?t:void 0,bucket:r,accessLevel:a,key:s,optionsHash:y}),c=await(async({resumableUploadsCache:e,cacheKey:t,s3Config:n,bucket:o,finalKey:r})=>{const a=await An(e);if(!a[t]||a[t].lastTouched<Date.now()-36e5)return null;const i=a[t];i.lastTouched=Date.now(),await e.setItem(p,JSON.stringify(a));try{const{Parts:e=[]}=await Tn(n,{Bucket:o,Key:r,UploadId:i.uploadId});return{parts:e,uploadId:i.uploadId,finalCrc32:i.finalCrc32}}catch(n){return b.debug("failed to list cached parts, removing cached upload."),await Nn(e,t),null}})({s3Config:e,cacheKey:i,bucket:r,finalKey:w,resumableUploadsCache:h});k=c?{...c,uploadCacheKey:i}:void 0}else b.debug("uploaded cache instance cannot be determined, skipping cache."),k=void 0;if(k)return{uploadId:k.uploadId,cachedParts:k.parts,finalCrc32:k.finalCrc32};{const i=f===g?await(async(e,t)=>{const n=[],o=Ln(e,t);let r=0;for(const{data:e}of o){const t=new Uint8Array((await hn(e)).checksumArrayBuffer);r+=t.length,n.push(t)}const a=new Uint8Array(r);let i=0;for(const e of n)a.set(e,i),i+=e.length;return`${(await hn(a.buffer)).checksum}-${n.length}`})(t,n):void 0,{UploadId:b}=await Rn({...e,abortSignal:l},{Bucket:r,Key:w,ContentType:o,ContentDisposition:mn(c),ContentEncoding:u,Metadata:d,ChecksumAlgorithm:i?"CRC32":void 0,ExpectedBucketOwner:m});if(h){const e=On({size:n,contentType:o,file:t instanceof File?t:void 0,bucket:r,accessLevel:a,key:s,optionsHash:y});await(async(e,t,n)=>{const o=await An(e);o[t]={...n,lastTouched:Date.now()},await e.setItem(p,JSON.stringify(o))})(h,e,{uploadId:b,bucket:r,key:s,finalCrc32:i,fileName:t instanceof File?t.name:""})}return{uploadId:b,cachedParts:[],finalCrc32:i}}})({s3Config:s,accessLevel:u,bucket:d,keyPrefix:l,key:v,contentType:I,contentDisposition:E,contentEncoding:U,metadata:P,data:r,size:n,abortSignal:c.signal,checksumAlgorithm:o?.checksumAlgorithm,optionsHash:O,resumableUploadsCache:x,expectedBucketOwner:k});a={uploadId:e,completedParts:t,finalCrc32:i}}m=n?On({file:r instanceof File?r:void 0,accessLevel:u,contentType:o?.contentType,bucket:d,size:n,key:v,optionsHash:O}):void 0;const N=Ln(r,n),R=new Set(a.completedParts.map((({PartNumber:e})=>e))),B=(e,t,n)=>{a?.completedParts.push({PartNumber:e,ETag:t,...n?{ChecksumCRC32:n}:{}})},D=(({size:e,onProgress:t})=>{const n=[];return{getOnProgressListener:()=>{n.push(0);const o=n.length-1;return r=>{const{transferredBytes:a}=r;n[o]=a,t?.({transferredBytes:n.reduce(((e,t)=>e+t),0),totalBytes:e})}}}})({size:n,onProgress:A}),M=[];for(let e=0;e<4;e++)M.push(Pn({dataChunkerGenerator:N,completedPartNumberSet:R,s3Config:s,abortSignal:c.signal,bucket:d,finalKey:w,uploadId:a.uploadId,onPartUploadCompletion:B,onProgress:D.getOnProgressListener(),isObjectLockEnabled:h.isObjectLockEnabled,useCRC32Checksum:Boolean(a.finalCrc32),expectedBucketOwner:k}));await Promise.all(M),$n(a.completedParts,n);const{ETag:K}=await vn({...s,abortSignal:c.signal,userAgentValue:pn(L.UploadData)},{Bucket:d,Key:w,UploadId:a.uploadId,ChecksumCRC32:a.finalCrc32,IfNoneMatch:T?"*":void 0,MultipartUpload:{Parts:zn(a.completedParts)},ExpectedBucketOwner:k});if(n){const{ContentLength:e}=await Un(s,{Bucket:d,Key:w,ExpectedBucketOwner:k});if(e&&e!==n)throw new i({name:"Error",message:`Upload failed. Expected object size ${n}, but got ${e}.`})}x&&m&&await Nn(x,m);const $={eTag:K,contentType:I,metadata:P};return S===f?{key:v,...$}:{path:v,...$}})().then(o).catch((e=>{const t=c?.signal;t?.aborted&&C?b.debug("upload paused."):r(e)}));return{multipartUploadJob:()=>new Promise(((e,t)=>{o=e,r=t,S()})),onPause:()=>{C=!0,c?.abort()},onResume:()=>{S()},onCancel:e=>{c?.abort(e),(async()=>{m&&x&&await Nn(x,m),await En(s,{Bucket:d,Key:w,UploadId:a?.uploadId,ExpectedBucketOwner:k})})().catch((e=>{b.debug("error when cancelling upload task.",e)})),r(new h(e?{message:e}:void 0))}}},Kn=e=>e??t.Amplify.libraryOptions.Storage?.S3?.defaultAccessLevel??u,$n=(e,t)=>{const n=Math.ceil(t/Bn(t)),o=e.length===n,r=zn(e).every(((e,t)=>e.PartNumber===t+1));if(!o||!r)throw new wt},zn=e=>[...e].sort(((e,t)=>e.PartNumber-t.PartNumber)),jn=n=>{const{data:o}=n,r=(e=>null==e?0:"string"==typeof e?new Blob([e]).size:"number"==typeof e.byteLength?e.byteLength:"number"==typeof e.size?e.size:void 0)(o);if(s(void 0!==r,e.InvalidUploadSource),s(r<=5497558138880,e.ObjectIsTooLarge),r<=d){const e=new AbortController;return C({isMultipartUpload:!1,job:(a=n,i=e.signal,c=r,async()=>{const{options:e,data:n}=a,{bucket:o,keyPrefix:r,s3Config:s,isObjectLockEnabled:u,identityId:d}=await W(t.Amplify,a),{inputType:p,objectKey:l}=re(a,d);te(e?.expectedBucketOwner);const y=p===f?r+l:l,{contentDisposition:h,contentEncoding:m,contentType:b="application/octet-stream",preventOverwrite:w,metadata:k,checksumAlgorithm:C,onProgress:x,expectedBucketOwner:S}=e??{},v=C===g?await hn(n):void 0,E=!v&&u?await F(n):void 0,{ETag:U,VersionId:I}=await dn({...s,abortSignal:i,onUploadProgress:x,userAgentValue:pn(L.UploadData)},{Bucket:o,Key:y,Body:n,ContentType:b,ContentDisposition:mn(h),ContentEncoding:m,Metadata:k,ContentMD5:E,ChecksumCRC32:v?.checksum,ExpectedBucketOwner:S,IfNoneMatch:w?"*":void 0}),P={eTag:U,versionId:I,contentType:b,metadata:k,size:c};return p===f?{key:l,...P}:{path:l,...P}}),onCancel:t=>{e.abort(t)}})}{const{multipartUploadJob:e,onPause:t,onResume:o,onCancel:a}=Mn(n,r);return C({isMultipartUpload:!0,job:e,onCancel:e=>{a(e)},onPause:t,onResume:o})}var a,i,c};function _n(e){return jn({...e,options:{...e?.options,resumableUploadsCache:t.defaultStorage}})}o(278),o(326);const Vn=async(e,t)=>{const n=new se(t.url.toString());return bt(!!e.Key,"Key"),n.pathname=mt(n,e.Key),kt({bucketName:e.Bucket,key:e.Key,objectURL:n}),{method:"GET",headers:{...e.Range&&{Range:e.Range},...yt({"x-amz-expected-bucket-owner":e.ExpectedBucketOwner})},url:n}},qn=ue(et,Vn,(async e=>{if(e.statusCode>=300){const t=await an(e);throw ut(t,e.statusCode)}return{...ot(e.headers,{DeleteMarker:["x-amz-delete-marker",at],AcceptRanges:"accept-ranges",Expiration:"x-amz-expiration",Restore:"x-amz-restore",LastModified:["last-modified",it],ContentLength:["content-length",rt],ETag:"etag",ChecksumCRC32:"x-amz-checksum-crc32",ChecksumCRC32C:"x-amz-checksum-crc32c",ChecksumSHA1:"x-amz-checksum-sha1",ChecksumSHA256:"x-amz-checksum-sha256",MissingMeta:["x-amz-missing-meta",rt],VersionId:"x-amz-version-id",CacheControl:"cache-control",ContentDisposition:"content-disposition",ContentEncoding:"content-encoding",ContentLanguage:"content-language",ContentRange:"content-range",ContentType:"content-type",Expires:["expires",it],WebsiteRedirectLocation:"x-amz-website-redirect-location",ServerSideEncryption:"x-amz-server-side-encryption",SSECustomerAlgorithm:"x-amz-server-side-encryption-customer-algorithm",SSECustomerKeyMD5:"x-amz-server-side-encryption-customer-key-md5",SSEKMSKeyId:"x-amz-server-side-encryption-aws-kms-key-id",BucketKeyEnabled:["x-amz-server-side-encryption-bucket-key-enabled",at],StorageClass:"x-amz-storage-class",RequestCharged:"x-amz-request-charged",ReplicationStatus:"x-amz-replication-status",PartsCount:["x-amz-mp-parts-count",rt],TagCount:["x-amz-tagging-count",rt],ObjectLockMode:"x-amz-object-lock-mode",ObjectLockRetainUntilDate:["x-amz-object-lock-retain-until-date",it],ObjectLockLegalHoldStatus:"x-amz-object-lock-legal-hold"}),Metadata:ct(e.headers),$metadata:ae(e),Body:e.body}}),{...un,responseType:"blob"}),Fn=async(e,t)=>{const n=un.endpointResolver(e,t),{url:o,headers:r,method:a}=await Vn(t,n);o.searchParams.append(Je,ve),e.userAgentValue&&o.searchParams.append(e.userAgentHeader??"x-amz-user-agent",e.userAgentValue),t.ResponseContentType&&o.searchParams.append("response-content-type",t.ResponseContentType),t.ResponseContentDisposition&&o.searchParams.append("response-content-disposition",t.ResponseContentDisposition);for(const[e,t]of Object.entries(r).sort((([e],[t])=>e.localeCompare(t))))o.searchParams.append(e,t);return(({body:e,method:t="GET",url:n},{expiration:o,...r})=>{const a=Ee(r),{accessKeyId:i,credentialScope:s,longDate:c,sessionToken:u}=a,d=new se(n);Object.entries({[fe]:Se,[ge]:`${i}/${s}`,[ye]:c,[me]:we,...o&&{[he]:o.toString()},...u&&{[be]:u}}).forEach((([e,t])=>{d.searchParams.append(e,t)}));const p={body:e,headers:{[we]:n.host},method:t,url:d},l=Fe(p,a);return d.searchParams.append("X-Amz-Signature",l),d})({method:a,url:o,body:void 0},{signingService:un.service,signingRegion:e.region,...un,...e})},Hn=e=>{const t=new AbortController;return k({job:Wn(e,t.signal),onCancel:e=>{t.abort(e)}})},Wn=(e,n)=>async()=>{const{options:o}=e,{bucket:r,keyPrefix:a,s3Config:i,identityId:s}=await W(t.Amplify,e),{inputType:c,objectKey:u}=re(e,s);te(o?.expectedBucketOwner);const d=c===f?a+u:u;b.debug(`download ${u} from ${d}.`);const{Body:p,LastModified:l,ContentLength:y,ETag:g,Metadata:h,VersionId:m,ContentType:w}=await qn({...i,abortSignal:n,onDownloadProgress:o?.onProgress,userAgentValue:pn(L.DownloadData)},{Bucket:r,Key:d,...o?.bytesRange&&{Range:`bytes=${o.bytesRange.start}-${o.bytesRange.end}`},ExpectedBucketOwner:o?.expectedBucketOwner}),k={body:p,lastModified:l,size:y,contentType:w,eTag:g,metadata:h,versionId:m};return c===f?{key:u,...k}:{path:u,...k}};function Gn(e){return Hn(e)}const Jn=ue(et,((e,t)=>{const n=new se(t.url.toString());return bt(!!e.Key,"Key"),n.pathname=mt(n,e.Key),kt({bucketName:e.Bucket,key:e.Key,objectURL:n}),{method:"DELETE",headers:yt({"x-amz-expected-bucket-owner":e.ExpectedBucketOwner}),url:n}}),(async e=>{if(e.statusCode>=300){const t=await an(e);throw ut(t,e.statusCode)}return{...ot(e.headers,{DeleteMarker:["x-amz-delete-marker",at],VersionId:"x-amz-version-id",RequestCharged:"x-amz-request-charged"}),$metadata:ae(e)}}),{...un,responseType:"text"}),Xn=async(e,t)=>{const{s3Config:n,keyPrefix:o,bucket:r,identityId:a}=await W(e,t),{inputType:i,objectKey:s}=re(t,a);let c;return te(t.options?.expectedBucketOwner),i===f?(c=`${o}${s}`,b.debug(`remove "${s}" from "${c}".`)):(c=s,b.debug(`removing object in path "${c}"`)),await Jn({...n,userAgentValue:pn(L.Remove)},{Bucket:r,Key:c,ExpectedBucketOwner:t.options?.expectedBucketOwner}),i===f?{key:s}:{path:s}};function Yn(e){return Xn(t.Amplify,e)}const Qn=e=>decodeURIComponent(e.replace(/\+/g," ")),Zn=e=>e.map(eo),eo=e=>ot(e,{Prefix:"Prefix"}),to=e=>e.map(no),no=e=>ot(e,{Key:"Key",LastModified:["LastModified",it],ETag:"ETag",ChecksumAlgorithm:["ChecksumAlgorithm",e=>st(e,oo)],Size:["Size",rt],StorageClass:"StorageClass",Owner:["Owner",ro]}),oo=e=>e.map((e=>String(e))),ro=e=>ot(e,{DisplayName:"DisplayName",ID:"ID"}),ao=ue(et,((e,t)=>{const n=yt({"x-amz-request-payer":e.RequestPayer,"x-amz-expected-bucket-owner":e.ExpectedBucketOwner}),o=yt({"list-type":"2","continuation-token":e.ContinuationToken,delimiter:e.Delimiter,"encoding-type":e.EncodingType,"fetch-owner":e.FetchOwner,"max-keys":e.MaxKeys,prefix:e.Prefix,"start-after":e.StartAfter}),r=new se(t.url.toString());return r.search=new ce(o).toString(),{method:"GET",headers:n,url:r}}),(async e=>{if(e.statusCode>=300){const t=await an(e);throw ut(t,e.statusCode)}{const t=await Gt(e),n=ot(t,{CommonPrefixes:["CommonPrefixes",e=>st(e,Zn)],Contents:["Contents",e=>st(e,to)],ContinuationToken:"ContinuationToken",Delimiter:"Delimiter",EncodingType:"EncodingType",IsTruncated:["IsTruncated",at],KeyCount:["KeyCount",rt],MaxKeys:["MaxKeys",rt],Name:"Name",NextContinuationToken:"NextContinuationToken",Prefix:"Prefix",StartAfter:"StartAfter"}),o={$metadata:ae(e),...n};return(e=>{const{IsTruncated:t,KeyCount:n,Contents:o=[],CommonPrefixes:r=[],NextContinuationToken:a}=e,i=t&&!!a||!t&&!a,s=n===o.length+r.length;if(!i||!s)throw new wt})(o),o}}),{...un,responseType:"text"}),io=1e3,so=async(t,n)=>{const{options:o={}}=n,{s3Config:r,bucket:a,keyPrefix:i,identityId:c}=await W(t,n),{inputType:u,objectKey:d}=((t,n)=>{if(s(!(t.prefix&&t.path),e.InvalidStorageOperationPrefixInput),(e=>void 0!==e.path)(t)){const{path:o}=t,r="string"==typeof o?o:o({identityId:oe(n)});return s(!r.startsWith("/"),e.InvalidStoragePathInput),{inputType:y,objectKey:r}}return{inputType:l,objectKey:t.prefix??""}})(n,c);te(o.expectedBucketOwner);const p=u===l;if(o?.listAll&&(o?.pageSize||o?.nextToken)){const e=o;b.debug(`listAll is set to true, ignoring ${e?.pageSize?`pageSize: ${e?.pageSize}`:""} ${e?.nextToken?`nextToken: ${e?.nextToken}`:""}.`)}const f={Bucket:a,Prefix:p?`${i}${d}`:d,MaxKeys:o?.listAll?void 0:o?.pageSize,ContinuationToken:o?.listAll?void 0:o?.nextToken,Delimiter:yo(o),ExpectedBucketOwner:o?.expectedBucketOwner,EncodingType:"url"};b.debug(`listing items from "${f.Prefix}"`);const g={s3Config:r,listParams:f};return o.listAll?p?co({...g,generatedPrefix:i}):po(g):p?uo({...g,generatedPrefix:i}):lo(g)},co=async({s3Config:e,listParams:t,generatedPrefix:n})=>{const o=[];let r=t.ContinuationToken;do{const{items:a,nextToken:i}=await uo({generatedPrefix:n,s3Config:e,listParams:{...t,ContinuationToken:r,MaxKeys:io}});o.push(...a),r=i}while(r);return{items:o}},uo=async({s3Config:e,listParams:t,generatedPrefix:n})=>{const o={...t};(!o.MaxKeys||o.MaxKeys>io)&&(b.debug("defaulting pageSize to 1000."),o.MaxKeys=io);const r=await ao({...e,userAgentValue:pn(L.List)},o),a=ho(r);return go(o,a),a?.Contents?{items:a.Contents.map((e=>({key:n?e.Key.substring(n.length):e.Key,eTag:e.ETag,lastModified:e.LastModified,size:e.Size}))),nextToken:a.NextContinuationToken}:{items:[]}},po=async({s3Config:e,listParams:t})=>{const n=[],o=[];let r=t.ContinuationToken;do{const{items:a,excludedSubpaths:i,nextToken:s}=await lo({s3Config:e,listParams:{...t,ContinuationToken:r,MaxKeys:io}});n.push(...a),o.push(...i??[]),r=s}while(r);return{items:n,excludedSubpaths:o}},lo=async({s3Config:e,listParams:t})=>{const n={...t};(!n.MaxKeys||n.MaxKeys>io)&&(b.debug("defaulting pageSize to 1000."),n.MaxKeys=io);const o=await ao({...e,userAgentValue:pn(L.List)},n),r=ho(o);go(n,r);const{Contents:a,NextContinuationToken:i,CommonPrefixes:s}=r,c=s&&fo(s);return a?{items:a.map((e=>({path:e.Key,eTag:e.ETag,lastModified:e.LastModified,size:e.Size}))),nextToken:i,excludedSubpaths:c}:{items:[],nextToken:i,excludedSubpaths:c}},fo=e=>e.reduce(((e,{Prefix:t})=>(t&&e.push(t),e)),[]),yo=e=>{if("exclude"===e?.subpathStrategy?.strategy)return e?.subpathStrategy?.delimiter??"/"},go=(e,t)=>{if(e.Bucket!==t.Name||e.Delimiter!==t.Delimiter||e.MaxKeys!==t.MaxKeys||e.Prefix!==t.Prefix||e.ContinuationToken!==t.ContinuationToken)throw new wt},ho=e=>{if("url"!==e.EncodingType)return e;const t={...e};return["Delimiter","Prefix","StartAfter"].forEach((n=>{const o=e[n];"string"==typeof o&&(t[n]=Qn(o))})),e.Contents&&(t.Contents=e.Contents.map((e=>({...e,Key:e.Key?Qn(e.Key):e.Key})))),e.CommonPrefixes&&(t.CommonPrefixes=e.CommonPrefixes.map((e=>({...e,Prefix:e.Prefix?Qn(e.Prefix):e.Prefix})))),t};function mo(e){return so(t.Amplify,e??{})}const bo=async(e,t,n)=>{const{s3Config:o,bucket:r,keyPrefix:a,identityId:i}=await W(e,t),{inputType:s,objectKey:c}=re(t,i);te(t.options?.expectedBucketOwner);const u=s===f?a+c:c;b.debug(`get properties of ${c} from ${u}`);const d=await Un({...o,userAgentValue:pn(n??L.GetProperties)},{Bucket:r,Key:u,ExpectedBucketOwner:t.options?.expectedBucketOwner}),p={contentType:d.ContentType,size:d.ContentLength,eTag:d.ETag,lastModified:d.LastModified,metadata:d.Metadata,versionId:d.VersionId};return s===f?{key:c,...p}:{path:c,...p}};function wo(e){return bo(t.Amplify,e)}const ko=ue(et,(async(e,t)=>{const n={...await gt(e),...yt({"x-amz-copy-source":e.CopySource,"x-amz-metadata-directive":e.MetadataDirective,"x-amz-copy-source-if-match":e.CopySourceIfMatch,"x-amz-copy-source-if-unmodified-since":e.CopySourceIfUnmodifiedSince?.toUTCString(),"x-amz-source-expected-bucket-owner":e.ExpectedSourceBucketOwner,"x-amz-expected-bucket-owner":e.ExpectedBucketOwner})};((e,t)=>{if([t["x-amz-copy-source"]===e.CopySource,wn(e.MetadataDirective,t["x-amz-metadata-directive"]),wn(e.CopySourceIfMatch,t["x-amz-copy-source-if-match"]),wn(e.CopySourceIfUnmodifiedSince?.toUTCString(),t["x-amz-copy-source-if-unmodified-since"])].some((e=>!e)))throw new wt})(e,n);const o=new se(t.url.toString());return bt(!!e.Key,"Key"),o.pathname=mt(o,e.Key),kt({bucketName:e.Bucket,key:e.Key,objectURL:o}),{method:"PUT",headers:n,url:o}}),(async e=>{if(e.statusCode>=300){const t=await an(e);throw ut(t,e.statusCode)}return await Gt(e),{$metadata:ae(e)}}),{...un,responseType:"text"}),Co=(t,n)=>{s(void 0!==t&&void 0!==n||!n&&!t,e.InvalidCopyOperationStorageBucket)},xo=async(e,t)=>(e=>ne(e.source))(t)?So(e,t):vo(e,t),So=async(t,n)=>{const{source:o,destination:r}=n;Co(o.bucket,r.bucket);const{bucket:a}=await W(t,{path:n.source.path,options:{locationCredentialsProvider:n.options?.locationCredentialsProvider,...n.source}}),{s3Config:i,bucket:c,identityId:u}=await W(t,{path:n.destination.path,options:{locationCredentialsProvider:n.options?.locationCredentialsProvider,customEndpoint:n.options?.customEndpoint,...n.destination}});s(!!o.path,e.NoSourcePath),s(!!r.path,e.NoDestinationPath);const{objectKey:d}=re(o,u),{objectKey:p}=re(r,u);te(o.expectedBucketOwner),te(r.expectedBucketOwner);const l=`${a}/${d}`,f=p;return b.debug(`copying "${l}" to "${f}".`),await Eo({source:l,destination:f,bucket:c,s3Config:i,notModifiedSince:n.source.notModifiedSince,eTag:n.source.eTag,expectedSourceBucketOwner:n.source?.expectedBucketOwner,expectedBucketOwner:n.destination?.expectedBucketOwner}),{path:f}},vo=async(t,n)=>{const{source:o,destination:r}=n;Co(o.bucket,r.bucket),s(!!o.key,e.NoSourceKey),s(!!r.key,e.NoDestinationKey),te(o.expectedBucketOwner),te(r.expectedBucketOwner);const{bucket:a,keyPrefix:i}=await W(t,{...n,options:{locationCredentialsProvider:n.options?.locationCredentialsProvider,...n.source}}),{s3Config:c,bucket:u,keyPrefix:d}=await W(t,{...n,options:{locationCredentialsProvider:n.options?.locationCredentialsProvider,...n.destination}}),p=`${a}/${i}${o.key}`,l=`${d}${r.key}`;return b.debug(`copying "${p}" to "${l}".`),await Eo({source:p,destination:l,bucket:u,s3Config:c,notModifiedSince:n.source.notModifiedSince,eTag:n.source.eTag,expectedSourceBucketOwner:n.source?.expectedBucketOwner,expectedBucketOwner:n.destination?.expectedBucketOwner}),{key:r.key}},Eo=async({source:e,destination:t,bucket:n,s3Config:o,notModifiedSince:r,eTag:a,expectedSourceBucketOwner:i,expectedBucketOwner:s})=>{await ko({...o,userAgentValue:pn(L.Copy)},{Bucket:n,CopySource:e,Key:t,MetadataDirective:"COPY",CopySourceIfMatch:a,CopySourceIfUnmodifiedSince:r,ExpectedSourceBucketOwner:i,ExpectedBucketOwner:s})};function Uo(e){return xo(t.Amplify,e)}const Io=async(t,n)=>{const{options:o}=n,{s3Config:r,keyPrefix:a,bucket:i,identityId:c}=await W(t,n),{inputType:u,objectKey:d}=re(n,c);te(o?.expectedBucketOwner);const p=u===f?a+d:d;o?.validateObjectExistence&&await bo(t,n,L.GetUrl);let l=o?.expiresIn??900;const y="function"==typeof r.credentials?await r.credentials():r.credentials,g=y.expiration;if(g){const e=Math.floor((g.getTime()-Date.now())/1e3);l=Math.min(e,l)}return s(l<=604800,e.UrlExpirationMaxLimitExceed),{url:await Fn({...r,credentials:y,expiration:l},{Bucket:i,Key:p,...o?.contentDisposition&&{ResponseContentDisposition:mn(o.contentDisposition)},...o?.contentType&&{ResponseContentType:o.contentType},ExpectedBucketOwner:o?.expectedBucketOwner}),expiresAt:new Date(Date.now()+1e3*l)}};function Po(e){return Io(t.Amplify,e)}})(),r})()));
//# sourceMappingURL=aws-amplify-storage.min.js.map