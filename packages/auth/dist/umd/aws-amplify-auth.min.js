!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("aws_amplify_core")):"function"==typeof define&&define.amd?define("aws_amplify_auth",["aws_amplify_core"],t):"object"==typeof exports?exports.aws_amplify_auth=t(require("aws_amplify_core")):e.aws_amplify_auth=t(e.aws_amplify_core)}(this,(e=>(()=>{"use strict";var t={556:t=>{t.exports=e}},n={};function o(e){var i=n[e];if(void 0!==i)return i.exports;var r=n[e]={exports:{}};return t[e](r,r.exports,o),r.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};o.r(i),o.d(i,{AuthError:()=>_,associateWebAuthnCredential:()=>rr,autoSignIn:()=>No,confirmResetPassword:()=>Go,confirmSignIn:()=>Yo,confirmSignUp:()=>Jo,confirmUserAttribute:()=>li,decodeJWT:()=>r.decodeJWT,deleteUser:()=>zi,deleteUserAttributes:()=>Hi,deleteWebAuthnCredential:()=>dr,fetchAuthSession:()=>r.fetchAuthSession,fetchDevices:()=>er,fetchMFAPreference:()=>ti,fetchUserAttributes:()=>_i,forgetDevice:()=>Zi,getCurrentUser:()=>Oe,listWebAuthnCredentials:()=>ar,rememberDevice:()=>Ji,resendSignUpCode:()=>zo,resetPassword:()=>qo,sendUserAttributeVerificationCode:()=>Bi,setUpTOTP:()=>ri,signIn:()=>Mo,signInWithRedirect:()=>Di,signOut:()=>Ki,signUp:()=>Wo,updateMFAPreference:()=>Qo,updatePassword:()=>ii,updateUserAttribute:()=>di,updateUserAttributes:()=>si,verifyTOTPSetup:()=>ni});var r=o(556);class s extends Error{constructor({message:e,name:t,recoverySuggestion:n,underlyingError:o}){super(e),this.name=t,this.underlyingError=o,this.recoverySuggestion=n,this.constructor=s,Object.setPrototypeOf(this,s.prototype)}}const a=()=>{if("object"==typeof window&&"object"==typeof window.crypto)return window.crypto;if("object"==typeof crypto)return crypto;throw new s({name:"MissingPolyfill",message:"Cannot resolve the `crypto` function from the environment."})},c={convert(e,t){let n=e;return t?.urlSafe&&(n=n.replace(/-/g,"+").replace(/_/g,"/")),(()=>{if("undefined"!=typeof window&&"function"==typeof window.atob)return window.atob;if("function"==typeof atob)return atob;throw new s({name:"Base64EncoderError",message:"Cannot resolve the `atob` function from the environment."})})()(n)}},d=(e,t=s)=>(n,o,i)=>{const{message:r,recoverySuggestion:s}=e[o];if(!n)throw new t({name:o,message:i?`${r} ${i}`:r,recoverySuggestion:s})};var u,l;(l=u||(u={})).AuthTokenConfigException="AuthTokenConfigException",l.AuthUserPoolAndIdentityPoolException="AuthUserPoolAndIdentityPoolException",l.AuthUserPoolException="AuthUserPoolException",l.InvalidIdentityPoolIdException="InvalidIdentityPoolIdException",l.OAuthNotConfigureException="OAuthNotConfigureException";const p=d({[u.AuthTokenConfigException]:{message:"Auth Token Provider not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app."},[u.AuthUserPoolAndIdentityPoolException]:{message:"Auth UserPool or IdentityPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with UserPoolId and IdentityPoolId."},[u.AuthUserPoolException]:{message:"Auth UserPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with userPoolId and userPoolClientId."},[u.InvalidIdentityPoolIdException]:{message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."},[u.OAuthNotConfigureException]:{message:"oauth param not configured.",recoverySuggestion:"Make sure to call Amplify.configure with oauth parameter in your app."}});function h(e){let t=!0;t=!!e&&!!e.userPoolId&&!!e.userPoolClientId,p(t,u.AuthUserPoolException)}function g(e){p(!!(e?.loginWith?.oauth?.domain&&e?.loginWith?.oauth?.redirectSignOut&&e?.loginWith?.oauth?.redirectSignIn&&e?.loginWith?.oauth?.responseType),u.OAuthNotConfigureException)}function E(e){const t=e.split(".");if(3!==t.length)throw new Error("Invalid token");try{const n=t[1].replace(/-/g,"+").replace(/_/g,"/"),o=decodeURIComponent(c.convert(n).split("").map((e=>`%${`00${e.charCodeAt(0).toString(16)}`.slice(-2)}`)).join(""));return{toString:()=>e,payload:JSON.parse(o)}}catch(e){throw new Error("Invalid token payload")}}var m,f,y,S,A,I,w,x,C,v,P,R,T,N,U;!function(e){e.WebUnknown="0",e.React="1",e.NextJs="2",e.Angular="3",e.VueJs="4",e.Nuxt="5",e.Svelte="6",e.ServerSideUnknown="100",e.ReactSSR="101",e.NextJsSSR="102",e.AngularSSR="103",e.VueJsSSR="104",e.NuxtSSR="105",e.SvelteSSR="106",e.ReactNative="201",e.Expo="202"}(m||(m={})),function(e){e.AI="ai",e.API="api",e.Auth="auth",e.Analytics="analytics",e.DataStore="datastore",e.Geo="geo",e.InAppMessaging="inappmessaging",e.Interactions="interactions",e.Predictions="predictions",e.PubSub="pubsub",e.PushNotification="pushnotification",e.Storage="storage"}(f||(f={})),function(e){e.CreateConversation="1",e.GetConversation="2",e.ListConversations="3",e.DeleteConversation="4",e.SendMessage="5",e.ListMessages="6",e.OnMessage="7",e.Generation="8",e.UpdateConversation="9"}(y||(y={})),function(e){e.Record="1",e.IdentifyUser="2"}(S||(S={})),function(e){e.GraphQl="1",e.Get="2",e.Post="3",e.Put="4",e.Patch="5",e.Del="6",e.Head="7"}(A||(A={})),function(e){e.SignUp="1",e.ConfirmSignUp="2",e.ResendSignUpCode="3",e.SignIn="4",e.FetchMFAPreference="6",e.UpdateMFAPreference="7",e.SetUpTOTP="10",e.VerifyTOTPSetup="11",e.ConfirmSignIn="12",e.DeleteUserAttributes="15",e.DeleteUser="16",e.UpdateUserAttributes="17",e.FetchUserAttributes="18",e.ConfirmUserAttribute="22",e.SignOut="26",e.UpdatePassword="27",e.ResetPassword="28",e.ConfirmResetPassword="29",e.FederatedSignIn="30",e.RememberDevice="32",e.ForgetDevice="33",e.FetchDevices="34",e.SendUserAttributeVerificationCode="35",e.SignInWithRedirect="36",e.StartWebAuthnRegistration="37",e.CompleteWebAuthnRegistration="38",e.ListWebAuthnCredentials="39",e.DeleteWebAuthnCredential="40"}(I||(I={})),function(e){e.Subscribe="1",e.GraphQl="2"}(w||(w={})),function(e){e.SearchByText="0",e.SearchByCoordinates="1",e.SearchForSuggestions="2",e.SearchByPlaceId="3",e.SaveGeofences="4",e.GetGeofence="5",e.ListGeofences="6",e.DeleteGeofences="7"}(x||(x={})),function(e){e.SyncMessages="1",e.IdentifyUser="2",e.NotifyMessageInteraction="3"}(C||(C={})),function(e){e.None="0"}(v||(v={})),function(e){e.Convert="1",e.Identify="2",e.Interpret="3"}(P||(P={})),function(e){e.Subscribe="1"}(R||(R={})),function(e){e.InitializePushNotifications="1",e.IdentifyUser="2"}(T||(T={})),function(e){e.UploadData="1",e.DownloadData="2",e.List="3",e.Copy="4",e.Remove="5",e.GetProperties="6",e.GetUrl="7",e.GetDataAccess="8",e.ListCallerAccessGrants="9"}(N||(N={})),function(e){e.EmptySignInUsername="EmptySignInUsername",e.EmptySignInPassword="EmptySignInPassword",e.CustomAuthSignInPassword="CustomAuthSignInPassword",e.EmptySignUpUsername="EmptySignUpUsername",e.EmptySignUpPassword="EmptySignUpPassword",e.EmptyConfirmSignUpUsername="EmptyConfirmSignUpUsername",e.EmptyConfirmSignUpCode="EmptyConfirmSignUpCode",e.EmptyResendSignUpCodeUsername="EmptyresendSignUpCodeUsername",e.EmptyChallengeResponse="EmptyChallengeResponse",e.EmptyConfirmResetPasswordUsername="EmptyConfirmResetPasswordUsername",e.EmptyConfirmResetPasswordNewPassword="EmptyConfirmResetPasswordNewPassword",e.EmptyConfirmResetPasswordConfirmationCode="EmptyConfirmResetPasswordConfirmationCode",e.EmptyResetPasswordUsername="EmptyResetPasswordUsername",e.EmptyVerifyTOTPSetupCode="EmptyVerifyTOTPSetupCode",e.EmptyConfirmUserAttributeCode="EmptyConfirmUserAttributeCode",e.IncorrectMFAMethod="IncorrectMFAMethod",e.EmptyUpdatePassword="EmptyUpdatePassword"}(U||(U={}));const b={[U.EmptyChallengeResponse]:{message:"challengeResponse is required to confirmSignIn"},[U.EmptyConfirmResetPasswordUsername]:{message:"username is required to confirmResetPassword"},[U.EmptyConfirmSignUpCode]:{message:"code is required to confirmSignUp"},[U.EmptyConfirmSignUpUsername]:{message:"username is required to confirmSignUp"},[U.EmptyConfirmResetPasswordConfirmationCode]:{message:"confirmationCode is required to confirmResetPassword"},[U.EmptyConfirmResetPasswordNewPassword]:{message:"newPassword is required to confirmResetPassword"},[U.EmptyResendSignUpCodeUsername]:{message:"username is required to confirmSignUp"},[U.EmptyResetPasswordUsername]:{message:"username is required to resetPassword"},[U.EmptySignInPassword]:{message:"password is required to signIn"},[U.EmptySignInUsername]:{message:"username is required to signIn"},[U.EmptySignUpPassword]:{message:"password is required to signUp"},[U.EmptySignUpUsername]:{message:"username is required to signUp"},[U.CustomAuthSignInPassword]:{message:"A password is not needed when signing in with CUSTOM_WITHOUT_SRP",recoverySuggestion:"Do not include a password in your signIn call."},[U.IncorrectMFAMethod]:{message:"Incorrect MFA method was chosen. It should be either SMS, TOTP, or EMAIL",recoverySuggestion:"Try to pass SMS, TOTP, or EMAIL as the challengeResponse"},[U.EmptyVerifyTOTPSetupCode]:{message:"code is required to verifyTotpSetup"},[U.EmptyUpdatePassword]:{message:"oldPassword and newPassword are required to changePassword"},[U.EmptyConfirmUserAttributeCode]:{message:"confirmation code is required to confirmUserAttribute"}};var D,M;!function(e){e.DEFAULT_MSG="Authentication Error",e.EMPTY_EMAIL="Email cannot be empty",e.EMPTY_PHONE="Phone number cannot be empty",e.EMPTY_USERNAME="Username cannot be empty",e.INVALID_USERNAME="The username should either be a string or one of the sign in types",e.EMPTY_PASSWORD="Password cannot be empty",e.EMPTY_CODE="Confirmation code cannot be empty",e.SIGN_UP_ERROR="Error creating account",e.NO_MFA="No valid MFA method provided",e.INVALID_MFA="Invalid MFA type",e.EMPTY_CHALLENGE="Challenge response cannot be empty",e.NO_USER_SESSION="Failed to get the session because the user is empty",e.NETWORK_ERROR="Network Error",e.DEVICE_CONFIG="Device tracking has not been configured in this User Pool",e.AUTOSIGNIN_ERROR="Please use your credentials to sign in",e.OAUTH_ERROR="Couldn't finish OAuth flow, check your User Pool HostedUI settings"}(D||(D={})),function(e){e.SignInException="SignInException",e.OAuthSignInError="OAuthSignInException"}(M||(M={}));class _ extends s{constructor(e){super(e),this.constructor=_,Object.setPrototypeOf(this,_.prototype)}}function O(e,t){const{message:n,recoverySuggestion:o}=b[t];if(!e)throw new _({name:t,message:n,recoverySuggestion:o})}function k(e){const t=e?.split("_")[0];if(!e||e.indexOf("_")<0||!t||"string"!=typeof t)throw new _({name:"InvalidUserPoolId",message:"Invalid user pool id provided."});return t}function F(e){return Object.entries(e).map((([e,t])=>({Name:e,Value:t})))}const L="x-amz-user-agent";var V;!function(e){e.DEBUG="DEBUG",e.ERROR="ERROR",e.INFO="INFO",e.WARN="WARN",e.VERBOSE="VERBOSE",e.NONE="NONE"}(V||(V={}));const K={VERBOSE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,NONE:6};class W{constructor(e,t=V.WARN){this.name=e,this.level=t,this._pluggables=[]}_padding(e){return e<10?"0"+e:""+e}_ts(){const e=new Date;return[this._padding(e.getMinutes()),this._padding(e.getSeconds())].join(":")+"."+e.getMilliseconds()}configure(e){return e?(this._config=e,this._config):this._config}_log(e,...t){let n=this.level;if(W.LOG_LEVEL&&(n=W.LOG_LEVEL),"undefined"!=typeof window&&window.LOG_LEVEL&&(n=window.LOG_LEVEL),!(K[e]>=K[n]))return;let o=console.log.bind(console);e===V.ERROR&&console.error&&(o=console.error.bind(console)),e===V.WARN&&console.warn&&(o=console.warn.bind(console)),W.BIND_ALL_LOG_LEVELS&&(e===V.INFO&&console.info&&(o=console.info.bind(console)),e===V.DEBUG&&console.debug&&(o=console.debug.bind(console)));const i=`[${e}] ${this._ts()} ${this.name}`;let r="";if(1===t.length&&"string"==typeof t[0])r=`${i} - ${t[0]}`,o(r);else if(1===t.length)r=`${i} ${t[0]}`,o(i,t[0]);else if("string"==typeof t[0]){let e=t.slice(1);1===e.length&&(e=e[0]),r=`${i} - ${t[0]} ${e}`,o(`${i} - ${t[0]}`,e)}else r=`${i} ${t}`,o(i,t);for(const e of this._pluggables){const t={message:r,timestamp:Date.now()};e.pushLogs([t])}}log(...e){this._log(V.INFO,...e)}info(...e){this._log(V.INFO,...e)}warn(...e){this._log(V.WARN,...e)}error(...e){this._log(V.ERROR,...e)}debug(...e){this._log(V.DEBUG,...e)}verbose(...e){this._log(V.VERBOSE,...e)}addPluggable(e){e&&"Logging"===e.getCategoryName()&&(this._pluggables.push(e),e.configure(this._config))}listPluggables(){return this._pluggables}}W.LOG_LEVEL=null,W.BIND_ALL_LOG_LEVELS=!1;const B="undefined"!=typeof Symbol?Symbol("amplify_default"):"@@amplify_default",q=new W("Hub");class H{constructor(e){this.listeners=new Map,this.protectedChannels=["core","auth","api","analytics","interactions","pubsub","storage","ui","xr"],this.name=e}_remove(e,t){const n=this.listeners.get(e);n?this.listeners.set(e,[...n.filter((({callback:e})=>e!==t))]):q.warn(`No listeners for ${e}`)}dispatch(e,t,n,o){"string"==typeof e&&this.protectedChannels.indexOf(e)>-1&&(o===B||q.warn(`WARNING: ${e} is protected and dispatching on it can have unintended consequences`));const i={channel:e,payload:{...t},source:n,patternInfo:[]};try{this._toListeners(i)}catch(e){q.error(e)}}listen(e,t,n="noname"){let o;if("function"!=typeof t)throw new s({name:"NoHubcallbackProvidedException",message:"No callback supplied to Hub"});o=t;let i=this.listeners.get(e);return i||(i=[],this.listeners.set(e,i)),i.push({name:n,callback:o}),()=>{this._remove(e,o)}}_toListeners(e){const{channel:t,payload:n}=e,o=this.listeners.get(t);o&&o.forEach((o=>{q.debug(`Dispatching to ${t} with `,n);try{o.callback(e)}catch(e){q.error(e)}}))}}new H("__default__");const G=new H("internal-hub"),$=URL,z={convert(e,t={urlSafe:!1,skipPadding:!1}){const n="string"==typeof e?e:function(e){return Array.from(e,(e=>String.fromCodePoint(e))).join("")}(e);let o=(()=>{if("undefined"!=typeof window&&"function"==typeof window.btoa)return window.btoa;if("function"==typeof btoa)return btoa;throw new s({name:"Base64EncoderError",message:"Cannot resolve the `btoa` function from the environment."})})()(n);return t.urlSafe&&(o=o.replace(/\+/g,"-").replace(/\//g,"_")),t.skipPadding&&(o=o.replace(/=/g,"")),o}},j=async()=>{const{userAgentData:e}=navigator;if(!e)return navigator.userAgent;const{platform:t="",platformVersion:n="",model:o="",architecture:i="",fullVersionList:r=[]}=await e.getHighEntropyValues(["platform","platformVersion","architecture","model","fullVersionList"]);return[t,n,i,o,t,r.map((e=>`${e.brand}/${e.version}`)).join(";")].filter((e=>e)).join(" ")};var J,Y,Z,Q,X,ee,te,ne,oe,ie,re,se,ae,ce,de,ue,le,pe,he,ge,Ee,me,fe,ye;!function(e){e.ConcurrentModificationException="ConcurrentModificationException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException"}(J||(J={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(Y||(Y={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UsernameExistsException="UsernameExistsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(Z||(Z={})),function(e){e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyFailedAttemptsException="TooManyFailedAttemptsException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(Q||(Q={})),function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyFailedAttemptsException="TooManyFailedAttemptsException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"}(X||(X={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(ee||(ee={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(te||(te={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(ne||(ne={})),function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"}(oe||(oe={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(ie||(ie={})),function(e){e.ExternalServiceException="ExternalServiceException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceConflictException="ResourceConflictException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException"}(re||(re={})),function(e){e.ExternalServiceException="ExternalServiceException",e.InternalErrorException="InternalErrorException",e.InvalidIdentityPoolConfigurationException="InvalidIdentityPoolConfigurationException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceConflictException="ResourceConflictException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException"}(se||(se={})),function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(ae||(ae={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException"}(ce||(ce={})),function(e){e.PasswordResetRequiredException="PasswordResetRequiredException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(de||(de={})),function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"}(ue||(ue={})),function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.MFAMethodNotFoundException="MFAMethodNotFoundException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(le||(le={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(pe||(pe={})),function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UsernameExistsException="UsernameExistsException"}(he||(he={})),function(e){e.AliasExistsException="AliasExistsException",e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(ge||(ge={})),function(e){e.CodeMismatchException="CodeMismatchException",e.EnableSoftwareTokenMFAException="EnableSoftwareTokenMFAException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(Ee||(Ee={})),function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(me||(me={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(fe||(fe={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(ye||(ye={}));const Se="SetUpTOTPException",Ae="UserUnAuthenticatedException",Ie="UserAlreadyAuthenticatedException",we="DeviceMetadataNotFoundException",xe="AutoSignInException",Ce=new _({name:"InvalidRedirectException",message:"signInRedirect or signOutRedirect had an invalid format or was not found.",recoverySuggestion:"Please make sure the signIn/Out redirect in your oauth config is valid."}),ve=(new _({name:"InvalidAppSchemeException",message:"A valid non-http app scheme was not found in the config.",recoverySuggestion:"Please make sure a valid custom app scheme is present in the config."}),new _({name:"InvalidPreferredRedirectUrlException",message:"The given preferredRedirectUrl does not match any items in the redirectSignOutUrls array from the config.",recoverySuggestion:"Please make sure a matching preferredRedirectUrl is provided."})),Pe=new _({name:"InvalidOriginException",message:"redirect is coming from a different origin. The oauth flow needs to be initiated from the same origin",recoverySuggestion:"Please call signInWithRedirect from the same origin."}),Re="OAuthSignOutException";function Te(e){if(!e||!e.accessToken)throw new _({name:Ae,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}const Ne=new _({name:"TokenRefreshException",message:"Token refresh is not supported when authenticated with the 'implicit grant' (token) oauth flow. \n\tPlease change your oauth configuration to use 'code grant' flow.",recoverySuggestion:"Please logout and change your Amplify configuration to use \"code grant\" flow. \n\tE.g { responseType: 'code' }"}),Ue=new _({name:Ae,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."});function be(e){if(function(e){return _e(e)&&!e?.refreshToken}(e))throw Ne;if(!function(e){return _e(e)&&e?.refreshToken}(e))throw Ue}function De(e){if(!(e&&e.deviceKey&&e.deviceGroupKey&&e.randomPassword))throw new _({name:we,message:"Either deviceKey, deviceGroupKey or secretPassword were not found during the sign-in process.",recoverySuggestion:"Make sure to not clear storage after calling the signIn API."})}const Me={inflightOAuth:"inflightOAuth",oauthSignIn:"oauthSignIn",oauthPKCE:"oauthPKCE",oauthState:"oauthState"};function _e(e){return e?.accessToken||e?.idToken}const Oe=async()=>(async e=>{const t=e.getConfig().Auth?.Cognito;h(t);const n=await e.Auth.getTokens({forceRefresh:!1});Te(n);const{"cognito:username":o,sub:i}=n.idToken?.payload??{},r={username:o,userId:i},s=function(e){return e?.signInDetails}(n);return s&&(r.signInDetails=s),r})(r.Amplify),ke="6.10.2",Fe=()=>"undefined"!=typeof global,Le=()=>"undefined"!=typeof window,Ve=()=>"undefined"!=typeof document,Ke=()=>"undefined"!=typeof process,We=(e,t)=>!!Object.keys(e).find((e=>e.startsWith(t))),Be=[{platform:m.Expo,detectionMethod:function(){return Fe()&&void 0!==global.expo}},{platform:m.ReactNative,detectionMethod:function(){return"undefined"!=typeof navigator&&void 0!==navigator.product&&"ReactNative"===navigator.product}},{platform:m.NextJs,detectionMethod:function(){return Le()&&window.next&&"object"==typeof window.next}},{platform:m.Nuxt,detectionMethod:function(){return Le()&&(void 0!==window.__NUXT__||void 0!==window.$nuxt)}},{platform:m.Angular,detectionMethod:function(){const e=Boolean(Ve()&&document.querySelector("[ng-version]")),t=Boolean(Le()&&void 0!==window.ng);return e||t}},{platform:m.React,detectionMethod:function(){const e=e=>e.startsWith("_react")||e.startsWith("__react");return Ve()&&Array.from(document.querySelectorAll("[id]")).some((t=>Object.keys(t).find(e)))}},{platform:m.VueJs,detectionMethod:function(){return Le()&&We(window,"__VUE")}},{platform:m.Svelte,detectionMethod:function(){return Le()&&We(window,"__SVELTE")}},{platform:m.WebUnknown,detectionMethod:function(){return Le()}},{platform:m.NextJsSSR,detectionMethod:function(){return Fe()&&(We(global,"__next")||We(global,"__NEXT"))}},{platform:m.NuxtSSR,detectionMethod:function(){return Fe()&&void 0!==global.__NUXT_PATHS__}},{platform:m.ReactSSR,detectionMethod:function(){return Ke()&&void 0!==process.env&&!!Object.keys(process.env).find((e=>e.includes("react")))}},{platform:m.VueJsSSR,detectionMethod:function(){return Fe()&&We(global,"__VUE")}},{platform:m.AngularSSR,detectionMethod:function(){return Ke()&&"object"==typeof process.env&&process.env.npm_lifecycle_script?.startsWith("ng ")||!1}},{platform:m.SvelteSSR,detectionMethod:function(){return Ke()&&void 0!==process.env&&!!Object.keys(process.env).find((e=>e.includes("svelte")))}}];let qe;const He=[];let Ge=!1;const $e=()=>{if(!qe){if(qe=Be.find((e=>e.detectionMethod()))?.platform||m.ServerSideUnknown,Ge)for(;He.length;)He.pop()?.();else He.forEach((e=>{e()}));ze(m.ServerSideUnknown,10),ze(m.WebUnknown,10)}return qe};function ze(e,t){qe!==e||Ge||setTimeout((()=>{qe=void 0,Ge=!0,setTimeout($e,1e3)}),t)}const je={},Je="aws-amplify",Ye=e=>e.replace(/\+.*/,"");new class{constructor(){this.userAgent=`${Je}/${Ye(ke)}`}get framework(){return $e()}get isReactNative(){return this.framework===m.ReactNative||this.framework===m.Expo}observeFrameworkChanges(e){(e=>{Ge||He.push(e)})(e)}};const Ze=e=>(({category:e,action:t}={})=>{const n=[[Je,Ye(ke)]];if(e&&n.push([e,t]),n.push(["framework",$e()]),e&&t){const o=((e,t)=>je[e]?.[t]?.additionalDetails)(e,t);o&&o.forEach((e=>{n.push(e)}))}return n})(e).map((([e,t])=>e&&t?`${e}/${t}`:e)).join(" "),Qe=(e,t)=>Ze({category:f.Auth,action:e,...t}),Xe=(e,t,n,o)=>async(i,r)=>{const s={...o,...i},a=await s.endpointResolver(s,r),c=await t(r,a),d=await e(c,{...s});return n(d)},et=e=>(t,n)=>{const o=tt(e),i=JSON.stringify(t);return nt(n,o,i)},tt=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityProviderService.${e}`}),nt=({url:e},t,n)=>({headers:t,url:e,body:n,method:"POST"}),ot=e=>{const{headers:t,statusCode:n}=e;return{...it(e)?e.$metadata:{},httpStatusCode:n,requestId:t["x-amzn-requestid"]??t["x-amzn-request-id"]??t["x-amz-request-id"],extendedRequestId:t["x-amz-id-2"],cfId:t["x-amz-cf-id"]}},it=e=>"object"==typeof e?.$metadata,rt=async e=>{if(!e||e.statusCode<300)return;const t=await st(e),n=(e=>{const[t]=e.toString().split(/[,:]+/);return t.includes("#")?t.split("#")[1]:t})(e.headers["x-amzn-errortype"]??t.code??t.__type??"UnknownError"),o=t.message??t.Message??"Unknown error",i=new Error(o);return Object.assign(i,{name:n,$metadata:ot(e)})},st=async e=>{if(!e.body)throw new Error("Missing response payload");const t=await e.body.json();return Object.assign(t,{$metadata:ot(e)})};var at;function ct(e){if(!e||"Error"===e.name||e instanceof TypeError)throw new _({name:at.Unknown,message:"An unknown error has occurred.",underlyingError:e})}!function(e){e.NoEndpointId="NoEndpointId",e.PlatformNotSupported="PlatformNotSupported",e.Unknown="Unknown",e.NetworkError="NetworkError"}(at||(at={}));const dt=()=>async e=>{if(e.statusCode>=300){const t=await rt(e);throw ct(t),new _({name:t.name,message:t.message})}return st(e)},ut=(e,t)=>(n,o)=>{const i={};let r=t=>e(t,o);for(let e=t.length-1;e>=0;e--)r=(0,t[e])(o)(r,i);return r(n)},lt=(e,t)=>{if(t?.aborted)return Promise.resolve();let n,o;const i=new Promise((t=>{o=t,n=setTimeout(t,e)}));return t?.addEventListener("abort",(function e(i){clearTimeout(n),t?.removeEventListener("abort",e),o()})),i},pt=(e,t)=>{"[object Object]"===Object.prototype.toString.call(e)&&(e.$metadata={...e.$metadata??{},attempts:t})},ht=e=>{let t;return()=>(t||(t=e()),t)},gt=e=>!["HEAD","GET","DELETE"].includes(e.toUpperCase()),Et=ut((async({url:e,method:t,headers:n,body:o},{abortSignal:i,cache:r,withCrossDomainCredentials:a})=>{let c;try{c=await fetch(e,{method:t,headers:n,body:gt(t)?o:void 0,signal:i,cache:r,credentials:a?"include":"same-origin"})}catch(e){if(e instanceof TypeError)throw new s({name:at.NetworkError,message:"A network error has occurred.",underlyingError:e});throw e}const d={};return c.headers?.forEach(((e,t)=>{d[t.toLowerCase()]=e})),{statusCode:c.status,headers:d,body:null,body:Object.assign(c.body??{},{text:ht((()=>c.text())),blob:ht((()=>c.blob())),json:ht((()=>c.json()))})}}),[({userAgentHeader:e="x-amz-user-agent",userAgentValue:t=""})=>n=>async function(o){if(0===t.trim().length)return await n(o);{const i=e.toLowerCase();return o.headers[i]=o.headers[i]?`${o.headers[i]} ${t}`:t,await n(o)}},({maxAttempts:e=3,retryDecider:t,computeDelay:n,abortSignal:o})=>{if(e<1)throw new Error("maxAttempts must be greater than 0");return(i,r)=>async function(s){let a,c,d=r.attemptsCount??0;const u=()=>{if(c)return pt(c,d),c;throw pt(a,d),a};for(;!o?.aborted&&d<e;){try{c=await i(s),a=void 0}catch(e){a=e,c=void 0}d=(r.attemptsCount??0)>d?r.attemptsCount??0:d+1,r.attemptsCount=d;const{isCredentialsExpiredError:l,retryable:p}=await t(c,a,r);if(!p)return u();if(r.isCredentialsExpired=!!l,!o?.aborted&&d<e){const e=n(d);await lt(e,o)}}if(o?.aborted)throw new Error("Request aborted.");return u()}}]),mt=ut(Et,[()=>(e,t)=>async function(t){return t.headers["cache-control"]="no-store",e(t)}]),ft=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch","BadRequestException"],yt=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException"],St=["TimeoutError","RequestTimeout","RequestTimeoutException"],At=(e,t)=>429===e||!!t&&yt.includes(t),It=e=>[at.NetworkError,"ERR_NETWORK"].includes(e?.name),wt=(e,t)=>!!e&&[500,502,503,504].includes(e)||!!t&&St.includes(t),xt=3e5,Ct="cognito-idp",vt={service:Ct,retryDecider:(Pt=rt,async(e,t)=>{const n=t??await Pt(e)??void 0,o=n?.code||n?.name,i=e?.statusCode;return{retryable:It(t)||At(i,o)||(e=>!!e&&ft.includes(e))(o)||wt(i,o)}}),computeDelay:e=>{const t=function(e=3e5){return t=>{const n=2**t*100+100*Math.random();return!(n>e)&&n}}(xt),n=t(e);return!1===n?xt:n},userAgentValue:Ze(),cache:"no-store"};var Pt;const Rt=e=>Xe(mt,et("InitiateAuth"),dt(),{...vt,...e}),Tt=e=>Xe(mt,et("RespondToAuthChallenge"),dt(),{...vt,...e}),Nt=e=>Xe(mt,et("VerifySoftwareToken"),dt(),{...vt,...e}),Ut=e=>Xe(mt,et("AssociateSoftwareToken"),dt(),{...vt,...e}),bt=e=>Xe(mt,et("ConfirmDevice"),dt(),{...vt,...e}),Dt={id:"aws",outputs:{dnsSuffix:"amazonaws.com"},regionRegex:"^(us|eu|ap|sa|ca|me|af)\\-\\w+\\-\\d+$",regions:["aws-global"]},Mt={partitions:[Dt,{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn"},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:["aws-cn-global"]}]},_t=e=>{const{partitions:t}=Mt;for(const{regions:n,outputs:o,regionRegex:i}of t){const t=new RegExp(i);if(n.includes(e)||t.test(e))return o.dnsSuffix}return Dt.outputs.dnsSuffix},Ot=({endpointOverride:e})=>t=>e?{url:new $(e)}:(({region:e})=>({url:new $(`https://${Ct}.${e}.${_t(e)}`)}))(t);function kt({username:e,userPoolId:t,userPoolClientId:n}){if("undefined"==typeof window)return;const o=window.AmazonCognitoAdvancedSecurityData;if(void 0===o)return;const i=o.getData(e,t,n);return i?{EncodedData:i}:{}}const Ft=(e=>{let t;return async(...n)=>t||(t=new Promise(((o,i)=>{e(...n).then((e=>{o(e)})).catch((e=>{i(e)})).finally((()=>{t=void 0}))})),t)})((async({tokens:e,authConfig:t,username:n})=>{h(t?.Cognito);const{userPoolId:o,userPoolClientId:i,userPoolEndpoint:r}=t.Cognito,s=k(o);be(e);const a=e.refreshToken,c={REFRESH_TOKEN:a};e.deviceMetadata?.deviceKey&&(c.DEVICE_KEY=e.deviceMetadata.deviceKey);const d=kt({username:n,userPoolId:o,userPoolClientId:i}),u=Rt({endpointResolver:Ot({endpointOverride:r})}),{AuthenticationResult:l}=await u({region:s},{ClientId:i,AuthFlow:"REFRESH_TOKEN_AUTH",AuthParameters:c,UserContextData:d}),p=E(l?.AccessToken??""),g=l?.IdToken?E(l.IdToken):void 0,{iat:m}=p.payload;if(!m)throw new _({name:"iatNotFoundException",message:"iat not found in access token"});return{accessToken:p,idToken:g,clockDrift:1e3*m-(new Date).getTime(),refreshToken:a,username:n}})),Lt={accessToken:"accessToken",idToken:"idToken",oidcProvider:"oidcProvider",clockDrift:"clockDrift",refreshToken:"refreshToken",deviceKey:"deviceKey",randomPasswordKey:"randomPasswordKey",deviceGroupKey:"deviceGroupKey",signInDetails:"signInDetails",oauthMetadata:"oauthMetadata"};var Vt;!function(e){e.InvalidAuthTokens="InvalidAuthTokens"}(Vt||(Vt={}));const Kt=d({[Vt.InvalidAuthTokens]:{message:"Invalid tokens.",recoverySuggestion:"Make sure the tokens are valid."}});class Wt{constructor(){this.name="CognitoIdentityServiceProvider"}getKeyValueStorage(){if(!this.keyValueStorage)throw new _({name:"KeyValueStorageNotFoundException",message:"KeyValueStorage was not found in TokenStore"});return this.keyValueStorage}setKeyValueStorage(e){this.keyValueStorage=e}setAuthConfig(e){this.authConfig=e}async loadTokens(){try{const e=await this.getAuthKeys(),t=await this.getKeyValueStorage().getItem(e.accessToken);if(!t)throw new _({name:"NoSessionFoundException",message:"Auth session was not found. Make sure to call signIn."});const n=E(t),o=await this.getKeyValueStorage().getItem(e.idToken),i=o?E(o):void 0,r=await this.getKeyValueStorage().getItem(e.refreshToken)??void 0,s=await this.getKeyValueStorage().getItem(e.clockDrift)??"0",a=Number.parseInt(s),c=await this.getKeyValueStorage().getItem(e.signInDetails),d={accessToken:n,idToken:i,refreshToken:r,deviceMetadata:await this.getDeviceMetadata()??void 0,clockDrift:a,username:await this.getLastAuthUser()};return c&&(d.signInDetails=JSON.parse(c)),d}catch(e){return null}}async storeTokens(e){Kt(void 0!==e,Vt.InvalidAuthTokens),await this.clearTokens();const t=e.username;await this.getKeyValueStorage().setItem(this.getLastAuthUserKey(),t);const n=await this.getAuthKeys();await this.getKeyValueStorage().setItem(n.accessToken,e.accessToken.toString()),e.idToken&&await this.getKeyValueStorage().setItem(n.idToken,e.idToken.toString()),e.refreshToken&&await this.getKeyValueStorage().setItem(n.refreshToken,e.refreshToken),e.deviceMetadata&&(e.deviceMetadata.deviceKey&&await this.getKeyValueStorage().setItem(n.deviceKey,e.deviceMetadata.deviceKey),e.deviceMetadata.deviceGroupKey&&await this.getKeyValueStorage().setItem(n.deviceGroupKey,e.deviceMetadata.deviceGroupKey),await this.getKeyValueStorage().setItem(n.randomPasswordKey,e.deviceMetadata.randomPassword)),e.signInDetails&&await this.getKeyValueStorage().setItem(n.signInDetails,JSON.stringify(e.signInDetails)),await this.getKeyValueStorage().setItem(n.clockDrift,`${e.clockDrift}`)}async clearTokens(){const e=await this.getAuthKeys();await Promise.all([this.getKeyValueStorage().removeItem(e.accessToken),this.getKeyValueStorage().removeItem(e.idToken),this.getKeyValueStorage().removeItem(e.clockDrift),this.getKeyValueStorage().removeItem(e.refreshToken),this.getKeyValueStorage().removeItem(e.signInDetails),this.getKeyValueStorage().removeItem(this.getLastAuthUserKey()),this.getKeyValueStorage().removeItem(e.oauthMetadata)])}async getDeviceMetadata(e){const t=await this.getAuthKeys(e),n=await this.getKeyValueStorage().getItem(t.deviceKey),o=await this.getKeyValueStorage().getItem(t.deviceGroupKey),i=await this.getKeyValueStorage().getItem(t.randomPasswordKey);return i&&o&&n?{deviceKey:n,deviceGroupKey:o,randomPassword:i}:null}async clearDeviceMetadata(e){const t=await this.getAuthKeys(e);await Promise.all([this.getKeyValueStorage().removeItem(t.deviceKey),this.getKeyValueStorage().removeItem(t.deviceGroupKey),this.getKeyValueStorage().removeItem(t.randomPasswordKey)])}async getAuthKeys(e){h(this.authConfig?.Cognito);const t=e??await this.getLastAuthUser();return Bt(this.name,`${this.authConfig.Cognito.userPoolClientId}.${t}`)}getLastAuthUserKey(){h(this.authConfig?.Cognito);const e=this.authConfig.Cognito.userPoolClientId;return`${this.name}.${e}.LastAuthUser`}async getLastAuthUser(){return await this.getKeyValueStorage().getItem(this.getLastAuthUserKey())??"username"}async setOAuthMetadata(e){const{oauthMetadata:t}=await this.getAuthKeys();await this.getKeyValueStorage().setItem(t,JSON.stringify(e))}async getOAuthMetadata(){const{oauthMetadata:e}=await this.getAuthKeys(),t=await this.getKeyValueStorage().getItem(e);return t&&JSON.parse(t)}}const Bt=(e,t)=>qt(Lt)(`${e}`,t);function qt(e){const t=Object.values({...e});return(e,n)=>t.reduce(((t,o)=>({...t,[o]:`${e}.${n}.${o}`})),{})}const Ht=()=>"undefined"!=typeof window&&void 0!==window.document;function Gt({expiresAt:e,clockDrift:t}){return Date.now()+t>e}new W("Auth");const $t="amplify-signin-with-hostedUI",zt="CognitoIdentityServiceProvider";class jt{constructor(e){this.keyValueStorage=e}async clearOAuthInflightData(){h(this.cognitoConfig);const e=Jt(zt,this.cognitoConfig.userPoolClientId);await Promise.all([this.keyValueStorage.removeItem(e.inflightOAuth),this.keyValueStorage.removeItem(e.oauthPKCE),this.keyValueStorage.removeItem(e.oauthState)])}async clearOAuthData(){h(this.cognitoConfig);const e=Jt(zt,this.cognitoConfig.userPoolClientId);return await this.clearOAuthInflightData(),await this.keyValueStorage.removeItem($t),this.keyValueStorage.removeItem(e.oauthSignIn)}loadOAuthState(){h(this.cognitoConfig);const e=Jt(zt,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(e.oauthState)}storeOAuthState(e){h(this.cognitoConfig);const t=Jt(zt,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(t.oauthState,e)}loadPKCE(){h(this.cognitoConfig);const e=Jt(zt,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(e.oauthPKCE)}storePKCE(e){h(this.cognitoConfig);const t=Jt(zt,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(t.oauthPKCE,e)}setAuthConfig(e){this.cognitoConfig=e}async loadOAuthInFlight(){h(this.cognitoConfig);const e=Jt(zt,this.cognitoConfig.userPoolClientId);return"true"===await this.keyValueStorage.getItem(e.inflightOAuth)}async storeOAuthInFlight(e){h(this.cognitoConfig);const t=Jt(zt,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(t.inflightOAuth,`${e}`)}async loadOAuthSignIn(){h(this.cognitoConfig);const e=Jt(zt,this.cognitoConfig.userPoolClientId),t=await this.keyValueStorage.getItem($t),[n,o]=(await this.keyValueStorage.getItem(e.oauthSignIn))?.split(",")??[];return{isOAuthSignIn:"true"===n||"true"===t,preferPrivateSession:"true"===o}}async storeOAuthSignIn(e,t=!1){h(this.cognitoConfig);const n=Jt(zt,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(n.oauthSignIn,`${e},${t}`)}}const Jt=(e,t)=>qt(Me)(e,t),Yt=new jt(r.defaultStorage),Zt=[],Qt=()=>{for(;Zt.length;)Zt.pop()?.()};class Xt{constructor(){this.waitForInflightOAuth=Ht()?async()=>{if(await Yt.loadOAuthInFlight())return this.inflightPromise||(this.inflightPromise=new Promise(((e,t)=>{var n;n=e,Zt.push(n)}))),this.inflightPromise}:async()=>{}}setAuthConfig(e){Yt.setAuthConfig(e.Cognito),this.authConfig=e}setTokenRefresher(e){this.tokenRefresher=e}setAuthTokenStore(e){this.tokenStore=e}getTokenStore(){if(!this.tokenStore)throw new _({name:"EmptyTokenStoreException",message:"TokenStore not set"});return this.tokenStore}getTokenRefresher(){if(!this.tokenRefresher)throw new _({name:"EmptyTokenRefresherException",message:"TokenRefresher not set"});return this.tokenRefresher}async getTokens(e){let t;try{h(this.authConfig?.Cognito)}catch(e){return null}await this.waitForInflightOAuth(),this.inflightPromise=void 0,t=await this.getTokenStore().loadTokens();const n=await this.getTokenStore().getLastAuthUser();if(null===t)return null;const o=!!t?.idToken&&Gt({expiresAt:1e3*(t.idToken?.payload?.exp??0),clockDrift:t.clockDrift??0}),i=Gt({expiresAt:1e3*(t.accessToken?.payload?.exp??0),clockDrift:t.clockDrift??0});return(e?.forceRefresh||o||i)&&(t=await this.refreshTokens({tokens:t,username:n}),null===t)?null:{accessToken:t?.accessToken,idToken:t?.idToken,signInDetails:t?.signInDetails}}async refreshTokens({tokens:e,username:t}){try{const{signInDetails:n}=e,o=await this.getTokenRefresher()({tokens:e,authConfig:this.authConfig,username:t});return o.signInDetails=n,await this.setTokens({tokens:o}),r.Hub.dispatch("auth",{event:"tokenRefresh"},"Auth",B),o}catch(e){return this.handleErrors(e)}}handleErrors(e){if(ct(e),e.name!==at.NetworkError&&this.clearTokens(),r.Hub.dispatch("auth",{event:"tokenRefresh_failure",data:{error:e}},"Auth",B),e.name.startsWith("NotAuthorizedException"))return null;throw e}async setTokens({tokens:e}){return this.getTokenStore().storeTokens(e)}async clearTokens(){return this.getTokenStore().clearTokens()}getDeviceMetadata(e){return this.getTokenStore().getDeviceMetadata(e)}clearDeviceMetadata(e){return this.getTokenStore().clearDeviceMetadata(e)}setOAuthMetadata(e){return this.getTokenStore().setOAuthMetadata(e)}getOAuthMetadata(){return this.getTokenStore().getOAuthMetadata()}}const en=new class{constructor(){this.authTokenStore=new Wt,this.authTokenStore.setKeyValueStorage(r.defaultStorage),this.tokenOrchestrator=new Xt,this.tokenOrchestrator.setAuthTokenStore(this.authTokenStore),this.tokenOrchestrator.setTokenRefresher(Ft)}getTokens({forceRefresh:e}={forceRefresh:!1}){return this.tokenOrchestrator.getTokens({forceRefresh:e})}setKeyValueStorage(e){this.authTokenStore.setKeyValueStorage(e)}setAuthConfig(e){this.authTokenStore.setAuthConfig(e),this.tokenOrchestrator.setAuthConfig(e)}},{tokenOrchestrator:tn}=en;async function nn(e){if(!e.AccessToken)throw new s({message:"Invalid tokens",name:"InvalidTokens",recoverySuggestion:"Check Cognito UserPool settings"});{const t=E(e.AccessToken),n=1e3*(t.payload.iat||0),o=(new Date).getTime(),i=n>0?n-o:0;let r,s,a;e.RefreshToken&&(s=e.RefreshToken),e.IdToken&&(r=E(e.IdToken)),e?.NewDeviceMetadata&&(a=e.NewDeviceMetadata);const c={accessToken:t,idToken:r,refreshToken:s,clockDrift:i,deviceMetadata:a,username:e.username};e?.signInDetails&&(c.signInDetails=e.signInDetails),await tn.setTokens({tokens:c})}}const on=async()=>{try{r.Hub.dispatch("auth",{event:"signedIn",data:await Oe()},"Auth",B)}catch(e){if(e.name===Ae)throw new _({name:"UnexpectedSignInInterruptionException",message:"Unable to get user session following successful sign-in.",recoverySuggestion:"This most likely is due to auth tokens not being persisted. If you are using cookie store, please ensure cookies can be correctly set from your server."});throw e}};const rn=(e=>{let t=e({username:void 0,challengeName:void 0,signInSession:void 0},{type:"SET_INITIAL_STATE"});return{getState:()=>t,dispatch:n=>{t=e(t,n)}}})(((e,t)=>{switch(t.type){case"SET_SIGN_IN_SESSION":return{...e,signInSession:t.value};case"SET_SIGN_IN_STATE":return{...t.value};case"SET_CHALLENGE_NAME":return{...e,challengeName:t.value};case"SET_USERNAME":return{...e,username:t.value};case"SET_INITIAL_STATE":return{username:void 0,challengeName:void 0,signInSession:void 0};default:return e}}));function sn(e){rn.dispatch({type:"SET_SIGN_IN_STATE",value:e})}function an(){rn.dispatch({type:"SET_INITIAL_STATE"})}class cn extends s{constructor(e){super(e),this.constructor=cn,Object.setPrototypeOf(this,cn.prototype)}}var dn;!function(e){e.PasskeyNotSupported="PasskeyNotSupported",e.PasskeyAlreadyExists="PasskeyAlreadyExists",e.InvalidPasskeyRegistrationOptions="InvalidPasskeyRegistrationOptions",e.InvalidPasskeyAuthenticationOptions="InvalidPasskeyAuthenticationOptions",e.RelyingPartyMismatch="RelyingPartyMismatch",e.PasskeyRegistrationFailed="PasskeyRegistrationFailed",e.PasskeyRetrievalFailed="PasskeyRetrievalFailed",e.PasskeyRegistrationCanceled="PasskeyRegistrationCanceled",e.PasskeyAuthenticationCanceled="PasskeyAuthenticationCanceled",e.PasskeyOperationAborted="PasskeyOperationAborted"}(dn||(dn={}));const un="Passkeys may not be supported on this device. Ensure your application is running in a secure context (HTTPS) and Web Authentication API is supported.",ln="User may have canceled the ceremony or another interruption has occurred. Check underlying error for details.",pn="Ensure your user pool is configured to support the WEB_AUTHN as an authentication factor.",hn={[dn.PasskeyNotSupported]:{message:"Passkeys may not be supported on this device.",recoverySuggestion:un},[dn.InvalidPasskeyRegistrationOptions]:{message:"Invalid passkey registration options.",recoverySuggestion:pn},[dn.InvalidPasskeyAuthenticationOptions]:{message:"Invalid passkey authentication options.",recoverySuggestion:pn},[dn.PasskeyRegistrationFailed]:{message:"Device failed to create passkey.",recoverySuggestion:un},[dn.PasskeyRetrievalFailed]:{message:"Device failed to retrieve passkey.",recoverySuggestion:"Passkeys may not be available on this device. Try an alternative authentication factor like PASSWORD, EMAIL_OTP, or SMS_OTP."},[dn.PasskeyAlreadyExists]:{message:"Passkey already exists in authenticator.",recoverySuggestion:"Proceed with existing passkey or try again after deleting the credential."},[dn.PasskeyRegistrationCanceled]:{message:"Passkey registration ceremony has been canceled.",recoverySuggestion:ln},[dn.PasskeyAuthenticationCanceled]:{message:"Passkey authentication ceremony has been canceled.",recoverySuggestion:ln},[dn.PasskeyOperationAborted]:{message:"Passkey operation has been aborted.",recoverySuggestion:ln},[dn.RelyingPartyMismatch]:{message:"Relying party does not match current domain.",recoverySuggestion:"Ensure relying party identifier matches current domain."}},gn=d(hn,cn),En=e=>{if(e instanceof Error){if("AbortError"===e.name){const{message:t,recoverySuggestion:n}=hn[dn.PasskeyOperationAborted];return new cn({name:dn.PasskeyOperationAborted,message:t,recoverySuggestion:n,underlyingError:e})}if("SecurityError"===e.name){const{message:t,recoverySuggestion:n}=hn[dn.RelyingPartyMismatch];return new cn({name:dn.RelyingPartyMismatch,message:t,recoverySuggestion:n,underlyingError:e})}}return new cn({name:at.Unknown,message:"An unknown error has occurred.",underlyingError:e})},mn=()=>Ht()&&window.isSecureContext&&"credentials"in navigator&&"function"==typeof window.PublicKeyCredential,fn=e=>z.convert(new Uint8Array(e),{urlSafe:!0,skipPadding:!0}),yn=e=>Uint8Array.from(c.convert(e,{urlSafe:!0}),(e=>e.charCodeAt(0))).buffer,Sn=async e=>{try{const t=mn();gn(t,dn.PasskeyNotSupported);const n=(e=>{const t=yn(e.challenge),n=(e.allowCredentials||[]).map((e=>({...e,id:yn(e.id)})));return{...e,challenge:t,allowCredentials:n}})(e),o=await navigator.credentials.get({publicKey:n});return function(e){gn(e&&e instanceof PublicKeyCredential&&e.response instanceof AuthenticatorAssertionResponse,dn.PasskeyRetrievalFailed)}(o),(e=>{const t={clientDataJSON:fn(e.response.clientDataJSON),authenticatorData:fn(e.response.authenticatorData),signature:fn(e.response.signature)};e.response.userHandle&&(t.userHandle=fn(e.response.userHandle));const n={id:e.id,rawId:fn(e.rawId),type:e.type,clientExtensionResults:e.getClientExtensionResults(),response:t};return e.authenticatorAttachment&&(n.authenticatorAttachment=e.authenticatorAttachment),n})(o)}catch(e){throw(e=>{if(e instanceof cn)return e;if(e instanceof Error&&"NotAllowedError"===e.name){const{message:t,recoverySuggestion:n}=hn[dn.PasskeyAuthenticationCanceled];return new cn({name:dn.PasskeyAuthenticationCanceled,message:t,recoverySuggestion:n,underlyingError:e})}return En(e)})(e)}},An={convert:e=>(new TextEncoder).encode(e)};function In(e,t){null!=e&&this.fromString(e,t)}function wn(){return new In(null,null)}let xn;const Cn="undefined"!=typeof navigator;Cn&&"Microsoft Internet Explorer"===navigator.appName?(In.prototype.am=function(e,t,n,o,i,r){const s=32767&t,a=t>>15;for(;--r>=0;){let t=32767&this[e];const r=this[e++]>>15,c=a*t+r*s;t=s*t+((32767&c)<<15)+n[o]+(1073741823&i),i=(t>>>30)+(c>>>15)+a*r+(i>>>30),n[o++]=1073741823&t}return i},xn=30):Cn&&"Netscape"!==navigator.appName?(In.prototype.am=function(e,t,n,o,i,r){for(;--r>=0;){const r=t*this[e++]+n[o]+i;i=Math.floor(r/67108864),n[o++]=67108863&r}return i},xn=26):(In.prototype.am=function(e,t,n,o,i,r){const s=16383&t,a=t>>14;for(;--r>=0;){let t=16383&this[e];const r=this[e++]>>14,c=a*t+r*s;t=s*t+((16383&c)<<14)+n[o]+i,i=(t>>28)+(c>>14)+a*r,n[o++]=268435455&t}return i},xn=28),In.prototype.DB=xn,In.prototype.DM=(1<<xn)-1,In.prototype.DV=1<<xn,In.prototype.FV=Math.pow(2,52),In.prototype.F1=52-xn,In.prototype.F2=2*xn-52;const vn=[];let Pn,Rn;for(Pn="0".charCodeAt(0),Rn=0;Rn<=9;++Rn)vn[Pn++]=Rn;for(Pn="a".charCodeAt(0),Rn=10;Rn<36;++Rn)vn[Pn++]=Rn;for(Pn="A".charCodeAt(0),Rn=10;Rn<36;++Rn)vn[Pn++]=Rn;function Tn(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function Nn(e,t){const n=vn[e.charCodeAt(t)];return null==n?-1:n}function Un(e){const t=wn();return t.fromInt(e),t}function bn(e){let t,n=1;return 0!=(t=e>>>16)&&(e=t,n+=16),0!=(t=e>>8)&&(e=t,n+=8),0!=(t=e>>4)&&(e=t,n+=4),0!=(t=e>>2)&&(e=t,n+=2),0!=(t=e>>1)&&(e=t,n+=1),n}function Dn(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}Dn.prototype.convert=function(e){const t=wn();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(In.ZERO)>0&&this.m.subTo(t,t),t},Dn.prototype.revert=function(e){const t=wn();return e.copyTo(t),this.reduce(t),t},Dn.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(let t=0;t<this.m.t;++t){let n=32767&e[t];const o=n*this.mpl+((n*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(n=t+this.m.t,e[n]+=this.m.am(0,o,e,t,0,this.m.t);e[n]>=e.DV;)e[n]-=e.DV,e[++n]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},Dn.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n),this.reduce(n)},Dn.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},In.prototype.copyTo=function(e){for(let t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},In.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0},In.prototype.fromString=function(e,t){let n;if(16===t)n=4;else if(8===t)n=3;else if(2===t)n=1;else if(32===t)n=5;else{if(4!==t)throw new Error("Only radix 2, 4, 8, 16, 32 are supported");n=2}this.t=0,this.s=0;let o=e.length,i=!1,r=0;for(;--o>=0;){const t=Nn(e,o);t<0?"-"===e.charAt(o)&&(i=!0):(i=!1,0===r?this[this.t++]=t:r+n>this.DB?(this[this.t-1]|=(t&(1<<this.DB-r)-1)<<r,this[this.t++]=t>>this.DB-r):this[this.t-1]|=t<<r,r+=n,r>=this.DB&&(r-=this.DB))}this.clamp(),i&&In.ZERO.subTo(this,this)},In.prototype.clamp=function(){const e=this.s&this.DM;for(;this.t>0&&this[this.t-1]==e;)--this.t},In.prototype.dlShiftTo=function(e,t){let n;for(n=this.t-1;n>=0;--n)t[n+e]=this[n];for(n=e-1;n>=0;--n)t[n]=0;t.t=this.t+e,t.s=this.s},In.prototype.drShiftTo=function(e,t){for(let n=e;n<this.t;++n)t[n-e]=this[n];t.t=Math.max(this.t-e,0),t.s=this.s},In.prototype.lShiftTo=function(e,t){const n=e%this.DB,o=this.DB-n,i=(1<<o)-1,r=Math.floor(e/this.DB);let s,a=this.s<<n&this.DM;for(s=this.t-1;s>=0;--s)t[s+r+1]=this[s]>>o|a,a=(this[s]&i)<<n;for(s=r-1;s>=0;--s)t[s]=0;t[r]=a,t.t=this.t+r+1,t.s=this.s,t.clamp()},In.prototype.rShiftTo=function(e,t){t.s=this.s;const n=Math.floor(e/this.DB);if(n>=this.t)return void(t.t=0);const o=e%this.DB,i=this.DB-o,r=(1<<o)-1;t[0]=this[n]>>o;for(let e=n+1;e<this.t;++e)t[e-n-1]|=(this[e]&r)<<i,t[e-n]=this[e]>>o;o>0&&(t[this.t-n-1]|=(this.s&r)<<i),t.t=this.t-n,t.clamp()},In.prototype.subTo=function(e,t){let n=0,o=0;const i=Math.min(e.t,this.t);for(;n<i;)o+=this[n]-e[n],t[n++]=o&this.DM,o>>=this.DB;if(e.t<this.t){for(o-=e.s;n<this.t;)o+=this[n],t[n++]=o&this.DM,o>>=this.DB;o+=this.s}else{for(o+=this.s;n<e.t;)o-=e[n],t[n++]=o&this.DM,o>>=this.DB;o-=e.s}t.s=o<0?-1:0,o<-1?t[n++]=this.DV+o:o>0&&(t[n++]=o),t.t=n,t.clamp()},In.prototype.multiplyTo=function(e,t){const n=this.abs(),o=e.abs();let i=n.t;for(t.t=i+o.t;--i>=0;)t[i]=0;for(i=0;i<o.t;++i)t[i+n.t]=n.am(0,o[i],t,i,0,n.t);t.s=0,t.clamp(),this.s!==e.s&&In.ZERO.subTo(t,t)},In.prototype.squareTo=function(e){const t=this.abs();let n=e.t=2*t.t;for(;--n>=0;)e[n]=0;for(n=0;n<t.t-1;++n){const o=t.am(n,t[n],e,2*n,0,1);(e[n+t.t]+=t.am(n+1,2*t[n],e,2*n+1,o,t.t-n-1))>=t.DV&&(e[n+t.t]-=t.DV,e[n+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(n,t[n],e,2*n,0,1)),e.s=0,e.clamp()},In.prototype.divRemTo=function(e,t,n){const o=e.abs();if(o.t<=0)return;const i=this.abs();if(i.t<o.t)return null!=t&&t.fromInt(0),void(null!=n&&this.copyTo(n));null===n&&(n=wn());const r=wn(),s=this.s,a=e.s,c=this.DB-bn(o[o.t-1]);c>0?(o.lShiftTo(c,r),i.lShiftTo(c,n)):(o.copyTo(r),i.copyTo(n));const d=r.t,u=r[d-1];if(0===u)return;const l=u*(1<<this.F1)+(d>1?r[d-2]>>this.F2:0),p=this.FV/l,h=(1<<this.F1)/l,g=1<<this.F2;let E=n.t,m=E-d;const f=null===t?wn():t;for(r.dlShiftTo(m,f),n.compareTo(f)>=0&&(n[n.t++]=1,n.subTo(f,n)),In.ONE.dlShiftTo(d,f),f.subTo(r,r);r.t<d;)r[r.t++]=0;for(;--m>=0;){let e=n[--E]===u?this.DM:Math.floor(n[E]*p+(n[E-1]+g)*h);if((n[E]+=r.am(0,e,n,m,0,d))<e)for(r.dlShiftTo(m,f),n.subTo(f,n);n[E]<--e;)n.subTo(f,n)}null!==t&&(n.drShiftTo(d,t),s!==a&&In.ZERO.subTo(t,t)),n.t=d,n.clamp(),c>0&&n.rShiftTo(c,n),s<0&&In.ZERO.subTo(n,n)},In.prototype.invDigit=function(){if(this.t<1)return 0;const e=this[0];if(!(1&e))return 0;let t=3&e;return t=t*(2-(15&e)*t)&15,t=t*(2-(255&e)*t)&255,t=t*(2-((65535&e)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t},In.prototype.addTo=function(e,t){let n=0,o=0;const i=Math.min(e.t,this.t);for(;n<i;)o+=this[n]+e[n],t[n++]=o&this.DM,o>>=this.DB;if(e.t<this.t){for(o+=e.s;n<this.t;)o+=this[n],t[n++]=o&this.DM,o>>=this.DB;o+=this.s}else{for(o+=this.s;n<e.t;)o+=e[n],t[n++]=o&this.DM,o>>=this.DB;o+=e.s}t.s=o<0?-1:0,o>0?t[n++]=o:o<-1&&(t[n++]=this.DV+o),t.t=n,t.clamp()},In.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);let t;if(16==e)t=4;else if(8===e)t=3;else if(2===e)t=1;else if(32===e)t=5;else{if(4!==e)throw new Error("Only radix 2, 4, 8, 16, 32 are supported");t=2}const n=(1<<t)-1;let o,i=!1,r="",s=this.t,a=this.DB-s*this.DB%t;if(s-- >0)for(a<this.DB&&(o=this[s]>>a)>0&&(i=!0,r=Tn(o));s>=0;)a<t?(o=(this[s]&(1<<a)-1)<<t-a,o|=this[--s]>>(a+=this.DB-t)):(o=this[s]>>(a-=t)&n,a<=0&&(a+=this.DB,--s)),o>0&&(i=!0),i&&(r+=Tn(o));return i?r:"0"},In.prototype.negate=function(){const e=wn();return In.ZERO.subTo(this,e),e},In.prototype.abs=function(){return this.s<0?this.negate():this},In.prototype.compareTo=function(e){let t=this.s-e.s;if(0!=t)return t;let n=this.t;if(t=n-e.t,0!=t)return this.s<0?-t:t;for(;--n>=0;)if(0!=(t=this[n]-e[n]))return t;return 0},In.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+bn(this[this.t-1]^this.s&this.DM)},In.prototype.mod=function(e){const t=wn();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(In.ZERO)>0&&e.subTo(t,t),t},In.prototype.equals=function(e){return 0===this.compareTo(e)},In.prototype.add=function(e){const t=wn();return this.addTo(e,t),t},In.prototype.subtract=function(e){const t=wn();return this.subTo(e,t),t},In.prototype.multiply=function(e){const t=wn();return this.multiplyTo(e,t),t},In.prototype.divide=function(e){const t=wn();return this.divRemTo(e,t,null),t},In.prototype.modPow=function(e,t,n){let o,i=e.bitLength(),r=Un(1);const s=new Dn(t);if(i<=0)return r;o=i<18?1:i<48?3:i<144?4:i<768?5:6;const a=[];let c=3;const d=o-1,u=(1<<o)-1;if(a[1]=s.convert(this),o>1){const e=wn();for(s.sqrTo(a[1],e);c<=u;)a[c]=wn(),s.mulTo(e,a[c-2],a[c]),c+=2}let l,p,h=e.t-1,g=!0,E=wn();for(i=bn(e[h])-1;h>=0;){for(i>=d?l=e[h]>>i-d&u:(l=(e[h]&(1<<i+1)-1)<<d-i,h>0&&(l|=e[h-1]>>this.DB+i-d)),c=o;!(1&l);)l>>=1,--c;if((i-=c)<0&&(i+=this.DB,--h),g)a[l].copyTo(r),g=!1;else{for(;c>1;)s.sqrTo(r,E),s.sqrTo(E,r),c-=2;c>0?s.sqrTo(r,E):(p=r,r=E,E=p),s.mulTo(E,a[l],r)}for(;h>=0&&!(e[h]&1<<i);)s.sqrTo(r,E),p=r,r=E,E=p,--i<0&&(i=this.DB-1,--h)}const m=s.revert(r);return n(null,m),m},In.ZERO=Un(0),In.ONE=Un(1);const Mn={},_n={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();1===t.length&&(t=`0${t}`),Mn[e]=t,_n[t]=e}const On=e=>{if(e.length%2!=0)throw new Error("Hex encoded strings must have an even number length");const t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2){const o=e.slice(n,n+2).toLowerCase();if(!(o in _n))throw new Error(`Cannot decode unrecognized sequence ${o} as hexadecimal`);t[n/2]=_n[o]}return t};Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var kn=64,Fn=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ln=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],Vn=Math.pow(2,53)-1,Kn=function(){function e(){this.state=Int32Array.from(Ln),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");var t=0,n=e.byteLength;if(this.bytesHashed+=n,8*this.bytesHashed>Vn)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;n>0;)this.buffer[this.bufferLength++]=e[t++],n--,this.bufferLength===kn&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var e=8*this.bytesHashed,t=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(t.setUint8(this.bufferLength++,128),n%kn>=56){for(var o=this.bufferLength;o<kn;o++)t.setUint8(o,0);this.hashBuffer(),this.bufferLength=0}for(o=this.bufferLength;o<56;o++)t.setUint8(o,0);t.setUint32(56,Math.floor(e/4294967296),!0),t.setUint32(60,e),this.hashBuffer(),this.finished=!0}var i=new Uint8Array(32);for(o=0;o<8;o++)i[4*o]=this.state[o]>>>24&255,i[4*o+1]=this.state[o]>>>16&255,i[4*o+2]=this.state[o]>>>8&255,i[4*o+3]=this.state[o]>>>0&255;return i},e.prototype.hashBuffer=function(){for(var e=this.buffer,t=this.state,n=t[0],o=t[1],i=t[2],r=t[3],s=t[4],a=t[5],c=t[6],d=t[7],u=0;u<kn;u++){if(u<16)this.temp[u]=(255&e[4*u])<<24|(255&e[4*u+1])<<16|(255&e[4*u+2])<<8|255&e[4*u+3];else{var l=this.temp[u-2],p=(l>>>17|l<<15)^(l>>>19|l<<13)^l>>>10,h=((l=this.temp[u-15])>>>7|l<<25)^(l>>>18|l<<14)^l>>>3;this.temp[u]=(p+this.temp[u-7]|0)+(h+this.temp[u-16]|0)}var g=(((s>>>6|s<<26)^(s>>>11|s<<21)^(s>>>25|s<<7))+(s&a^~s&c)|0)+(d+(Fn[u]+this.temp[u]|0)|0)|0,E=((n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10))+(n&o^n&i^o&i)|0;d=c,c=a,a=s,s=r+g|0,r=i,i=o,o=n,n=g+E|0}t[0]+=n,t[1]+=o,t[2]+=i,t[3]+=r,t[4]+=s,t[5]+=a,t[6]+=c,t[7]+=d},e}(),Wn="undefined"!=typeof Buffer&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:e=>(new TextEncoder).encode(e);function Bn(e){return e instanceof Uint8Array?e:"string"==typeof e?Wn(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}var qn=function(){function e(e){this.secret=e,this.hash=new Kn,this.reset()}return e.prototype.update=function(e){var t;if(("string"==typeof(t=e)?0!==t.length:0!==t.byteLength)&&!this.error)try{this.hash.update(Bn(e))}catch(e){this.error=e}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return e=this,t=void 0,o=function(){return function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&a[0]?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){r=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(6===a[0]&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=t.call(e,r)}catch(e){a=[6,e],o=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,(function(e){return[2,this.digestSync()]}))},new((n=void 0)||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}));var e,t,n,o},e.prototype.reset=function(){if(this.hash=new Kn,this.secret){this.outer=new Kn;var e=function(e){var t=Bn(e);if(t.byteLength>kn){var n=new Kn;n.update(t),t=n.digest()}var o=new Uint8Array(kn);return o.set(t),o}(this.secret),t=new Uint8Array(kn);t.set(e);for(var n=0;n<kn;n++)e[n]^=54,t[n]^=92;for(this.hash.update(e),this.outer.update(t),n=0;n<e.byteLength;n++)e[n]=0}},e}();const Hn=e=>{let t="";for(let n=0;n<e.byteLength;n++)t+=Mn[e[n]];return t},Gn=e=>{const t=new qn;t.update(e);const n=t.digestSync(),o=Hn(n);return new Array(64-o.length).join("0")+o},$n=e=>Gn(On(e)),zn=/^[89a-f]/i,jn=e=>{if(!(e instanceof In))throw new Error("Not a BigInteger");const t=e.compareTo(In.ZERO)<0;let n=e.abs().toString(16);if(n=n.length%2!=0?`0${n}`:n,n=zn.test(n)?`00${n}`:n,t){const e=n.split("").map((e=>{const t=15&~parseInt(e,16);return"0123456789ABCDEF".charAt(t)})).join("");n=new In(e,16).add(In.ONE).toString(16),n.toUpperCase().startsWith("FF8")&&(n=n.substring(2))}return n};class Jn{constructor(e,t){this.words=[];let n=e;n=this.words=n||[],this.sigBytes=void 0!==t?t:4*n.length}random(e){const t=[];for(let n=0;n<e;n+=4)t.push(a().getRandomValues(new Uint32Array(1))[0]);return new Jn(t,e)}toString(){return function(e){const{words:t}=e,{sigBytes:n}=e,o=[];for(let e=0;e<n;e++){const n=t[e>>>2]>>>24-e%4*8&255;o.push((n>>>4).toString(16)),o.push((15&n).toString(16))}return o.join("")}(this)}}const Yn=e=>{const t=(new Jn).random(e).toString();return On(t)};class Zn{constructor({userPoolName:e,a:t,g:n,A:o,N:i}){this.encoder=An,this.userPoolName=e,this.a=t,this.g=n,this.A=o,this.N=i,this.k=new In($n(`${jn(i)}${jn(n)}`),16)}getRandomPassword(){if(!this.randomPassword)throw new _({name:"EmptyBigIntegerRandomPassword",message:"random password is empty"});return this.randomPassword}getSaltToHashDevices(){if(!this.saltToHashDevices)throw new _({name:"EmptyBigIntegersaltToHashDevices",message:"saltToHashDevices is empty"});return this.saltToHashDevices}getVerifierDevices(){if(!this.verifierDevices)throw new _({name:"EmptyBigIntegerVerifierDevices",message:"verifyDevices is empty"});return this.verifierDevices}async generateHashDevice(e,t){this.randomPassword=z.convert(Yn(40));const n=`${e}${t}:${this.randomPassword}`,o=Gn(n),i=Hn(Yn(16));return this.saltToHashDevices=jn(new In(i,16)),new Promise(((e,t)=>{this.g.modPow(new In($n(this.saltToHashDevices+o),16),this.N,((n,o)=>{n?t(n):(this.verifierDevices=jn(o),e())}))}))}async getPasswordAuthenticationKey({username:e,password:t,serverBValue:n,salt:o}){if(n.mod(this.N).equals(In.ZERO))throw new Error("B cannot be zero.");const i=(({A:e,B:t})=>{const n=new In($n(jn(e)+jn(t)),16);if(n.equals(In.ZERO))throw new Error("U cannot be zero.");return n})({A:this.A,B:n}),r=`${this.userPoolName}${e}:${t}`,s=Gn(r),a=new In($n(jn(o)+s),16),c=await(async({a:e,g:t,k:n,x:o,B:i,N:r,U:s})=>new Promise(((a,c)=>{t.modPow(o,r,((t,d)=>{t?c(t):i.subtract(n.multiply(d)).modPow(e.add(s.multiply(o)),r,((e,t)=>{e?c(e):a(t.mod(r))}))}))})))({a:this.a,g:this.g,k:this.k,x:a,B:n,N:this.N,U:i}),d=this.encoder.convert("Caldera Derived Key"),u=this.encoder.convert(String.fromCharCode(1)),l=new Uint8Array(d.byteLength+u.byteLength);l.set(d,0),l.set(u,d.byteLength);const p=((e,t,n)=>{const o=new qn(t);o.update(e);const i=o.digestSync(),r=new qn(i);return r.update(n),r.digestSync().slice(0,16)})(On(jn(c)),On(jn(i)),l);return p}}const Qn=async e=>{const t=new In("FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A93AD2CAFFFFFFFFFFFFFFFF",16),n=new In("2",16),o=Xn(),i=await(async({a:e,g:t,N:n})=>new Promise(((o,i)=>{t.modPow(e,n,((e,t)=>{e?i(e):t.mod(n).equals(In.ZERO)?i(new Error("Illegal parameter. A mod N cannot be 0.")):o(t)}))})))({a:o,g:n,N:t});return new Zn({userPoolName:e,a:o,g:n,A:i,N:t})},Xn=()=>new In(Hn(Yn(128)),16);async function eo({username:e,password:t,clientMetadata:n,config:o,tokenOrchestrator:i,authFlow:r,preferredChallenge:s}){const{userPoolId:a,userPoolClientId:c,userPoolEndpoint:d}=o,u=a?.split("_")[1]||"",l=await Qn(u),p={USERNAME:e,SRP_A:l.A.toString(16)};"USER_AUTH"===r&&s&&(p.PREFERRED_CHALLENGE=s);const h={AuthFlow:r,AuthParameters:p,ClientMetadata:n,ClientId:c,UserContextData:kt({username:e,userPoolId:a,userPoolClientId:c})},g=Rt({endpointResolver:Ot({endpointOverride:d})}),E=await g({region:k(a),userAgentValue:Qe(I.SignIn)},h),{ChallengeParameters:m,Session:f}=E,y=m?.USERNAME??e;return vo(y),"PASSWORD_VERIFIER"===E.ChallengeName?Co(po,[t,m,n,f,l,o,i],y,i):E}const to=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],no=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],oo=()=>{const e=new Date,t=no[e.getUTCDay()],n=to[e.getUTCMonth()],o=e.getUTCDate();let i=e.getUTCHours();i<10&&(i=`0${i}`);let r=e.getUTCMinutes();r<10&&(r=`0${r}`);let s=e.getUTCSeconds();return s<10&&(s=`0${s}`),`${t} ${n} ${o} ${i}:${r}:${s} UTC ${e.getUTCFullYear()}`},io=({userPoolName:e,username:t,challengeParameters:n,dateNow:o,hkdf:i})=>{const r=An.convert(e),s=An.convert(t),a=ro(n.SECRET_BLOCK),c=An.convert(o),d=new Uint8Array(r.byteLength+s.byteLength+a.byteLength+c.byteLength);d.set(r,0),d.set(s,r.byteLength),d.set(a,r.byteLength+s.byteLength),d.set(c,r.byteLength+s.byteLength+a.byteLength);const u=new qn(i);u.update(d);const l=u.digestSync();return z.convert(l)},ro=e=>{const t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),n=c.convert(t),o=new Uint8Array(n.length);for(let e=0;e<n.length;++e)o[e]=n.charCodeAt(e);return o},so="userAttributes.";async function ao({challengeResponse:e,clientMetadata:t,session:n,username:o,config:i,tokenOrchestrator:r}){const{userPoolId:s,userPoolClientId:a,userPoolEndpoint:c}=i,d={USERNAME:o,ANSWER:e},u=await(r?.getDeviceMetadata(o));u&&u.deviceKey&&(d.DEVICE_KEY=u.deviceKey);const l={ChallengeName:"CUSTOM_CHALLENGE",ChallengeResponses:d,Session:n,ClientMetadata:t,ClientId:a,UserContextData:kt({username:o,userPoolId:s,userPoolClientId:a})},p=Tt({endpointResolver:Ot({endpointOverride:c})}),h=await p({region:k(s),userAgentValue:Qe(I.ConfirmSignIn)},l);return"DEVICE_SRP_AUTH"===h.ChallengeName?lo({username:o,config:i,clientMetadata:t,session:h.Session,tokenOrchestrator:r}):h}async function co(e,t,n,o,i){const{userPoolClientId:r,userPoolId:s,userPoolEndpoint:a}=o,c={USERNAME:e,PASSWORD:t},d=await i.getDeviceMetadata(e);d&&d.deviceKey&&(c.DEVICE_KEY=d.deviceKey);const u={AuthFlow:"USER_PASSWORD_AUTH",AuthParameters:c,ClientMetadata:n,ClientId:r,UserContextData:kt({username:e,userPoolId:s,userPoolClientId:r})},l=Rt({endpointResolver:Ot({endpointOverride:a})}),p=await l({region:k(s),userAgentValue:Qe(I.SignIn)},u),h=p.ChallengeParameters?.USERNAME??p.ChallengeParameters?.USER_ID_FOR_SRP??e;return vo(h),"DEVICE_SRP_AUTH"===p.ChallengeName?lo({username:h,config:o,clientMetadata:n,session:p.Session,tokenOrchestrator:i}):p}async function uo(e,t,n,o){const{userPoolClientId:i,userPoolId:r,userPoolEndpoint:s}=n,a={USERNAME:e},c=await o.getDeviceMetadata(e);c&&c.deviceKey&&(a.DEVICE_KEY=c.deviceKey);const d={AuthFlow:"CUSTOM_AUTH",AuthParameters:a,ClientMetadata:t,ClientId:i,UserContextData:kt({username:e,userPoolId:r,userPoolClientId:i})},u=Rt({endpointResolver:Ot({endpointOverride:s})}),l=await u({region:k(r),userAgentValue:Qe(I.SignIn)},d),p=l.ChallengeParameters?.USERNAME??e;return vo(p),"DEVICE_SRP_AUTH"===l.ChallengeName?lo({username:p,config:n,clientMetadata:t,session:l.Session,tokenOrchestrator:o}):l}async function lo({username:e,config:t,clientMetadata:n,session:o,tokenOrchestrator:i}){const{userPoolId:r,userPoolEndpoint:s}=t,a=t.userPoolClientId,c=await(i?.getDeviceMetadata(e));De(c);const d=await Qn(c.deviceGroupKey),u={ChallengeName:"DEVICE_SRP_AUTH",ClientId:a,ChallengeResponses:{USERNAME:e,SRP_A:d.A.toString(16),DEVICE_KEY:c.deviceKey},ClientMetadata:n,Session:o},l=Tt({endpointResolver:Ot({endpointOverride:s})}),{ChallengeParameters:p,Session:h}=await l({region:k(r)},u);return async function(e,t,n,o,i,{userPoolId:r,userPoolClientId:s,userPoolEndpoint:a},c){const d=await(c?.getDeviceMetadata(e));De(d);const u=new In(t?.SRP_B,16),l=new In(t?.SALT,16),{deviceKey:p}=d,{deviceGroupKey:h}=d,g=await i.getPasswordAuthenticationKey({username:d.deviceKey,password:d.randomPassword,serverBValue:u,salt:l}),E=oo(),m={ChallengeName:"DEVICE_PASSWORD_VERIFIER",ClientId:s,ChallengeResponses:{USERNAME:t?.USERNAME??e,PASSWORD_CLAIM_SECRET_BLOCK:t?.SECRET_BLOCK,TIMESTAMP:E,PASSWORD_CLAIM_SIGNATURE:io({username:p,userPoolName:h,challengeParameters:t,dateNow:E,hkdf:g}),DEVICE_KEY:p},Session:o,ClientMetadata:n,UserContextData:kt({username:e,userPoolId:r,userPoolClientId:s})};return Tt({endpointResolver:Ot({endpointOverride:a})})({region:k(r)},m)}(e,p,n,h,d,t,i)}async function po(e,t,n,o,i,r,s){const{userPoolId:a,userPoolClientId:c,userPoolEndpoint:d}=r,u=a?.split("_")[1]||"",l=new In(t?.SRP_B,16),p=new In(t?.SALT,16),h=t?.USER_ID_FOR_SRP;if(!h)throw new _({name:"EmptyUserIdForSRPException",message:"USER_ID_FOR_SRP was not found in challengeParameters"});const g=await i.getPasswordAuthenticationKey({username:h,password:e,serverBValue:l,salt:p}),E=oo(),m={USERNAME:h,PASSWORD_CLAIM_SECRET_BLOCK:t?.SECRET_BLOCK,TIMESTAMP:E,PASSWORD_CLAIM_SIGNATURE:io({username:h,userPoolName:u,challengeParameters:t,dateNow:E,hkdf:g})},f=await s.getDeviceMetadata(h);f&&f.deviceKey&&(m.DEVICE_KEY=f.deviceKey);const y={ChallengeName:"PASSWORD_VERIFIER",ChallengeResponses:m,ClientMetadata:n,Session:o,ClientId:c,UserContextData:kt({username:h,userPoolId:a,userPoolClientId:c})},S=Tt({endpointResolver:Ot({endpointOverride:d})}),A=await S({region:k(a)},y);return"DEVICE_SRP_AUTH"===A.ChallengeName?lo({username:h,config:r,clientMetadata:n,session:A.Session,tokenOrchestrator:s}):A}async function ho(e){const{challengeName:t,challengeParameters:n,availableChallenges:o}=e,i=r.Amplify.getConfig().Auth?.Cognito;switch(h(i),t){case"CUSTOM_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_CUSTOM_CHALLENGE",additionalInfo:n}};case"MFA_SETUP":{const{signInSession:e,username:t}=rn.getState(),o=Ao(Io(n.MFAS_CAN_SETUP))||[],r=o.filter((e=>"EMAIL"===e||"TOTP"===e)),s=r.includes("TOTP"),a=r.includes("EMAIL");if(s&&a)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SETUP_SELECTION",allowedMFATypes:r}};if(a)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_EMAIL_SETUP"}};if(s){const n=Ut({endpointResolver:Ot({endpointOverride:i.userPoolEndpoint})}),{Session:o,SecretCode:r}=await n({region:k(i.userPoolId)},{Session:e});return rn.dispatch({type:"SET_SIGN_IN_SESSION",value:o}),{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_TOTP_SETUP",totpSetupDetails:go(r,t)}}}throw new _({name:M.SignInException,message:`Cannot initiate MFA setup from available types: ${o}`})}case"NEW_PASSWORD_REQUIRED":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_NEW_PASSWORD_REQUIRED",missingAttributes:mo(n.requiredAttributes)}};case"SELECT_MFA_TYPE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SELECTION",allowedMFATypes:Ao(Io(n.MFAS_CAN_CHOOSE))}};case"SMS_OTP":case"SMS_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_SMS_CODE",codeDeliveryDetails:{deliveryMedium:n.CODE_DELIVERY_DELIVERY_MEDIUM,destination:n.CODE_DELIVERY_DESTINATION}}};case"SOFTWARE_TOKEN_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_TOTP_CODE"}};case"EMAIL_OTP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_EMAIL_CODE",codeDeliveryDetails:{deliveryMedium:n.CODE_DELIVERY_DELIVERY_MEDIUM,destination:n.CODE_DELIVERY_DESTINATION}}};case"WEB_AUTHN":return async function(e){const t=r.Amplify.getConfig().Auth?.Cognito;h(t);const{username:n,signInSession:o,signInDetails:i,challengeName:s}=rn.getState();if("WEB_AUTHN"!==s||!n)throw new _({name:M.SignInException,message:"Unable to proceed due to invalid sign in state."});const{CREDENTIAL_REQUEST_OPTIONS:a}=e;gn(!!a,dn.InvalidPasskeyAuthenticationOptions);const c=await Sn(JSON.parse(a)),d=Tt({endpointResolver:Ot({endpointOverride:t.userPoolEndpoint})}),{ChallengeName:u,ChallengeParameters:l,AuthenticationResult:p,Session:g}=await d({region:k(t.userPoolId),userAgentValue:Qe(I.ConfirmSignIn)},{ChallengeName:"WEB_AUTHN",ChallengeResponses:{USERNAME:n,CREDENTIAL:JSON.stringify(c)},ClientId:t.userPoolClientId,Session:o});if(sn({signInSession:g,username:n,challengeName:u,signInDetails:i}),p)return await nn({...p,username:n,NewDeviceMetadata:await xo({userPoolId:t.userPoolId,userPoolEndpoint:t.userPoolEndpoint,newDeviceMetadata:p.NewDeviceMetadata,accessToken:p.AccessToken}),signInDetails:i}),an(),await on(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}};if("WEB_AUTHN"===u)throw new _({name:M.SignInException,message:"Sequential WEB_AUTHN challenges returned from underlying service cannot be handled."});return ho({challengeName:u,challengeParameters:l})}(n);case"PASSWORD":case"PASSWORD_SRP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_PASSWORD"}};case"SELECT_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_FIRST_FACTOR_SELECTION",availableChallenges:o}}}throw new _({name:M.SignInException,message:`An error occurred during the sign in process. ${t} challengeName returned by the underlying service was not addressed.`})}function go(e,t){return{sharedSecret:e,getSetupUri:(n,o)=>new $(`otpauth://totp/${n}:${o??t}?secret=${e}&issuer=${n}`)}}function Eo(e){return e===de.PasswordResetRequiredException?{isSignedIn:!1,nextStep:{signInStep:"RESET_PASSWORD"}}:e===de.UserNotConfirmedException?{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_UP"}}:void 0}function mo(e){return e?JSON.parse(e).map((e=>e.includes(so)?e.replace(so,""):e)):[]}function fo(e){if(!e)return{};const t={};return Object.entries(e).forEach((([e,n])=>{n&&(t[`${so}${e}`]=n)})),t}function yo(e){let t="SMS_MFA";return"TOTP"===e&&(t="SOFTWARE_TOKEN_MFA"),"EMAIL"===e&&(t="EMAIL_OTP"),t}function So(e){return"SMS_MFA"===e?"SMS":"SOFTWARE_TOKEN_MFA"===e?"TOTP":"EMAIL_OTP"===e?"EMAIL":void 0}function Ao(e){if(e)return e.map(So).filter(Boolean)}function Io(e){return e?JSON.parse(e):[]}async function wo(){let e;try{e=await Oe()}catch(e){}if(e&&e.userId&&e.username)throw new _({name:Ie,message:"There is already a signed in user.",recoverySuggestion:"Call signOut before calling signIn again."})}async function xo({userPoolId:e,userPoolEndpoint:t,newDeviceMetadata:n,accessToken:o}){if(!n)return;const i=e.split("_")[1]||"",r=await Qn(i),s=n?.DeviceKey,a=n?.DeviceGroupKey;try{await r.generateHashDevice(a??"",s??"")}catch(e){return}const c={Salt:z.convert(On(r.getSaltToHashDevices())),PasswordVerifier:z.convert(On(r.getVerifierDevices()))},d=r.getRandomPassword();try{const i=bt({endpointResolver:Ot({endpointOverride:t})});return await i({region:k(e)},{AccessToken:o,DeviceName:await j(),DeviceKey:n?.DeviceKey,DeviceSecretVerifierConfig:c}),{deviceKey:s,deviceGroupKey:a,randomPassword:d}}catch(e){return}}async function Co(e,t,n,o){try{return await e(...t)}catch(i){if(i instanceof _&&"ResourceNotFoundException"===i.name&&i.message.includes("Device does not exist."))return await o.clearDeviceMetadata(n),e(...t);throw i}}function vo(e){const{dispatch:t}=rn;t({type:"SET_USERNAME",value:e})}function Po(e){return rn.getState().username??e}const Ro=(e=>{let t=e({active:!1},{type:"RESET"});return{getState:()=>t,dispatch:n=>{t=e(t,n)}}})(((e,t)=>{switch(t.type){case"SET_USERNAME":return{...e,username:t.value};case"SET_SESSION":return{...e,session:t.value};case"START":return{...e,active:!0};case"RESET":return{active:!1};default:return e}})),To=async()=>{throw new _({name:xe,message:"The autoSignIn flow has not started, or has been cancelled/completed.",recoverySuggestion:"Please try to use the signIn API or log out before starting a new autoSignIn flow."})};let No=To;function Uo(e){No=e}function bo(e=!0){e&&(No=To),Ro.dispatch({type:"RESET"})}async function Do(e){const{username:t,password:n,options:o}=e,i=r.Amplify.getConfig().Auth?.Cognito,s={loginId:t,authFlowType:"USER_AUTH"};h(i);const a=o?.clientMetadata,c=o?.preferredChallenge;O(!!t,U.EmptySignInUsername);try{const e={username:t,config:i,tokenOrchestrator:tn,clientMetadata:a,preferredChallenge:c,password:n},o=Ro.getState();o.active&&o.username===t&&(e.session=o.session);const r=await async function({username:e,clientMetadata:t,config:n,tokenOrchestrator:o,preferredChallenge:i,password:r,session:s}){const{userPoolId:a,userPoolClientId:c,userPoolEndpoint:d}=n,u=kt({username:e,userPoolId:a,userPoolClientId:c}),l={USERNAME:e};if(i){if("PASSWORD_SRP"===i)return O(!!r,U.EmptySignInPassword),eo({username:e,password:r,clientMetadata:t,config:n,tokenOrchestrator:o,authFlow:"USER_AUTH",preferredChallenge:i});"PASSWORD"===i&&(O(!!r,U.EmptySignInPassword),l.PASSWORD=r),l.PREFERRED_CHALLENGE=i}const p={AuthFlow:"USER_AUTH",AuthParameters:l,ClientMetadata:t,ClientId:c,UserContextData:u};s&&(p.Session=s);const h=Rt({endpointResolver:Ot({endpointOverride:d})}),g=await h({region:k(a),userAgentValue:Qe(I.SignIn)},p);return vo(e),g}(e),d=Po(t);return sn({signInSession:r.Session,username:d,challengeName:r.ChallengeName,signInDetails:s}),r.AuthenticationResult?(an(),await nn({username:d,...r.AuthenticationResult,NewDeviceMetadata:await xo({userPoolId:i.userPoolId,userPoolEndpoint:i.userPoolEndpoint,newDeviceMetadata:r.AuthenticationResult.NewDeviceMetadata,accessToken:r.AuthenticationResult.AccessToken}),signInDetails:s}),await on(),bo(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):ho({challengeName:r.ChallengeName,challengeParameters:r.ChallengeParameters,availableChallenges:"AvailableChallenges"in r?r.AvailableChallenges:void 0})}catch(e){an(),bo(),ct(e);const t=Eo(e.name);if(t)return t;throw e}}async function Mo(e){bo(!1);const t=e.options?.authFlowType;switch(await wo(),t){case"USER_SRP_AUTH":default:return async function(e){const{username:t,password:n}=e,o=r.Amplify.getConfig().Auth?.Cognito,i={loginId:t,authFlowType:"USER_SRP_AUTH"};h(o);const s=e.options?.clientMetadata;O(!!t,U.EmptySignInUsername),O(!!n,U.EmptySignInPassword);try{const{ChallengeName:e,ChallengeParameters:r,AuthenticationResult:a,Session:c}=await async function(e,t,n,o,i){return eo({username:e,password:t,clientMetadata:n,config:o,tokenOrchestrator:i,authFlow:"USER_SRP_AUTH"})}(t,n,s,o,tn),d=Po(t);return sn({signInSession:c,username:d,challengeName:e,signInDetails:i}),a?(an(),await nn({username:d,...a,NewDeviceMetadata:await xo({userPoolId:o.userPoolId,userPoolEndpoint:o.userPoolEndpoint,newDeviceMetadata:a.NewDeviceMetadata,accessToken:a.AccessToken}),signInDetails:i}),await on(),bo(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):ho({challengeName:e,challengeParameters:r})}catch(e){an(),bo(),ct(e);const t=Eo(e.name);if(t)return t;throw e}}(e);case"USER_PASSWORD_AUTH":return async function(e){const{username:t,password:n,options:o}=e,i=r.Amplify.getConfig().Auth?.Cognito,s={loginId:t,authFlowType:"USER_PASSWORD_AUTH"};h(i);const a=o?.clientMetadata;O(!!t,U.EmptySignInUsername),O(!!n,U.EmptySignInPassword);try{const{ChallengeName:e,ChallengeParameters:o,AuthenticationResult:r,Session:c}=await Co(co,[t,n,a,i,tn],t,tn),d=Po(t);return sn({signInSession:c,username:d,challengeName:e,signInDetails:s}),r?(an(),await nn({...r,username:d,NewDeviceMetadata:await xo({userPoolId:i.userPoolId,userPoolEndpoint:i.userPoolEndpoint,newDeviceMetadata:r.NewDeviceMetadata,accessToken:r.AccessToken}),signInDetails:s}),await on(),bo(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):ho({challengeName:e,challengeParameters:o})}catch(e){an(),bo(),ct(e);const t=Eo(e.name);if(t)return t;throw e}}(e);case"CUSTOM_WITHOUT_SRP":return async function(e){const t=r.Amplify.getConfig().Auth?.Cognito;h(t);const{username:n,password:o,options:i}=e,s={loginId:n,authFlowType:"CUSTOM_WITHOUT_SRP"},a=i?.clientMetadata;O(!!n,U.EmptySignInUsername),O(!o,U.CustomAuthSignInPassword);try{const{ChallengeName:e,ChallengeParameters:o,AuthenticationResult:i,Session:r}=await Co(uo,[n,a,t,tn],n,tn),c=Po(n);return sn({signInSession:r,username:c,challengeName:e,signInDetails:s}),i?(an(),await nn({username:c,...i,NewDeviceMetadata:await xo({userPoolId:t.userPoolId,userPoolEndpoint:t.userPoolEndpoint,newDeviceMetadata:i.NewDeviceMetadata,accessToken:i.AccessToken}),signInDetails:s}),await on(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):ho({challengeName:e,challengeParameters:o})}catch(e){an(),ct(e);const t=Eo(e.name);if(t)return t;throw e}}(e);case"CUSTOM_WITH_SRP":return async function(e){const{username:t,password:n,options:o}=e,i={loginId:t,authFlowType:"CUSTOM_WITH_SRP"},s=r.Amplify.getConfig().Auth?.Cognito;h(s);const a=o?.clientMetadata;O(!!t,U.EmptySignInUsername),O(!!n,U.EmptySignInPassword);try{const{ChallengeName:e,ChallengeParameters:o,AuthenticationResult:r,Session:c}=await async function(e,t,n,o,i){h(o);const{userPoolId:r,userPoolClientId:s,userPoolEndpoint:a}=o,c=r?.split("_")[1]||"",d=await Qn(c),u={AuthFlow:"CUSTOM_AUTH",AuthParameters:{USERNAME:e,SRP_A:d.A.toString(16),CHALLENGE_NAME:"SRP_A"},ClientMetadata:n,ClientId:s,UserContextData:kt({username:e,userPoolId:r,userPoolClientId:s})},l=Rt({endpointResolver:Ot({endpointOverride:a})}),{ChallengeParameters:p,Session:g}=await l({region:k(r),userAgentValue:Qe(I.SignIn)},u),E=p?.USERNAME??e;return vo(E),Co(po,[t,p,n,g,d,o,i],E,i)}(t,n,a,s,tn),d=Po(t);return sn({signInSession:c,username:d,challengeName:e,signInDetails:i}),r?(await nn({username:d,...r,NewDeviceMetadata:await xo({userPoolId:s.userPoolId,userPoolEndpoint:s.userPoolEndpoint,newDeviceMetadata:r.NewDeviceMetadata,accessToken:r.AccessToken}),signInDetails:i}),an(),await on(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):ho({challengeName:e,challengeParameters:o})}catch(e){an(),ct(e);const t=Eo(e.name);if(t)return t;throw e}}(e);case"USER_AUTH":return Do(e)}}const _o=18e4;function Oo(e,t){let n;return o=>{n||e(...o),clearTimeout(n),n=setTimeout((()=>{n=void 0}),t)}}const ko=Oo((function(e,t,n){const o=Date.now(),i=setInterval((async()=>{if(Date.now()-o>_o)clearInterval(i),n(new _({name:xe,message:"The account was not confirmed on time.",recoverySuggestion:"Try to verify your account by clicking the link sent your email or phone and then login manually."})),bo();else try{const n=await Mo(e);"CONFIRM_SIGN_UP"!==n.nextStep.signInStep&&(t(n),clearInterval(i),bo())}catch(e){clearInterval(i),n(e),bo()}}),5e3)}),300),Fo=Oo((async function(e,t,n){try{t("USER_AUTH"===e?.options?.authFlowType?await Do(e):await Mo(e)),bo()}catch(e){n(e),bo()}}),300);function Lo(e){return async()=>new Promise(((t,n)=>{Fo([e,t,n])}))}const Vo=Lo,Ko=e=>Xe(mt,et("SignUp"),(async e=>{if(e.statusCode>=300){const t=await rt(e);if(ct(t),t.name===he.InvalidParameterException&&/'password'/.test(t.message)&&/Member must not be null/.test(t.message)){const e=U.EmptySignUpPassword,{message:t,recoverySuggestion:n}=b[e];throw new _({name:e,message:t,recoverySuggestion:n})}throw new _({name:t.name,message:t.message})}return st(e)}),{...vt,...e});async function Wo(e){const{username:t,password:n,options:o}=e,i=r.Amplify.getConfig().Auth?.Cognito,s=i?.signUpVerificationMethod??"code",{clientMetadata:a,validationData:c,autoSignIn:d}=e.options??{};h(i),O(!!t,U.EmptySignUpUsername);const u="boolean"!=typeof d?d:void 0,l={username:t,options:u};"CUSTOM_WITHOUT_SRP"!==u?.authFlowType&&(l.password=n);const{userPoolId:p,userPoolClientId:g,userPoolEndpoint:E}=i,m=Ko({endpointResolver:Ot({endpointOverride:E})}),f={Username:t,Password:void 0,UserAttributes:o?.userAttributes&&F(o?.userAttributes),ClientMetadata:a,ValidationData:c&&F(c),ClientId:g,UserContextData:kt({username:t,userPoolId:p,userPoolClientId:g})};n&&(f.Password=n);const{UserSub:y,CodeDeliveryDetails:S,UserConfirmed:A,Session:w}=await m({region:k(p),userAgentValue:Qe(I.SignUp)},f);(u||!0===d)&&(Ro.dispatch({type:"START"}),Ro.dispatch({type:"SET_USERNAME",value:t}),Ro.dispatch({type:"SET_SESSION",value:w}));const x={destination:S?.Destination,deliveryMedium:S?.DeliveryMedium,attributeName:S?.AttributeName},C=!!A,v=Ro.getState().active;if(C)return v?(Uo(Vo(l)),{isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"},userId:y}):{isSignUpComplete:!0,nextStep:{signUpStep:"DONE"},userId:y};if(v){if("link"===s)return Uo(function(e){return async()=>new Promise(((t,n)=>{ko([e,t,n])}))}(l)),{isSignUpComplete:!1,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN",codeDeliveryDetails:x},userId:y};!function(e){const t=G.listen("auth-internal",(async({payload:n})=>{if("confirmSignUp"===n.event){const o=n.data;o?.isSignUpComplete&&(G.dispatch("auth-internal",{event:"autoSignIn"}),Uo(Lo(e)),t())}})),n=setTimeout((()=>{t(),clearTimeout(n),bo()}),_o)}(l)}return{isSignUpComplete:!1,nextStep:{signUpStep:"CONFIRM_SIGN_UP",codeDeliveryDetails:x},userId:y}}const Bo=e=>Xe(mt,et("ForgotPassword"),dt(),{...vt,...e});async function qo(e){const{username:t}=e;O(!!t,U.EmptyResetPasswordUsername);const n=r.Amplify.getConfig().Auth?.Cognito;h(n);const{userPoolClientId:o,userPoolId:i,userPoolEndpoint:s}=n,a=e.options?.clientMetadata,c=kt({username:t,userPoolId:i,userPoolClientId:o}),d=Bo({endpointResolver:Ot({endpointOverride:s})}),u=(await d({region:k(i),userAgentValue:Qe(I.ResetPassword)},{Username:t,ClientMetadata:a,ClientId:o,UserContextData:c})).CodeDeliveryDetails;return{isPasswordReset:!1,nextStep:{resetPasswordStep:"CONFIRM_RESET_PASSWORD_WITH_CODE",codeDeliveryDetails:{deliveryMedium:u?.DeliveryMedium,destination:u?.Destination,attributeName:u?.AttributeName}}}}const Ho=e=>Xe(mt,et("ConfirmForgotPassword"),dt(),{...vt,...e});async function Go(e){const t=r.Amplify.getConfig().Auth?.Cognito;h(t);const{userPoolClientId:n,userPoolId:o,userPoolEndpoint:i}=t,{username:s,newPassword:a}=e;O(!!s,U.EmptyConfirmResetPasswordUsername),O(!!a,U.EmptyConfirmResetPasswordNewPassword);const c=e.confirmationCode;O(!!c,U.EmptyConfirmResetPasswordConfirmationCode);const d=e.options?.clientMetadata,u=kt({username:s,userPoolId:o,userPoolClientId:n}),l=Ho({endpointResolver:Ot({endpointOverride:i})});await l({region:k(t.userPoolId),userAgentValue:Qe(I.ConfirmResetPassword)},{Username:s,ConfirmationCode:c,Password:a,ClientMetadata:d,ClientId:t.userPoolClientId,UserContextData:u})}const $o=e=>Xe(mt,et("ResendConfirmationCode"),dt(),{...vt,...e});async function zo(e){const{username:t}=e;O(!!t,U.EmptySignUpUsername);const n=r.Amplify.getConfig().Auth?.Cognito;h(n);const{userPoolClientId:o,userPoolId:i,userPoolEndpoint:s}=n,a=e.options?.clientMetadata,c=kt({username:t,userPoolId:i,userPoolClientId:o}),d=$o({endpointResolver:Ot({endpointOverride:s})}),{CodeDeliveryDetails:u}=await d({region:k(n.userPoolId),userAgentValue:Qe(I.ResendSignUpCode)},{Username:t,ClientMetadata:a,ClientId:n.userPoolClientId,UserContextData:c}),{DeliveryMedium:l,AttributeName:p,Destination:g}={...u};return{destination:g,deliveryMedium:l,attributeName:p||void 0}}const jo=e=>Xe(mt,et("ConfirmSignUp"),dt(),{...vt,...e});async function Jo(e){const{username:t,confirmationCode:n,options:o}=e,i=r.Amplify.getConfig().Auth?.Cognito;h(i);const{userPoolId:s,userPoolClientId:a,userPoolEndpoint:c}=i,d=o?.clientMetadata;O(!!t,U.EmptyConfirmSignUpUsername),O(!!n,U.EmptyConfirmSignUpCode);const u=kt({username:t,userPoolId:s,userPoolClientId:a}),l=jo({endpointResolver:Ot({endpointOverride:c})}),{Session:p}=await l({region:k(i.userPoolId),userAgentValue:Qe(I.ConfirmSignUp)},{Username:t,ConfirmationCode:n,ClientMetadata:d,ForceAliasCreation:o?.forceAliasCreation,ClientId:i.userPoolClientId,UserContextData:u});return new Promise(((e,n)=>{try{const n={isSignUpComplete:!0,nextStep:{signUpStep:"DONE"}},o=Ro.getState();if(!o.active||o.username!==t)return e(n),void bo();Ro.dispatch({type:"SET_SESSION",value:p});const i=G.listen("auth-internal",(({payload:t})=>{"autoSignIn"===t.event&&(e({isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"}}),i())}));G.dispatch("auth-internal",{event:"confirmSignUp",data:n})}catch(e){n(e)}}))}async function Yo(e){const{challengeResponse:t,options:n}=e,{username:o,challengeName:i,signInSession:s,signInDetails:a}=rn.getState(),c=r.Amplify.getConfig().Auth?.Cognito;h(c);const d=n?.clientMetadata;if(O(!!t,U.EmptyChallengeResponse),!o||!i||!s)throw new _({name:M.SignInException,message:"\n\t\t\tAn error occurred during the sign in process.\n\n\t\t\tThis most likely occurred due to:\n\t\t\t1. signIn was not called before confirmSignIn.\n\t\t\t2. signIn threw an exception.\n\t\t\t3. page was refreshed during the sign in flow.\n\t\t\t",recoverySuggestion:"Make sure a successful call to signIn is made before calling confirmSignInand that the page is not refreshed until the sign in process is done."});try{const{Session:e,ChallengeName:r,AuthenticationResult:u,ChallengeParameters:l}=await async function(e,t,n,o,i,r,s,a){const c=a?.userAttributes,d=a?.friendlyDeviceName;switch(t){case"WEB_AUTHN":case"SELECT_CHALLENGE":return"PASSWORD_SRP"===o||"PASSWORD"===o?{ChallengeName:o,Session:n,$metadata:{}}:async function({username:e,session:t,selectedChallenge:n,config:o,clientMetadata:i}){return Tt({endpointResolver:Ot({endpointOverride:o.userPoolEndpoint})})({region:k(o.userPoolId),userAgentValue:Qe(I.ConfirmSignIn)},{ChallengeName:"SELECT_CHALLENGE",ChallengeResponses:{USERNAME:e,ANSWER:n},ClientId:o.userPoolClientId,Session:t,ClientMetadata:i})}({username:e,session:n,selectedChallenge:o,config:i,clientMetadata:s});case"SELECT_MFA_TYPE":return async function({challengeResponse:e,username:t,clientMetadata:n,session:o,config:i}){const{userPoolId:r,userPoolClientId:s,userPoolEndpoint:a}=i;O("TOTP"===e||"SMS"===e||"EMAIL"===e,U.IncorrectMFAMethod);const c={ChallengeName:"SELECT_MFA_TYPE",ChallengeResponses:{USERNAME:t,ANSWER:yo(e)},Session:o,ClientMetadata:n,ClientId:s,UserContextData:kt({username:t,userPoolId:r,userPoolClientId:s})};return Tt({endpointResolver:Ot({endpointOverride:a})})({region:k(r),userAgentValue:Qe(I.ConfirmSignIn)},c)}({challengeResponse:o,clientMetadata:s,session:n,username:e,config:i});case"MFA_SETUP":return async function({challengeResponse:e,username:t,clientMetadata:n,session:o,deviceName:i,config:r}){const{userPoolId:s,userPoolClientId:a,userPoolEndpoint:c}=r;if("EMAIL"===e)return{ChallengeName:"MFA_SETUP",Session:o,ChallengeParameters:{MFAS_CAN_SETUP:'["EMAIL_OTP"]'},$metadata:{}};if("TOTP"===e)return{ChallengeName:"MFA_SETUP",Session:o,ChallengeParameters:{MFAS_CAN_SETUP:'["SOFTWARE_TOKEN_MFA"]'},$metadata:{}};const d={USERNAME:t};if(/^\d+$/.test(e)){const t=Nt({endpointResolver:Ot({endpointOverride:c})}),{Session:r}=await t({region:k(s),userAgentValue:Qe(I.ConfirmSignIn)},{UserCode:e,Session:o,FriendlyDeviceName:i});rn.dispatch({type:"SET_SIGN_IN_SESSION",value:r});const u={ChallengeName:"MFA_SETUP",ChallengeResponses:d,Session:r,ClientMetadata:n,ClientId:a};return Tt({endpointResolver:Ot({endpointOverride:c})})({region:k(s),userAgentValue:Qe(I.ConfirmSignIn)},u)}if(e.includes("@")){d.EMAIL=e;const t={ChallengeName:"MFA_SETUP",ChallengeResponses:d,Session:o,ClientMetadata:n,ClientId:a};return Tt({endpointResolver:Ot({endpointOverride:c})})({region:k(s),userAgentValue:Qe(I.ConfirmSignIn)},t)}throw new _({name:M.SignInException,message:`Cannot proceed with MFA setup using challengeResponse: ${e}`,recoverySuggestion:'Try passing "EMAIL", "TOTP", a valid email, or OTP code as the challengeResponse.'})}({challengeResponse:o,clientMetadata:s,session:n,username:e,deviceName:d,config:i});case"NEW_PASSWORD_REQUIRED":return async function({challengeResponse:e,clientMetadata:t,session:n,username:o,requiredAttributes:i,config:r}){const{userPoolId:s,userPoolClientId:a,userPoolEndpoint:c}=r,d={ChallengeName:"NEW_PASSWORD_REQUIRED",ChallengeResponses:{...fo(i),NEW_PASSWORD:e,USERNAME:o},ClientMetadata:t,Session:n,ClientId:a,UserContextData:kt({username:o,userPoolId:s,userPoolClientId:a})};return Tt({endpointResolver:Ot({endpointOverride:c})})({region:k(s),userAgentValue:Qe(I.ConfirmSignIn)},d)}({challengeResponse:o,clientMetadata:s,session:n,username:e,requiredAttributes:c,config:i});case"CUSTOM_CHALLENGE":return Co(ao,[{challengeResponse:o,clientMetadata:s,session:n,username:e,config:i,tokenOrchestrator:r}],e,r);case"SMS_MFA":case"SOFTWARE_TOKEN_MFA":case"SMS_OTP":case"EMAIL_OTP":return async function({challengeName:e,challengeResponse:t,clientMetadata:n,session:o,username:i,config:r}){const{userPoolId:s,userPoolClientId:a,userPoolEndpoint:c}=r,d={USERNAME:i};"EMAIL_OTP"===e&&(d.EMAIL_OTP_CODE=t),"SMS_MFA"===e&&(d.SMS_MFA_CODE=t),"SMS_OTP"===e&&(d.SMS_OTP_CODE=t),"SOFTWARE_TOKEN_MFA"===e&&(d.SOFTWARE_TOKEN_MFA_CODE=t);const u={ChallengeName:e,ChallengeResponses:d,Session:o,ClientMetadata:n,ClientId:a,UserContextData:kt({username:i,userPoolId:s,userPoolClientId:a})};return Tt({endpointResolver:Ot({endpointOverride:c})})({region:k(s),userAgentValue:Qe(I.ConfirmSignIn)},u)}({challengeName:t,challengeResponse:o,clientMetadata:s,session:n,username:e,config:i});case"PASSWORD":return async function(e,t,n,o,i){const{userPoolId:r,userPoolClientId:s,userPoolEndpoint:a}=o,c={ANSWER:"PASSWORD",USERNAME:e,PASSWORD:t},d=kt({username:e,userPoolId:r,userPoolClientId:s}),u=Tt({endpointResolver:Ot({endpointOverride:a})}),l=await u({region:k(r),userAgentValue:Qe(I.ConfirmSignIn)},{ChallengeName:"SELECT_CHALLENGE",ChallengeResponses:c,ClientId:s,ClientMetadata:n,Session:i,UserContextData:d});return vo(l.ChallengeParameters?.USERNAME??e),l}(e,o,s,i,n);case"PASSWORD_SRP":return async function(e,t,n,o,i,r){const{userPoolId:s,userPoolClientId:a,userPoolEndpoint:c}=o,d=s.split("_")[1]||"",u=await Qn(d),l={ANSWER:"PASSWORD_SRP",USERNAME:e,SRP_A:u.A.toString(16)},p=kt({username:e,userPoolId:s,userPoolClientId:a}),h=Tt({endpointResolver:Ot({endpointOverride:c})}),g=await h({region:k(s),userAgentValue:Qe(I.ConfirmSignIn)},{ChallengeName:"SELECT_CHALLENGE",ChallengeResponses:l,ClientId:a,ClientMetadata:n,Session:i,UserContextData:p}),E=g.ChallengeParameters?.USERNAME??e;return vo(E),"PASSWORD_VERIFIER"===g.ChallengeName?Co(po,[t,g.ChallengeParameters,n,g.Session,u,o,r],E,r):g}(e,o,s,i,n,r)}throw new _({name:M.SignInException,message:`An error occurred during the sign in process.\n\t\t${t} challengeName returned by the underlying service was not addressed.`})}(o,i,s,t,c,tn,d,n);return sn({signInSession:e,username:o,challengeName:r,signInDetails:a}),u?(an(),await nn({username:o,...u,NewDeviceMetadata:await xo({userPoolId:c.userPoolId,userPoolEndpoint:c.userPoolEndpoint,newDeviceMetadata:u.NewDeviceMetadata,accessToken:u.AccessToken}),signInDetails:a}),await on(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}}):ho({challengeName:r,challengeParameters:l})}catch(e){ct(e);const t=Eo(e.name);if(t)return t;throw e}}const Zo=e=>Xe(mt,et("SetUserMFAPreference"),dt(),{...vt,...e});async function Qo(e){const{sms:t,totp:n,email:o}=e,i=r.Amplify.getConfig().Auth?.Cognito;h(i);const{userPoolEndpoint:s,userPoolId:a}=i,{tokens:c}=await(0,r.fetchAuthSession)({forceRefresh:!1});Te(c);const d=Zo({endpointResolver:Ot({endpointOverride:s})});await d({region:k(a),userAgentValue:Qe(I.UpdateMFAPreference)},{AccessToken:c.accessToken.toString(),SMSMfaSettings:Xo(t),SoftwareTokenMfaSettings:Xo(n),EmailMfaSettings:Xo(o)})}function Xo(e){return"DISABLED"===e?{Enabled:!1}:"PREFERRED"===e?{Enabled:!0,PreferredMfa:!0}:"ENABLED"===e?{Enabled:!0}:"NOT_PREFERRED"===e?{Enabled:!0,PreferredMfa:!1}:void 0}const ei=e=>Xe(mt,et("GetUser"),dt(),{...vt,...e});async function ti(){const e=r.Amplify.getConfig().Auth?.Cognito;h(e);const{userPoolEndpoint:t,userPoolId:n}=e,{tokens:o}=await(0,r.fetchAuthSession)({forceRefresh:!1});Te(o);const i=ei({endpointResolver:Ot({endpointOverride:t})}),{PreferredMfaSetting:s,UserMFASettingList:a}=await i({region:k(n),userAgentValue:Qe(I.FetchMFAPreference)},{AccessToken:o.accessToken.toString()});return{preferred:So(s),enabled:Ao(a)}}async function ni(e){const t=r.Amplify.getConfig().Auth?.Cognito;h(t);const{userPoolEndpoint:n,userPoolId:o}=t,{code:i,options:s}=e;O(!!i,U.EmptyVerifyTOTPSetupCode);const{tokens:a}=await(0,r.fetchAuthSession)({forceRefresh:!1});Te(a);const c=Nt({endpointResolver:Ot({endpointOverride:n})});await c({region:k(o),userAgentValue:Qe(I.VerifyTOTPSetup)},{AccessToken:a.accessToken.toString(),UserCode:i,FriendlyDeviceName:s?.friendlyDeviceName})}const oi=e=>Xe(mt,et("ChangePassword"),dt(),{...vt,...e});async function ii(e){const t=r.Amplify.getConfig().Auth?.Cognito;h(t);const{userPoolEndpoint:n,userPoolId:o}=t,{oldPassword:i,newPassword:s}=e;O(!!i,U.EmptyUpdatePassword),O(!!s,U.EmptyUpdatePassword);const{tokens:a}=await(0,r.fetchAuthSession)({forceRefresh:!1});Te(a);const c=oi({endpointResolver:Ot({endpointOverride:n})});await c({region:k(o),userAgentValue:Qe(I.UpdatePassword)},{AccessToken:a.accessToken.toString(),PreviousPassword:i,ProposedPassword:s})}async function ri(){const e=r.Amplify.getConfig().Auth?.Cognito;h(e);const{userPoolEndpoint:t,userPoolId:n}=e,{tokens:o}=await(0,r.fetchAuthSession)({forceRefresh:!1});Te(o);const i=o.idToken?.payload["cognito:username"]??"",s=Ut({endpointResolver:Ot({endpointOverride:t})}),{SecretCode:a}=await s({region:k(n),userAgentValue:Qe(I.SetUpTOTP)},{AccessToken:o.accessToken.toString()});if(!a)throw new _({name:Se,message:"Failed to set up TOTP."});return go(a,JSON.stringify(i))}const si=async e=>{const{userAttributes:t,options:n}=e,o=r.Amplify.getConfig().Auth?.Cognito,i=n?.clientMetadata;h(o);const{userPoolEndpoint:s,userPoolId:a}=o,{tokens:c}=await(0,r.fetchAuthSession)({forceRefresh:!1});Te(c);const d=(u={endpointResolver:Ot({endpointOverride:s})},Xe(mt,et("UpdateUserAttributes"),dt(),{...vt,...u}));var u;const{CodeDeliveryDetailsList:l}=await d({region:k(a),userAgentValue:Qe(I.UpdateUserAttributes)},{AccessToken:c.accessToken.toString(),ClientMetadata:i,UserAttributes:F(t)});return{...ai(t),...ci(l)}};function ai(e){const t={};return Object.keys(e)?.forEach((e=>{t[e]={isUpdated:!0,nextStep:{updateAttributeStep:"DONE"}}})),t}function ci(e){const t={};return e?.forEach((e=>{const{AttributeName:n,DeliveryMedium:o,Destination:i}=e;n&&(t[n]={isUpdated:!1,nextStep:{updateAttributeStep:"CONFIRM_ATTRIBUTE_WITH_CODE",codeDeliveryDetails:{attributeName:n,deliveryMedium:o,destination:i}}})})),t}const di=async e=>{const{userAttribute:{attributeKey:t,value:n},options:o}=e,i=await si({userAttributes:{[t]:n},options:o});return Object.values(i)[0]},ui=e=>Xe(mt,et("VerifyUserAttribute"),dt(),{...vt,...e});async function li(e){const t=r.Amplify.getConfig().Auth?.Cognito;h(t);const{userPoolEndpoint:n,userPoolId:o}=t,{confirmationCode:i,userAttributeKey:s}=e;O(!!i,U.EmptyConfirmUserAttributeCode);const{tokens:a}=await(0,r.fetchAuthSession)({forceRefresh:!1});Te(a);const c=ui({endpointResolver:Ot({endpointOverride:n})});await c({region:k(o),userAgentValue:Qe(I.ConfirmUserAttribute)},{AccessToken:a.accessToken.toString(),AttributeName:s,Code:i})}const pi=Symbol("oauth-listener");new r.ConsoleLogger("AuthError"),Error;const hi={message:D.OAUTH_ERROR,log:"Make sure Cognito Hosted UI has been configured correctly"},gi=(D.DEFAULT_MSG,D.DEFAULT_MSG,D.EMPTY_USERNAME,D.INVALID_USERNAME,D.EMPTY_PASSWORD,D.EMPTY_CODE,D.SIGN_UP_ERROR,D.NO_MFA,D.INVALID_MFA,D.EMPTY_CHALLENGE,D.NO_USER_SESSION,D.DEVICE_CONFIG,D.NETWORK_ERROR,D.AUTOSIGNIN_ERROR,D.DEFAULT_MSG,(e,t)=>new _({message:e??"An error has occurred during the oauth process.",name:M.OAuthSignInError,recoverySuggestion:t??hi.log}));var Ei;!function(e){e.NoConfig="noConfig",e.MissingAuthConfig="missingAuthConfig",e.EmptyUsername="emptyUsername",e.InvalidUsername="invalidUsername",e.EmptyPassword="emptyPassword",e.EmptyCode="emptyCode",e.SignUpError="signUpError",e.NoMFA="noMFA",e.InvalidMFA="invalidMFA",e.EmptyChallengeResponse="emptyChallengeResponse",e.NoUserSession="noUserSession",e.Default="default",e.DeviceConfig="deviceConfig",e.NetworkError="networkError",e.AutoSignInError="autoSignInError",e.OAuthSignInError="oauthSignInError"}(Ei||(Ei={}));const mi=async e=>{const t=await Yt.loadOAuthState(),n=e===t?t:void 0;if(!n)throw new _({name:Ei.OAuthSignInError,message:null===e?"`signInWithRedirect` has been canceled.":"An error occurred while validating the state.",recoverySuggestion:null===e?void 0:"Try to initiate an OAuth flow from Amplify"});return n},fi=async({currentUrl:e,userAgentValue:t,clientId:n,redirectUri:o,responseType:i,domain:r,preferPrivateSession:s})=>{const a=new $(e),c=a.searchParams.get("error"),d=a.searchParams.get("error_description");if(c)throw gi(d??c);return"code"===i?yi({currentUrl:e,userAgentValue:t,clientId:n,redirectUri:o,domain:r,preferPrivateSession:s}):Si({currentUrl:e,redirectUri:o,preferPrivateSession:s})},yi=async({currentUrl:e,userAgentValue:t,clientId:n,redirectUri:o,domain:i,preferPrivateSession:s})=>{const a=new $(e),c=a.searchParams.get("code"),d=a.searchParams.get("state");if(!c||!d)throw gi("User cancelled OAuth flow.");const u=await mi(d),l="https://"+i+"/oauth2/token",p=await Yt.loadPKCE(),h={grant_type:"authorization_code",code:c,client_id:n,redirect_uri:o,...p?{code_verifier:p}:{}},g=Object.entries(h).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&"),{access_token:E,refresh_token:m,id_token:f,error:y,error_message:S,token_type:A,expires_in:I}=await(await fetch(l,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",[L]:t},body:g})).json();if(y)throw gi(S??y);const w=(E&&(0,r.decodeJWT)(E).payload.username)??"username";return await nn({username:w,AccessToken:E,IdToken:f,RefreshToken:m,TokenType:A,ExpiresIn:I}),Ai({redirectUri:o,state:u,preferPrivateSession:s})},Si=async({currentUrl:e,redirectUri:t,preferPrivateSession:n})=>{const o=new $(e),{id_token:i,access_token:s,state:a,token_type:c,expires_in:d,error_description:u,error:l}=(o.hash??"#").substring(1).split("&").map((e=>e.split("="))).reduce(((e,[t,n])=>({...e,[t]:n})),{id_token:void 0,access_token:void 0,state:void 0,token_type:void 0,expires_in:void 0,error_description:void 0,error:void 0});if(l)throw gi(u??l);if(!s)throw gi("No access token returned from OAuth flow.");const p=await mi(a),h=(s&&(0,r.decodeJWT)(s).payload.username)??"username";return await nn({username:h,AccessToken:s,IdToken:i,TokenType:c,ExpiresIn:d}),Ai({redirectUri:t,state:p,preferPrivateSession:n})},Ai=async({redirectUri:e,state:t,preferPrivateSession:n})=>{var o;await tn.setOAuthMetadata({oauthSignIn:!0}),await Yt.clearOAuthData(),await Yt.storeOAuthSignIn(!0,n),Qt(),Ii(t)&&r.Hub.dispatch("auth",{event:"customOAuthState",data:(o=wi(t),(o.match(/.{2}/g)||[]).map((e=>String.fromCharCode(parseInt(e,16)))).join(""))},"Auth",B),r.Hub.dispatch("auth",{event:"signInWithRedirect"},"Auth",B),await on(),xi(e)},Ii=e=>/-/.test(e),wi=e=>e.split("-").splice(1).join("-"),xi=e=>{"undefined"!=typeof window&&void 0!==window.history&&window.history.replaceState(window.history.state,"",e)};function Ci(e,t){if(t){const n=e?.find((e=>e===t));if(!n)throw ve;return n}{const t=e?.find(vi)??e?.find(Pi),n=e?.find(Ti)??e?.find(Ri);if(t)return t;if(n)throw Pe;throw Ce}}const vi=e=>e.startsWith(String(window.location.origin+window.location.pathname??"/")),Pi=e=>e.includes(String(window.location.hostname)),Ri=e=>e.startsWith("http://"),Ti=e=>e.startsWith("https://"),Ni=async e=>{Qt(),await Yt.clearOAuthInflightData(),r.Hub.dispatch("auth",{event:"signInWithRedirect_failure",data:{error:e}},"Auth",B)};Ht()&&r.Amplify[pi]((async e=>{try{h(e),g(e),Yt.setAuthConfig(e)}catch(e){return}if(await Yt.loadOAuthInFlight())try{const t=window.location.href,{loginWith:n,userPoolClientId:o}=e,{domain:i,redirectSignIn:r,responseType:s}=n.oauth,a=Ci(r);await fi({currentUrl:t,clientId:o,domain:i,redirectUri:a,responseType:s,userAgentValue:Qe(I.SignInWithRedirect)})}catch(e){await Ni(e)}}));const Ui={Google:"Google",Facebook:"Facebook",Amazon:"LoginWithAmazon",Apple:"SignInWithApple"},bi=async e=>{window?.location&&(window.location.href=e.replace("http://","https://"))};async function Di(e){const t=r.Amplify.getConfig().Auth?.Cognito;h(t),g(t),Yt.setAuthConfig(t),await wo();let n="COGNITO";return"string"==typeof e?.provider?n=Ui[e.provider]:e?.provider?.custom&&(n=e.provider.custom),Mi({oauthConfig:t.loginWith.oauth,clientId:t.userPoolClientId,provider:n,customState:e?.customState,preferPrivateSession:e?.options?.preferPrivateSession})}const Mi=async({oauthConfig:e,provider:t,clientId:n,customState:o,preferPrivateSession:i})=>{const{domain:r,redirectSignIn:s,responseType:c,scopes:d}=e,u=(()=>{let e="";for(let t=0;t<32;t++)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return e})(),l=o?`${u}-${p=o,p.split("").map((e=>e.charCodeAt(0).toString(16).padStart(2,"0"))).join("")}`:u;var p;const{value:h,method:g,toCodeChallenge:E}=(e=>{const t=new Uint8Array(e);a().getRandomValues(t);let n,o="";for(const e of t)o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(e%62);return{value:o,method:"S256",toCodeChallenge:()=>n||(n=function(e){const t=new qn;return t.update(e),z.convert(t.digestSync(),{urlSafe:!0}).replace(/=/g,"")}(o),n)}})(128),m=Ci(e.redirectSignIn);Ht()&&Yt.storeOAuthInFlight(!0),Yt.storeOAuthState(l),Yt.storePKCE(h);const f=`https://${r}/oauth2/authorize?${Object.entries({redirect_uri:m,response_type:c,client_id:n,identity_provider:t,scope:d.join(" "),state:l,..."code"===c&&{code_challenge:E(),code_challenge_method:g}}).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`)).join("&")}`;var y;y=Yt,window.addEventListener("pageshow",(async function e(t){if(t.persisted&&await y.loadOAuthInFlight()){const e=gi("User cancelled OAuth flow.");await Ni(e)}window.removeEventListener("pageshow",e)}));const{type:S,error:A,url:w}=await bi(f)??{};try{if("error"===S)throw gi(String(A));"success"===S&&w&&await fi({currentUrl:w,clientId:n,domain:r,redirectUri:m,responseType:c,userAgentValue:Qe(I.SignInWithRedirect),preferPrivateSession:i})}catch(e){throw await Ni(e),e}},_i=()=>(async e=>{const t=e.getConfig().Auth?.Cognito;h(t);const{userPoolEndpoint:n,userPoolId:o}=t,{tokens:i}=await(e=>e.Auth.fetchAuthSession({forceRefresh:!1}))(e);Te(i);const r=ei({endpointResolver:Ot({endpointOverride:n})}),{UserAttributes:s}=await r({region:k(o),userAgentValue:Qe(I.FetchUserAttributes)},{AccessToken:i.accessToken.toString()});return function(e){const t={};return e?.forEach((e=>{e.Name&&(t[e.Name]=e.Value)})),t}(s)})(r.Amplify),Oi=async e=>{await e.clearOAuthData(),tn.clearTokens(),await(0,r.clearCredentials)(),r.Hub.dispatch("auth",{event:"signedOut"},"Auth",B)},ki=async(e,t,n,o)=>{const{isOAuthSignIn:i}=await t.loadOAuthSignIn(),r=await n.getOAuthMetadata();if(await Oi(t),i||r?.oauthSignIn)return(async(e,t=!1,n)=>{g(e);const{loginWith:o,userPoolClientId:i}=e,{domain:r,redirectSignOut:s}=o.oauth,a=Ci(s,n),c=`https://${r}/logout?${Object.entries({client_id:i,logout_uri:encodeURIComponent(a)}).map((([e,t])=>`${e}=${t}`)).join("&")}`;return bi(c)})(e,!1,o)},Fi=e=>Xe(mt,et("RevokeToken"),dt(),{...vt,...e}),Li=e=>Xe(mt,et("GlobalSignOut"),dt(),{...vt,...e}),Vi=new r.ConsoleLogger("Auth");async function Ki(e){const t=r.Amplify.getConfig().Auth?.Cognito;let n;h(t),e?.global?await async function(e){try{const{userPoolEndpoint:t,userPoolId:n}=e,o=await tn.getTokenStore().loadTokens();Te(o);const i=Li({endpointResolver:Ot({endpointOverride:t})});await i({region:k(n),userAgentValue:Qe(I.SignOut)},{AccessToken:o.accessToken.toString()})}catch(e){Vi.debug("Global signOut error caught but will proceed with token removal")}}(t):await async function(e){try{const{userPoolEndpoint:t,userPoolId:n,userPoolClientId:o}=e,i=await tn.getTokenStore().loadTokens();if(be(i),Wi(i.accessToken)){const e=Fi({endpointResolver:Ot({endpointOverride:t})});await e({region:k(n),userAgentValue:Qe(I.SignOut)},{ClientId:o,Token:i.refreshToken})}}catch(e){Vi.debug("Client signOut error caught but will proceed with token removal")}}(t);try{g(t),n=!0}catch(e){n=!1}if(n){const n=new jt(r.defaultStorage);n.setAuthConfig(t);const{type:o}=await ki(t,n,tn,e?.oauth?.redirectUrl)??{};if("error"===o)throw new _({name:Re,message:"An error occurred when attempting to log out from OAuth provider."})}else tn.clearTokens(),await(0,r.clearCredentials)(),r.Hub.dispatch("auth",{event:"signedOut"},"Auth",B)}const Wi=e=>!!e?.payload?.origin_jti,Bi=async e=>{const{userAttributeKey:t,options:n}=e,o=r.Amplify.getConfig().Auth?.Cognito,i=n?.clientMetadata;h(o);const{userPoolEndpoint:s,userPoolId:a}=o,{tokens:c}=await(0,r.fetchAuthSession)({forceRefresh:!1});Te(c);const d=(u={endpointResolver:Ot({endpointOverride:s})},Xe(mt,et("GetUserAttributeVerificationCode"),dt(),{...vt,...u}));var u;const{CodeDeliveryDetails:l}=await d({region:k(a),userAgentValue:Qe(I.SendUserAttributeVerificationCode)},{AccessToken:c.accessToken.toString(),ClientMetadata:i,AttributeName:t}),{DeliveryMedium:p,AttributeName:g,Destination:E}={...l};return{destination:E,deliveryMedium:p,attributeName:g}},qi=e=>Xe(mt,et("DeleteUserAttributes"),dt(),{...vt,...e});async function Hi(e){const t=r.Amplify.getConfig().Auth?.Cognito;h(t);const{userAttributeKeys:n}=e,{userPoolEndpoint:o,userPoolId:i}=t,{tokens:s}=await(0,r.fetchAuthSession)({forceRefresh:!1});Te(s);const a=qi({endpointResolver:Ot({endpointOverride:o})});await a({region:k(i),userAgentValue:Qe(I.DeleteUserAttributes)},{AccessToken:s.accessToken.toString(),UserAttributeNames:n})}const Gi=()=>async e=>{if(e.statusCode>=300){const t=await rt(e);throw ct(t),new _({name:t.name,message:t.message})}},$i=e=>Xe(mt,et("DeleteUser"),Gi(),{...vt,...e});async function zi(){const e=r.Amplify.getConfig().Auth?.Cognito;h(e);const{userPoolEndpoint:t,userPoolId:n}=e,{tokens:o}=await(0,r.fetchAuthSession)();Te(o);const i=$i({endpointResolver:Ot({endpointOverride:t})});await i({region:k(n),userAgentValue:Qe(I.DeleteUser)},{AccessToken:o.accessToken.toString()}),await tn.clearDeviceMetadata(),await Ki()}const ji=e=>Xe(mt,et("UpdateDeviceStatus"),dt(),{...vt,...e});async function Ji(){const e=r.Amplify.getConfig().Auth?.Cognito;h(e);const{userPoolEndpoint:t,userPoolId:n}=e,{tokens:o}=await(0,r.fetchAuthSession)();Te(o);const i=await(tn?.getDeviceMetadata());De(i);const s=ji({endpointResolver:Ot({endpointOverride:t})});await s({region:k(n),userAgentValue:Qe(I.RememberDevice)},{AccessToken:o.accessToken.toString(),DeviceKey:i.deviceKey,DeviceRememberedStatus:"remembered"})}const Yi=e=>Xe(mt,et("ForgetDevice"),Gi(),{...vt,...e});async function Zi(e){const{device:{id:t}={id:void 0}}=e??{},n=r.Amplify.getConfig().Auth?.Cognito;h(n);const{userPoolEndpoint:o,userPoolId:i}=n,{tokens:s}=await(0,r.fetchAuthSession)();Te(s);const a=await tn.getDeviceMetadata(),c=a?.deviceKey;t||De(a);const d=Yi({endpointResolver:Ot({endpointOverride:o})});await d({region:k(i),userAgentValue:Qe(I.ForgetDevice)},{AccessToken:s.accessToken.toString(),DeviceKey:t??c}),t&&t!==c||await tn.clearDeviceMetadata()}const Qi=e=>Xe(mt,et("ListDevices"),dt(),{...vt,...e}),Xi=60;async function er(){const e=r.Amplify.getConfig().Auth?.Cognito;h(e);const{userPoolEndpoint:t,userPoolId:n}=e,{tokens:o}=await(0,r.fetchAuthSession)();Te(o);const i=Qi({endpointResolver:Ot({endpointOverride:t})}),s=await i({region:k(n),userAgentValue:Qe(I.FetchDevices)},{AccessToken:o.accessToken.toString(),Limit:Xi});return tr(s.Devices??[])}const tr=async e=>e.map((({DeviceKey:e="",DeviceAttributes:t=[],DeviceCreateDate:n,DeviceLastModifiedDate:o,DeviceLastAuthenticatedDate:i})=>{let r;const s=t.reduce(((e,{Name:t,Value:n})=>(t&&n&&("device_name"===t&&(r=n),e[t]=n),e)),{});return{id:e,name:r,attributes:s,createDate:n?new Date(1e3*n):void 0,lastModifiedDate:o?new Date(1e3*o):void 0,lastAuthenticatedDate:i?new Date(1e3*i):void 0}})),nr=async e=>{try{const t=mn();gn(t,dn.PasskeyNotSupported);const n=(e=>{const t=yn(e.user.id),n=yn(e.challenge),o=(e.excludeCredentials||[]).map((e=>({...e,id:yn(e.id)})));return{...e,excludeCredentials:o,challenge:n,user:{...e.user,id:t}}})(e),o=await navigator.credentials.create({publicKey:n});return function(e){gn(e&&e instanceof PublicKeyCredential&&e.response instanceof AuthenticatorAttestationResponse,dn.PasskeyRegistrationFailed)}(o),(e=>{const t={clientDataJSON:fn(e.response.clientDataJSON),attestationObject:fn(e.response.attestationObject),transports:e.response.getTransports(),publicKeyAlgorithm:e.response.getPublicKeyAlgorithm(),authenticatorData:fn(e.response.getAuthenticatorData())},n=e.response.getPublicKey();n&&(t.publicKey=fn(n));const o={type:e.type,id:e.id,rawId:fn(e.rawId),clientExtensionResults:e.getClientExtensionResults(),response:t};return e.authenticatorAttachment&&(o.authenticatorAttachment=e.authenticatorAttachment),o})(o)}catch(e){throw(e=>{if(e instanceof cn)return e;if(e instanceof Error){if("InvalidStateError"===e.name){const{message:t,recoverySuggestion:n}=hn[dn.PasskeyAlreadyExists];return new cn({name:dn.PasskeyAlreadyExists,message:t,recoverySuggestion:n,underlyingError:e})}if("NotAllowedError"===e.name){const{message:t,recoverySuggestion:n}=hn[dn.PasskeyRegistrationCanceled];return new cn({name:dn.PasskeyRegistrationCanceled,message:t,recoverySuggestion:n,underlyingError:e})}}return En(e)})(e)}},or=e=>Xe(mt,et("StartWebAuthnRegistration"),dt(),{...vt,...e}),ir=e=>Xe(mt,et("CompleteWebAuthnRegistration"),dt(),{...vt,...e});async function rr(){const e=r.Amplify.getConfig().Auth?.Cognito;h(e);const{userPoolEndpoint:t,userPoolId:n}=e,{tokens:o}=await(0,r.fetchAuthSession)();Te(o);const i=or({endpointResolver:Ot({endpointOverride:t})}),{CredentialCreationOptions:s}=await i({region:k(n),userAgentValue:Qe(I.StartWebAuthnRegistration)},{AccessToken:o.accessToken.toString()});!function(e){gn([!!e,!!e?.challenge,!!e?.user,!!e?.rp,!!e?.pubKeyCredParams].every(Boolean),dn.InvalidPasskeyRegistrationOptions)}(s);const a=await nr(s),c=ir({endpointResolver:Ot({endpointOverride:t})});await c({region:k(n),userAgentValue:Qe(I.CompleteWebAuthnRegistration)},{AccessToken:o.accessToken.toString(),Credential:a})}const sr=e=>Xe(mt,et("ListWebAuthnCredentials"),dt(),{...vt,...e});async function ar(e){return async function(e,t){const n=e.getConfig().Auth?.Cognito;h(n);const{userPoolEndpoint:o,userPoolId:i}=n,{tokens:r}=await e.Auth.fetchAuthSession();Te(r);const s=sr({endpointResolver:Ot({endpointOverride:o})}),{Credentials:a=[],NextToken:c}=await s({region:k(i),userAgentValue:Qe(I.ListWebAuthnCredentials)},{AccessToken:r.accessToken.toString(),MaxResults:t?.pageSize,NextToken:t?.nextToken});return{credentials:a.map((e=>({credentialId:e.CredentialId,friendlyCredentialName:e.FriendlyCredentialName,relyingPartyId:e.RelyingPartyId,authenticatorAttachment:e.AuthenticatorAttachment,authenticatorTransports:e.AuthenticatorTransports,createdAt:e.CreatedAt?new Date(1e3*e.CreatedAt):void 0}))),nextToken:c}}(r.Amplify,e)}const cr=e=>Xe(mt,et("DeleteWebAuthnCredential"),dt(),{...vt,...e});async function dr(e){return async function(e,t){const n=e.getConfig().Auth?.Cognito;h(n);const{userPoolEndpoint:o,userPoolId:i}=n,{tokens:r}=await e.Auth.fetchAuthSession();Te(r);const s=cr({endpointResolver:Ot({endpointOverride:o})});await s({region:k(i),userAgentValue:Qe(I.DeleteWebAuthnCredential)},{AccessToken:r.accessToken.toString(),CredentialId:t.credentialId})}(r.Amplify,e)}return i})()));
//# sourceMappingURL=aws-amplify-auth.min.js.map