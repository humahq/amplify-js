/*! For license information please see aws-amplify.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("aws_amplify",[],t):"object"==typeof exports?exports.aws_amplify=t():e.aws_amplify=t()}(this,(()=>(()=>{var e={637:(e,t)=>{var n;n=function(e){e.version="1.2.2";var t=function(){for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}(),n=function(e){var t=0,n=0,o=0,r="undefined"!=typeof Int32Array?new Int32Array(4096):new Array(4096);for(o=0;256!=o;++o)r[o]=e[o];for(o=0;256!=o;++o)for(n=e[o],t=256+o;t<4096;t+=256)n=r[t]=n>>>8^e[255&n];var a=[];for(o=1;16!=o;++o)a[o-1]="undefined"!=typeof Int32Array?r.subarray(256*o,256*o+256):r.slice(256*o,256*o+256);return a}(t),o=n[0],r=n[1],a=n[2],i=n[3],s=n[4],c=n[5],u=n[6],d=n[7],l=n[8],p=n[9],f=n[10],g=n[11],h=n[12],y=n[13],m=n[14];e.table=t,e.bstr=function(e,n){for(var o=~n,r=0,a=e.length;r<a;)o=o>>>8^t[255&(o^e.charCodeAt(r++))];return~o},e.buf=function(e,n){for(var b=~n,w=e.length-15,C=0;C<w;)b=m[e[C++]^255&b]^y[e[C++]^b>>8&255]^h[e[C++]^b>>16&255]^g[e[C++]^b>>>24]^f[e[C++]]^p[e[C++]]^l[e[C++]]^d[e[C++]]^u[e[C++]]^c[e[C++]]^s[e[C++]]^i[e[C++]]^a[e[C++]]^r[e[C++]]^o[e[C++]]^t[e[C++]];for(w+=15;C<w;)b=b>>>8^t[255&(b^e[C++])];return~b},e.str=function(e,n){for(var o=~n,r=0,a=e.length,i=0,s=0;r<a;)(i=e.charCodeAt(r++))<128?o=o>>>8^t[255&(o^i)]:i<2048?o=(o=o>>>8^t[255&(o^(192|i>>6&31))])>>>8^t[255&(o^(128|63&i))]:i>=55296&&i<57344?(i=64+(1023&i),s=1023&e.charCodeAt(r++),o=(o=(o=(o=o>>>8^t[255&(o^(240|i>>8&7))])>>>8^t[255&(o^(128|i>>2&63))])>>>8^t[255&(o^(128|s>>6&15|(3&i)<<4))])>>>8^t[255&(o^(128|63&s))]):o=(o=(o=o>>>8^t[255&(o^(224|i>>12&15))])>>>8^t[255&(o^(128|i>>6&63))])>>>8^t[255&(o^(128|63&i))];return~o}},"undefined"==typeof DO_NOT_EXPORT_CRC?n(t):n({})},127:()=>{},685:()=>{},416:()=>{},472:()=>{},616:()=>{},992:()=>{},551:()=>{},493:()=>{},214:()=>{},981:()=>{},362:()=>{}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,n),a.exports}n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return(()=>{"use strict";var e,t;n.r(o),n.d(o,{DEFAULT_PART_SIZE:()=>b,copy:()=>Zo,downloadData:()=>So,getProperties:()=>qo,getUrl:()=>tr,list:()=>Wo,remove:()=>vo,uploadData:()=>yo}),function(e){e.NoEndpointId="NoEndpointId",e.PlatformNotSupported="PlatformNotSupported",e.Unknown="Unknown",e.NetworkError="NetworkError"}(e||(e={}));class r extends Error{constructor({message:e,name:t,recoverySuggestion:n,underlyingError:o}){super(e),this.name=t,this.underlyingError=o,this.recoverySuggestion=n,this.constructor=r,Object.setPrototypeOf(this,r.prototype)}}class a extends r{constructor(){super({name:e.PlatformNotSupported,message:"Function not supported on current platform"})}}class i{constructor(e){this.storage=e}async setItem(e,t){if(!this.storage)throw new a;this.storage.setItem(e,t)}async getItem(e){if(!this.storage)throw new a;return this.storage.getItem(e)}async removeItem(e){if(!this.storage)throw new a;this.storage.removeItem(e)}async clear(){if(!this.storage)throw new a;this.storage.clear()}}!function(e){e.DEBUG="DEBUG",e.ERROR="ERROR",e.INFO="INFO",e.WARN="WARN",e.VERBOSE="VERBOSE",e.NONE="NONE"}(t||(t={}));const s={VERBOSE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,NONE:6};class c{constructor(e,n=t.WARN){this.name=e,this.level=n,this._pluggables=[]}_padding(e){return e<10?"0"+e:""+e}_ts(){const e=new Date;return[this._padding(e.getMinutes()),this._padding(e.getSeconds())].join(":")+"."+e.getMilliseconds()}configure(e){return e?(this._config=e,this._config):this._config}_log(e,...n){let o=this.level;if(c.LOG_LEVEL&&(o=c.LOG_LEVEL),"undefined"!=typeof window&&window.LOG_LEVEL&&(o=window.LOG_LEVEL),!(s[e]>=s[o]))return;let r=console.log.bind(console);e===t.ERROR&&console.error&&(r=console.error.bind(console)),e===t.WARN&&console.warn&&(r=console.warn.bind(console)),c.BIND_ALL_LOG_LEVELS&&(e===t.INFO&&console.info&&(r=console.info.bind(console)),e===t.DEBUG&&console.debug&&(r=console.debug.bind(console)));const a=`[${e}] ${this._ts()} ${this.name}`;let i="";if(1===n.length&&"string"==typeof n[0])i=`${a} - ${n[0]}`,r(i);else if(1===n.length)i=`${a} ${n[0]}`,r(a,n[0]);else if("string"==typeof n[0]){let e=n.slice(1);1===e.length&&(e=e[0]),i=`${a} - ${n[0]} ${e}`,r(`${a} - ${n[0]}`,e)}else i=`${a} ${n}`,r(a,n);for(const e of this._pluggables){const t={message:i,timestamp:Date.now()};e.pushLogs([t])}}log(...e){this._log(t.INFO,...e)}info(...e){this._log(t.INFO,...e)}warn(...e){this._log(t.WARN,...e)}error(...e){this._log(t.ERROR,...e)}debug(...e){this._log(t.DEBUG,...e)}verbose(...e){this._log(t.VERBOSE,...e)}addPluggable(e){e&&"Logging"===e.getCategoryName()&&(this._pluggables.push(e),e.configure(this._config))}listPluggables(){return this._pluggables}}c.LOG_LEVEL=null,c.BIND_ALL_LOG_LEVELS=!1;class u{constructor(){this.storage=new Map}get length(){return this.storage.size}key(e){return e>this.length-1?null:Array.from(this.storage.keys())[e]}setItem(e,t){this.storage.set(e,t)}getItem(e){return this.storage.get(e)??null}removeItem(e){this.storage.delete(e)}clear(){this.storage.clear()}}const d=new c("CoreStorageUtils"),l=new class extends i{constructor(){super((()=>{try{if("undefined"!=typeof window&&window.localStorage)return window.localStorage}catch(e){d.info("localStorage not found. InMemoryStorage is used as a fallback.")}return new u})())}};var p;new class extends i{constructor(){super((()=>{try{if("undefined"!=typeof window&&window.sessionStorage)return window.sessionStorage.getItem("test"),window.sessionStorage;throw new Error("sessionStorage is not defined")}catch(e){return d.info("sessionStorage not found. InMemoryStorage is used as a fallback."),new u}})())}},new i(new u),n(472),n(416),function(e){e.NoCredentials="NoCredentials",e.NoIdentityId="NoIdentityId",e.NoKey="NoKey",e.NoSourceKey="NoSourceKey",e.NoDestinationKey="NoDestinationKey",e.NoSourcePath="NoSourcePath",e.NoDestinationPath="NoDestinationPath",e.NoBucket="NoBucket",e.NoRegion="NoRegion",e.InvalidStorageBucket="InvalidStorageBucket",e.InvalidCopyOperationStorageBucket="InvalidCopyOperationStorageBucket",e.InvalidStorageOperationPrefixInput="InvalidStorageOperationPrefixInput",e.InvalidStorageOperationInput="InvalidStorageOperationInput",e.InvalidAWSAccountID="InvalidAWSAccountID",e.InvalidStoragePathInput="InvalidStoragePathInput",e.InvalidUploadSource="InvalidUploadSource",e.ObjectIsTooLarge="ObjectIsTooLarge",e.UrlExpirationMaxLimitExceed="UrlExpirationMaxLimitExceed",e.InvalidLocationCredentialsCacheSize="InvalidLocationCredentialsCacheSize",e.LocationCredentialsStoreDestroyed="LocationCredentialsStoreDestroyed",e.InvalidS3Uri="InvalidS3Uri",e.InvalidCustomEndpoint="InvalidCustomEndpoint",e.ForcePathStyleEndpointNotSupported="ForcePathStyleEndpointNotSupported",e.DnsIncompatibleBucketName="DnsIncompatibleBucketName"}(p||(p={}));const f={[p.NoCredentials]:{message:"Credentials should not be empty."},[p.NoIdentityId]:{message:"Missing identity ID when accessing objects in protected or private access level."},[p.NoKey]:{message:"Missing key in api call."},[p.NoSourceKey]:{message:"Missing source key in copy api call."},[p.NoDestinationKey]:{message:"Missing destination key in copy api call."},[p.NoSourcePath]:{message:"Missing source path in copy api call."},[p.NoDestinationPath]:{message:"Missing destination path in copy api call."},[p.NoBucket]:{message:"Missing bucket name while accessing object."},[p.NoRegion]:{message:"Missing region while accessing object."},[p.UrlExpirationMaxLimitExceed]:{message:"Url Expiration can not be greater than 7 Days."},[p.ObjectIsTooLarge]:{message:"Object size cannot not be greater than 5TB."},[p.InvalidUploadSource]:{message:"Upload source type can only be a `Blob`, `File`, `ArrayBuffer`, or `string`."},[p.InvalidStorageOperationInput]:{message:"Path or key parameter must be specified in the input. Both can not be specified at the same time."},[p.InvalidAWSAccountID]:{message:"Invalid AWS account ID was provided."},[p.InvalidStorageOperationPrefixInput]:{message:"Both path and prefix can not be specified at the same time."},[p.InvalidStoragePathInput]:{message:"Input `path` does not allow a leading slash (/)."},[p.InvalidLocationCredentialsCacheSize]:{message:"locationCredentialsCacheSize must be a positive integer."},[p.LocationCredentialsStoreDestroyed]:{message:"Location-specific credentials store has been destroyed."},[p.InvalidS3Uri]:{message:"Invalid S3 URI."},[p.InvalidStorageBucket]:{message:"Unable to lookup bucket from provided name in Amplify configuration."},[p.InvalidCopyOperationStorageBucket]:{message:"Missing bucket option in either source or destination."},[p.InvalidCustomEndpoint]:{message:"Invalid S3 custom endpoint."},[p.ForcePathStyleEndpointNotSupported]:{message:"Path style URLs are not supported with S3 Transfer Acceleration."},[p.DnsIncompatibleBucketName]:{message:"The bucket name isn't DNS compatible."}};class g extends r{constructor(e){super(e),this.constructor=g,Object.setPrototypeOf(this,g.prototype)}}function h(e,t){const{message:n,recoverySuggestion:o}=f[t];if(!e)throw new g({name:t,message:n,recoverySuggestion:o})}const y="localhost:4566",m="guest",b=5242880,w="__uploadInProgress",C="prefix",k="key",S="path",x="crc-32";class E extends g{constructor(e={}){super({name:"CanceledError",message:"Upload is canceled by user",...e}),this.constructor=E,Object.setPrototypeOf(this,E.prototype)}}const v=new c("Storage"),I=({job:e,onCancel:t})=>{let n;const o={cancel:e=>{const{state:r}=o;"CANCELED"!==r&&"ERROR"!==r&&"SUCCESS"!==r?(o.state="CANCELED",n=e,t(n)):v.debug(`This task cannot be canceled. State: ${r}`)},state:"IN_PROGRESS"},r=(async()=>{try{const t=await e();return o.state="SUCCESS",t}catch(e){throw(t=e)&&t instanceof E&&(o.state="CANCELED",e.message=n??e.message),o.state="ERROR",e}var t})();return Object.assign(o,{result:r})},A=I,P=({job:e,onCancel:t,onResume:n,onPause:o,isMultipartUpload:r})=>{const a=I({job:e,onCancel:t}),i=Object.assign(a,{pause:()=>{const{state:e}=i;r&&"IN_PROGRESS"===e?(i.state="PAUSED",o?.()):v.debug(`This task cannot be paused. State: ${e}`)},resume:()=>{const{state:e}=i;r&&"PAUSED"===e?(i.state="IN_PROGRESS",n?.()):v.debug(`This task cannot be resumed. State: ${e}`)}});return i},_="undefined"!=typeof Symbol?Symbol("amplify_default"):"@@amplify_default",U=new c("Hub");class O{constructor(e){this.listeners=new Map,this.protectedChannels=["core","auth","api","analytics","interactions","pubsub","storage","ui","xr"],this.name=e}_remove(e,t){const n=this.listeners.get(e);n?this.listeners.set(e,[...n.filter((({callback:e})=>e!==t))]):U.warn(`No listeners for ${e}`)}dispatch(e,t,n,o){"string"==typeof e&&this.protectedChannels.indexOf(e)>-1&&(o===_||U.warn(`WARNING: ${e} is protected and dispatching on it can have unintended consequences`));const r={channel:e,payload:{...t},source:n,patternInfo:[]};try{this._toListeners(r)}catch(e){U.error(e)}}listen(e,t,n="noname"){let o;if("function"!=typeof t)throw new r({name:"NoHubcallbackProvidedException",message:"No callback supplied to Hub"});o=t;let a=this.listeners.get(e);return a||(a=[],this.listeners.set(e,a)),a.push({name:n,callback:o}),()=>{this._remove(e,o)}}_toListeners(e){const{channel:t,payload:n}=e,o=this.listeners.get(t);o&&o.forEach((o=>{U.debug(`Dispatching to ${t} with `,n);try{o.callback(e)}catch(e){U.error(e)}}))}}const T=new O("__default__"),N=(new O("internal-hub"),e=>{const t=Reflect.ownKeys(e);for(const n of t){const t=e[n];(t&&"object"==typeof t||"function"==typeof t)&&N(t)}return Object.freeze(e)}),R=Symbol("oauth-listener"),L=new c("parseAWSExports"),B={API_KEY:"apiKey",AWS_IAM:"iam",AMAZON_COGNITO_USER_POOLS:"userPool",OPENID_CONNECT:"oidc",NONE:"none",AWS_LAMBDA:"lambda",LAMBDA:"lambda"},M=e=>e?.split(",")??[],D=({domain:e,scope:t,redirectSignIn:n,redirectSignOut:o,responseType:r})=>({domain:e,scopes:t,redirectSignIn:M(n),redirectSignOut:M(o),responseType:r}),$=e=>e.map((e=>{const t=e.toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)}));const K={AMAZON_COGNITO_USER_POOLS:"userPool",API_KEY:"apiKey",AWS_IAM:"iam",AWS_LAMBDA:"lambda",OPENID_CONNECT:"oidc"};function z(e){return K[e]}const j={GOOGLE:"Google",LOGIN_WITH_AMAZON:"Amazon",FACEBOOK:"Facebook",SIGN_IN_WITH_APPLE:"Apple"};function G(e=[]){return e.reduce(((e,t)=>(void 0!==j[t]&&e.push(j[t]),e)),[])}function W(e){const t={};return e.forEach((({name:e,bucket_name:n,aws_region:o,paths:r})=>{if(e in t)throw new Error(`Duplicate friendly name found: ${e}. Name must be unique.`);t[e]={bucketName:n,region:o,paths:r}})),t}const V=e=>Object.keys(e).some((e=>e.startsWith("aws_")))?((e={})=>{if(!Object.prototype.hasOwnProperty.call(e,"aws_project_region"))throw new r({name:"InvalidParameterException",message:"Invalid config parameter.",recoverySuggestion:"Ensure passing the config object imported from  `amplifyconfiguration.json`."});const{aws_appsync_apiKey:t,aws_appsync_authenticationType:n,aws_appsync_graphqlEndpoint:o,aws_appsync_region:a,aws_bots_config:i,aws_cognito_identity_pool_id:s,aws_cognito_sign_up_verification_method:c,aws_cognito_mfa_configuration:u,aws_cognito_mfa_types:d,aws_cognito_password_protection_settings:l,aws_cognito_verification_mechanisms:p,aws_cognito_signup_attributes:f,aws_cognito_social_providers:g,aws_cognito_username_attributes:h,aws_mandatory_sign_in:y,aws_mobile_analytics_app_id:m,aws_mobile_analytics_app_region:b,aws_user_files_s3_bucket:w,aws_user_files_s3_bucket_region:C,aws_user_files_s3_dangerously_connect_to_http_endpoint_for_testing:k,aws_user_pools_id:S,aws_user_pools_web_client_id:x,geo:E,oauth:v,predictions:I,aws_cloud_logic_custom:A,Notifications:P,modelIntrospection:_}=e,U={};m&&(U.Analytics={Pinpoint:{appId:m,region:b}});const{InAppMessaging:O,Push:T}=P??{};if(O?.AWSPinpoint||T?.AWSPinpoint){if(O?.AWSPinpoint){const{appId:e,region:t}=O.AWSPinpoint;U.Notifications={InAppMessaging:{Pinpoint:{appId:e,region:t}}}}if(T?.AWSPinpoint){const{appId:e,region:t}=T.AWSPinpoint;U.Notifications={...U.Notifications,PushNotification:{Pinpoint:{appId:e,region:t}}}}}if(Array.isArray(i)&&(U.Interactions={LexV1:Object.fromEntries(i.map((e=>[e.name,e])))}),o){const e=B[n];e||L.debug(`Invalid authentication type ${n}. Falling back to IAM.`),U.API={GraphQL:{endpoint:o,apiKey:t,region:a,defaultAuthMode:e??"iam"}},_&&(U.API.GraphQL.modelIntrospection=_)}const N=u?{status:u&&u.toLowerCase(),totpEnabled:d?.includes("TOTP")??!1,smsEnabled:d?.includes("SMS")??!1}:void 0,R=l?{minLength:l.passwordPolicyMinLength,requireLowercase:l.passwordPolicyCharacters?.includes("REQUIRES_LOWERCASE")??!1,requireUppercase:l.passwordPolicyCharacters?.includes("REQUIRES_UPPERCASE")??!1,requireNumbers:l.passwordPolicyCharacters?.includes("REQUIRES_NUMBERS")??!1,requireSpecialCharacters:l.passwordPolicyCharacters?.includes("REQUIRES_SYMBOLS")??!1}:void 0,M=Array.from(new Set([...p??[],...f??[]])).reduce(((e,t)=>({...e,[t.toLowerCase()]:{required:!0}})),{}),K=h?.includes("EMAIL")??!1,z=h?.includes("PHONE_NUMBER")??!1;(s||S)&&(U.Auth={Cognito:{identityPoolId:s,allowGuestAccess:"enable"!==y,signUpVerificationMethod:c,userAttributes:M,userPoolClientId:x,userPoolId:S,mfa:N,passwordFormat:R,loginWith:{username:!(K||z),email:K,phone:z}}});const j=!!v&&Object.keys(v).length>0,G=!!g&&g.length>0;if(U.Auth&&j&&(U.Auth.Cognito.loginWith={...U.Auth.Cognito.loginWith,oauth:{...D(v),...G&&{providers:$(g)}}}),w&&(U.Storage={S3:{bucket:w,region:C,dangerouslyConnectToHttpEndpointForTesting:k}}),E){const{amazon_location_service:e}=E;U.Geo={LocationService:{maps:e.maps,geofenceCollections:e.geofenceCollections,searchIndices:e.search_indices,region:e.region}}}if(A&&(U.API={...U.API,REST:A.reduce(((e,t)=>{const{name:n,endpoint:o,region:r,service:a}=t;return{...e,[n]:{endpoint:o,...a?{service:a}:void 0,...r?{region:r}:void 0}}}),{})}),I){const{VoiceId:e}=I?.convert?.speechGenerator?.defaults??{};U.Predictions=e?{...I,convert:{...I.convert,speechGenerator:{...I.convert.speechGenerator,defaults:{voiceId:e}}}}:I}return U})(e):function(e){const{version:t}=e;return!!t&&t.startsWith("1")}(e)?function(e){const t={};if(e.storage&&(t.Storage=function(e){if(!e)return;const{bucket_name:t,aws_region:n,buckets:o}=e;return{S3:{bucket:t,region:n,buckets:o&&W(o)}}}(e.storage)),e.auth&&(t.Auth=function(e){if(!e)return;const{user_pool_id:t,user_pool_client_id:n,identity_pool_id:o,password_policy:r,mfa_configuration:a,mfa_methods:i,unauthenticated_identities_enabled:s,oauth:c,username_attributes:u,standard_required_attributes:d,groups:l}=e,p={Cognito:{userPoolId:t,userPoolClientId:n,groups:l}};return o&&(p.Cognito={...p.Cognito,identityPoolId:o}),r&&(p.Cognito.passwordFormat={requireLowercase:r.require_lowercase,requireNumbers:r.require_numbers,requireUppercase:r.require_uppercase,requireSpecialCharacters:r.require_symbols,minLength:r.min_length??6}),a&&(p.Cognito.mfa={status:(f=a,"OPTIONAL"===f?"optional":"REQUIRED"===f?"on":"off"),smsEnabled:i?.includes("SMS"),totpEnabled:i?.includes("TOTP")}),s&&(p.Cognito.allowGuestAccess=s),c&&(p.Cognito.loginWith={oauth:{domain:c.domain,redirectSignIn:c.redirect_sign_in_uri,redirectSignOut:c.redirect_sign_out_uri,responseType:"token"===c.response_type?"token":"code",scopes:c.scopes,providers:G(c.identity_providers)}}),u&&(p.Cognito.loginWith={...p.Cognito.loginWith,email:u.includes("email"),phone:u.includes("phone_number"),username:u.includes("username")}),d&&(p.Cognito.userAttributes=d.reduce(((e,t)=>({...e,[t]:{required:!0}})),{})),p;var f}(e.auth)),e.analytics&&(t.Analytics=function(e){if(!e?.amazon_pinpoint)return;const{amazon_pinpoint:t}=e;return{Pinpoint:{appId:t.app_id,region:t.aws_region}}}(e.analytics)),e.geo&&(t.Geo=function(e){if(!e)return;const{aws_region:t,geofence_collections:n,maps:o,search_indices:r}=e;return{LocationService:{region:t,searchIndices:r,geofenceCollections:n,maps:o}}}(e.geo)),e.data&&(t.API=function(e){if(!e)return;const{aws_region:t,default_authorization_type:n,url:o,api_key:r,model_introspection:a}=e;return{GraphQL:{endpoint:o,defaultAuthMode:z(n),region:t,apiKey:r,modelIntrospection:a}}}(e.data)),e.custom){const n=function(e){if(!e?.events)return;const{url:t,aws_region:n,api_key:o,default_authorization_type:r}=e.events;return{Events:{endpoint:t,defaultAuthMode:z(r),region:n,apiKey:o}}}(e.custom);n&&"Events"in n&&(t.API={...t.API,...n})}return e.notifications&&(t.Notifications=function(e){if(!e)return;const{aws_region:t,channels:n,amazon_pinpoint_app_id:o}=e,r=n.includes("IN_APP_MESSAGING"),a=n.includes("APNS")||n.includes("FCM");if(!r&&!a)return;const i={};return r&&(i.InAppMessaging={Pinpoint:{appId:o,region:t}}),a&&(i.PushNotification={Pinpoint:{appId:o,region:t}}),i}(e.notifications)),t}(e):e,q=new c("Auth");class F{configure(e,t){this.authConfig=e,this.authOptions=t,e.Cognito.userPoolEndpoint&&q.warn(H("Amazon Cognito User Pool")),e.Cognito.identityPoolEndpoint&&q.warn(H("Amazon Cognito Identity Pool"))}async fetchAuthSession(e={}){let t,n;const o=await this.getTokens(e);return o?(n=o.accessToken?.payload?.sub,t=await(this.authOptions?.credentialsProvider?.getCredentialsAndIdentityId({authConfig:this.authConfig,tokens:o,authenticated:!0,forceRefresh:e.forceRefresh}))):t=await(this.authOptions?.credentialsProvider?.getCredentialsAndIdentityId({authConfig:this.authConfig,authenticated:!1,forceRefresh:e.forceRefresh})),{tokens:o,credentials:t?.credentials,identityId:t?.identityId,userSub:n}}async clearCredentials(){await(this.authOptions?.credentialsProvider?.clearCredentialsAndIdentityId())}async getTokens(e){return await(this.authOptions?.tokenProvider?.getTokens(e))??void 0}}const H=e=>`You are using a custom Amazon ${e} endpoint, ensure the endpoint is correct.`;Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var J=64,X=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Q=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],Y=Math.pow(2,53)-1,Z=function(){function e(){this.state=Int32Array.from(Q),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");var t=0,n=e.byteLength;if(this.bytesHashed+=n,8*this.bytesHashed>Y)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;n>0;)this.buffer[this.bufferLength++]=e[t++],n--,this.bufferLength===J&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var e=8*this.bytesHashed,t=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(t.setUint8(this.bufferLength++,128),n%J>=56){for(var o=this.bufferLength;o<J;o++)t.setUint8(o,0);this.hashBuffer(),this.bufferLength=0}for(o=this.bufferLength;o<56;o++)t.setUint8(o,0);t.setUint32(56,Math.floor(e/4294967296),!0),t.setUint32(60,e),this.hashBuffer(),this.finished=!0}var r=new Uint8Array(32);for(o=0;o<8;o++)r[4*o]=this.state[o]>>>24&255,r[4*o+1]=this.state[o]>>>16&255,r[4*o+2]=this.state[o]>>>8&255,r[4*o+3]=this.state[o]>>>0&255;return r},e.prototype.hashBuffer=function(){for(var e=this.buffer,t=this.state,n=t[0],o=t[1],r=t[2],a=t[3],i=t[4],s=t[5],c=t[6],u=t[7],d=0;d<J;d++){if(d<16)this.temp[d]=(255&e[4*d])<<24|(255&e[4*d+1])<<16|(255&e[4*d+2])<<8|255&e[4*d+3];else{var l=this.temp[d-2],p=(l>>>17|l<<15)^(l>>>19|l<<13)^l>>>10,f=((l=this.temp[d-15])>>>7|l<<25)^(l>>>18|l<<14)^l>>>3;this.temp[d]=(p+this.temp[d-7]|0)+(f+this.temp[d-16]|0)}var g=(((i>>>6|i<<26)^(i>>>11|i<<21)^(i>>>25|i<<7))+(i&s^~i&c)|0)+(u+(X[d]+this.temp[d]|0)|0)|0,h=((n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10))+(n&o^n&r^o&r)|0;u=c,c=s,s=i,i=a+g|0,a=r,r=o,o=n,n=g+h|0}t[0]+=n,t[1]+=o,t[2]+=r,t[3]+=a,t[4]+=i,t[5]+=s,t[6]+=c,t[7]+=u},e}(),ee="undefined"!=typeof Buffer&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:e=>(new TextEncoder).encode(e);function te(e){return e instanceof Uint8Array?e:"string"==typeof e?ee(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}var ne=function(){function e(e){this.secret=e,this.hash=new Z,this.reset()}return e.prototype.update=function(e){var t;if(("string"==typeof(t=e)?0!==t.length:0!==t.byteLength)&&!this.error)try{this.hash.update(te(e))}catch(e){this.error=e}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return e=this,t=void 0,o=function(){return function(e,t){var n,o,r,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,(function(e){return[2,this.digestSync()]}))},new((n=void 0)||(n=Promise))((function(r,a){function i(e){try{c(o.next(e))}catch(e){a(e)}}function s(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((o=o.apply(e,t||[])).next())}));var e,t,n,o},e.prototype.reset=function(){if(this.hash=new Z,this.secret){this.outer=new Z;var e=function(e){var t=te(e);if(t.byteLength>J){var n=new Z;n.update(t),t=n.digest()}var o=new Uint8Array(J);return o.set(t),o}(this.secret),t=new Uint8Array(J);t.set(e);for(var n=0;n<J;n++)e[n]^=54,t[n]^=92;for(this.hash.update(e),this.outer.update(t),n=0;n<e.byteLength;n++)e[n]=0}},e}();const oe={},re={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();1===t.length&&(t=`0${t}`),oe[e]=t,re[t]=e}const ae=new class{constructor(){this.oAuthListener=void 0,this.resourcesConfig={},this.libraryOptions={},this.Auth=new F}configure(e,t){const n=V(e);this.resourcesConfig=n,t&&(this.libraryOptions=t),this.resourcesConfig=N(this.resourcesConfig),this.Auth.configure(this.resourcesConfig.Auth,this.libraryOptions.Auth),T.dispatch("core",{event:"configure",data:this.resourcesConfig},"Configure",_),this.notifyOAuthListener()}getConfig(){return this.resourcesConfig}[R](e){this.resourcesConfig.Auth?.Cognito.loginWith?.oauth?e(this.resourcesConfig.Auth?.Cognito):this.oAuthListener=e}notifyOAuthListener(){this.resourcesConfig.Auth?.Cognito.loginWith?.oauth&&this.oAuthListener&&(this.oAuthListener(this.resourcesConfig.Auth?.Cognito),this.oAuthListener=void 0)}};var ie,se,ce,ue,de,le,pe,fe,ge,he,ye,me,be,we;!function(e){e.WebUnknown="0",e.React="1",e.NextJs="2",e.Angular="3",e.VueJs="4",e.Nuxt="5",e.Svelte="6",e.ServerSideUnknown="100",e.ReactSSR="101",e.NextJsSSR="102",e.AngularSSR="103",e.VueJsSSR="104",e.NuxtSSR="105",e.SvelteSSR="106",e.ReactNative="201",e.Expo="202"}(ie||(ie={})),function(e){e.AI="ai",e.API="api",e.Auth="auth",e.Analytics="analytics",e.DataStore="datastore",e.Geo="geo",e.InAppMessaging="inappmessaging",e.Interactions="interactions",e.Predictions="predictions",e.PubSub="pubsub",e.PushNotification="pushnotification",e.Storage="storage"}(se||(se={})),function(e){e.CreateConversation="1",e.GetConversation="2",e.ListConversations="3",e.DeleteConversation="4",e.SendMessage="5",e.ListMessages="6",e.OnMessage="7",e.Generation="8",e.UpdateConversation="9"}(ce||(ce={})),function(e){e.Record="1",e.IdentifyUser="2"}(ue||(ue={})),function(e){e.GraphQl="1",e.Get="2",e.Post="3",e.Put="4",e.Patch="5",e.Del="6",e.Head="7"}(de||(de={})),function(e){e.SignUp="1",e.ConfirmSignUp="2",e.ResendSignUpCode="3",e.SignIn="4",e.FetchMFAPreference="6",e.UpdateMFAPreference="7",e.SetUpTOTP="10",e.VerifyTOTPSetup="11",e.ConfirmSignIn="12",e.DeleteUserAttributes="15",e.DeleteUser="16",e.UpdateUserAttributes="17",e.FetchUserAttributes="18",e.ConfirmUserAttribute="22",e.SignOut="26",e.UpdatePassword="27",e.ResetPassword="28",e.ConfirmResetPassword="29",e.FederatedSignIn="30",e.RememberDevice="32",e.ForgetDevice="33",e.FetchDevices="34",e.SendUserAttributeVerificationCode="35",e.SignInWithRedirect="36",e.StartWebAuthnRegistration="37",e.CompleteWebAuthnRegistration="38",e.ListWebAuthnCredentials="39",e.DeleteWebAuthnCredential="40"}(le||(le={})),function(e){e.Subscribe="1",e.GraphQl="2"}(pe||(pe={})),function(e){e.SearchByText="0",e.SearchByCoordinates="1",e.SearchForSuggestions="2",e.SearchByPlaceId="3",e.SaveGeofences="4",e.GetGeofence="5",e.ListGeofences="6",e.DeleteGeofences="7"}(fe||(fe={})),function(e){e.SyncMessages="1",e.IdentifyUser="2",e.NotifyMessageInteraction="3"}(ge||(ge={})),function(e){e.None="0"}(he||(he={})),function(e){e.Convert="1",e.Identify="2",e.Interpret="3"}(ye||(ye={})),function(e){e.Subscribe="1"}(me||(me={})),function(e){e.InitializePushNotifications="1",e.IdentifyUser="2"}(be||(be={})),function(e){e.UploadData="1",e.DownloadData="2",e.List="3",e.Copy="4",e.Remove="5",e.GetProperties="6",e.GetUrl="7",e.GetDataAccess="8",e.ListCallerAccessGrants="9"}(we||(we={}));const Ce=[1732584193,4023233417,2562383102,271733878];class ke{constructor(){this.reset()}update(e){if(function(e){return"string"==typeof e?0===e.length:0===e.byteLength}(e))return;if(this.finished)throw new Error("Attempted to update an already finished hash.");const t=function(e){return"string"==typeof e?(t=e,(new TextEncoder).encode(t)):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e);var t}(e);let n=0,{byteLength:o}=t;for(this.bytesHashed+=o;o>0;)this.buffer.setUint8(this.bufferLength++,t[n++]),o--,64===this.bufferLength&&(this.hashBuffer(),this.bufferLength=0)}async digest(){if(!this.finished){const{buffer:e,bufferLength:t,bytesHashed:n}=this,o=8*n;if(e.setUint8(this.bufferLength++,128),t%64>=56){for(let t=this.bufferLength;t<64;t++)e.setUint8(t,0);this.hashBuffer(),this.bufferLength=0}for(let t=this.bufferLength;t<56;t++)e.setUint8(t,0);e.setUint32(56,o>>>0,!0),e.setUint32(60,Math.floor(o/4294967296),!0),this.hashBuffer(),this.finished=!0}const e=new DataView(new ArrayBuffer(16));for(let t=0;t<4;t++)e.setUint32(4*t,this.state[t],!0);return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}hashBuffer(){const{buffer:e,state:t}=this;let n=t[0],o=t[1],r=t[2],a=t[3];n=xe(n,o,r,a,e.getUint32(0,!0),7,3614090360),a=xe(a,n,o,r,e.getUint32(4,!0),12,3905402710),r=xe(r,a,n,o,e.getUint32(8,!0),17,606105819),o=xe(o,r,a,n,e.getUint32(12,!0),22,3250441966),n=xe(n,o,r,a,e.getUint32(16,!0),7,4118548399),a=xe(a,n,o,r,e.getUint32(20,!0),12,1200080426),r=xe(r,a,n,o,e.getUint32(24,!0),17,2821735955),o=xe(o,r,a,n,e.getUint32(28,!0),22,4249261313),n=xe(n,o,r,a,e.getUint32(32,!0),7,1770035416),a=xe(a,n,o,r,e.getUint32(36,!0),12,2336552879),r=xe(r,a,n,o,e.getUint32(40,!0),17,4294925233),o=xe(o,r,a,n,e.getUint32(44,!0),22,2304563134),n=xe(n,o,r,a,e.getUint32(48,!0),7,1804603682),a=xe(a,n,o,r,e.getUint32(52,!0),12,4254626195),r=xe(r,a,n,o,e.getUint32(56,!0),17,2792965006),o=xe(o,r,a,n,e.getUint32(60,!0),22,1236535329),n=Ee(n,o,r,a,e.getUint32(4,!0),5,4129170786),a=Ee(a,n,o,r,e.getUint32(24,!0),9,3225465664),r=Ee(r,a,n,o,e.getUint32(44,!0),14,643717713),o=Ee(o,r,a,n,e.getUint32(0,!0),20,3921069994),n=Ee(n,o,r,a,e.getUint32(20,!0),5,3593408605),a=Ee(a,n,o,r,e.getUint32(40,!0),9,38016083),r=Ee(r,a,n,o,e.getUint32(60,!0),14,3634488961),o=Ee(o,r,a,n,e.getUint32(16,!0),20,3889429448),n=Ee(n,o,r,a,e.getUint32(36,!0),5,568446438),a=Ee(a,n,o,r,e.getUint32(56,!0),9,3275163606),r=Ee(r,a,n,o,e.getUint32(12,!0),14,4107603335),o=Ee(o,r,a,n,e.getUint32(32,!0),20,1163531501),n=Ee(n,o,r,a,e.getUint32(52,!0),5,2850285829),a=Ee(a,n,o,r,e.getUint32(8,!0),9,4243563512),r=Ee(r,a,n,o,e.getUint32(28,!0),14,1735328473),o=Ee(o,r,a,n,e.getUint32(48,!0),20,2368359562),n=ve(n,o,r,a,e.getUint32(20,!0),4,4294588738),a=ve(a,n,o,r,e.getUint32(32,!0),11,2272392833),r=ve(r,a,n,o,e.getUint32(44,!0),16,1839030562),o=ve(o,r,a,n,e.getUint32(56,!0),23,4259657740),n=ve(n,o,r,a,e.getUint32(4,!0),4,2763975236),a=ve(a,n,o,r,e.getUint32(16,!0),11,1272893353),r=ve(r,a,n,o,e.getUint32(28,!0),16,4139469664),o=ve(o,r,a,n,e.getUint32(40,!0),23,3200236656),n=ve(n,o,r,a,e.getUint32(52,!0),4,681279174),a=ve(a,n,o,r,e.getUint32(0,!0),11,3936430074),r=ve(r,a,n,o,e.getUint32(12,!0),16,3572445317),o=ve(o,r,a,n,e.getUint32(24,!0),23,76029189),n=ve(n,o,r,a,e.getUint32(36,!0),4,3654602809),a=ve(a,n,o,r,e.getUint32(48,!0),11,3873151461),r=ve(r,a,n,o,e.getUint32(60,!0),16,530742520),o=ve(o,r,a,n,e.getUint32(8,!0),23,3299628645),n=Ie(n,o,r,a,e.getUint32(0,!0),6,4096336452),a=Ie(a,n,o,r,e.getUint32(28,!0),10,1126891415),r=Ie(r,a,n,o,e.getUint32(56,!0),15,2878612391),o=Ie(o,r,a,n,e.getUint32(20,!0),21,4237533241),n=Ie(n,o,r,a,e.getUint32(48,!0),6,1700485571),a=Ie(a,n,o,r,e.getUint32(12,!0),10,2399980690),r=Ie(r,a,n,o,e.getUint32(40,!0),15,4293915773),o=Ie(o,r,a,n,e.getUint32(4,!0),21,2240044497),n=Ie(n,o,r,a,e.getUint32(32,!0),6,1873313359),a=Ie(a,n,o,r,e.getUint32(60,!0),10,4264355552),r=Ie(r,a,n,o,e.getUint32(24,!0),15,2734768916),o=Ie(o,r,a,n,e.getUint32(52,!0),21,1309151649),n=Ie(n,o,r,a,e.getUint32(16,!0),6,4149444226),a=Ie(a,n,o,r,e.getUint32(44,!0),10,3174756917),r=Ie(r,a,n,o,e.getUint32(8,!0),15,718787259),o=Ie(o,r,a,n,e.getUint32(36,!0),21,3951481745),t[0]=n+t[0]&4294967295,t[1]=o+t[1]&4294967295,t[2]=r+t[2]&4294967295,t[3]=a+t[3]&4294967295}reset(){this.state=Uint32Array.from(Ce),this.buffer=new DataView(new ArrayBuffer(64)),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}}function Se(e,t,n,o,r,a){return((t=(t+e&4294967295)+(o+a&4294967295)&4294967295)<<r|t>>>32-r)+n&4294967295}function xe(e,t,n,o,r,a,i){return Se(t&n|~t&o,e,t,r,a,i)}function Ee(e,t,n,o,r,a,i){return Se(t&o|n&~o,e,t,r,a,i)}function ve(e,t,n,o,r,a,i){return Se(t^n^o,e,t,r,a,i)}function Ie(e,t,n,o,r,a,i){return Se(n^(t|~o),e,t,r,a,i)}function Ae(e){return function(e){const t=Array.from(e,(e=>String.fromCodePoint(e))).join("");return btoa(t)}("string"==typeof e?(new TextEncoder).encode(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}n(362);const Pe=e=>new Promise(((t,n)=>{const o=new FileReader;o.onload=()=>{t(o.result)},o.onabort=()=>{n(new Error("Read aborted"))},o.onerror=()=>{n(o.error)},o.readAsArrayBuffer(e)})),_e=async e=>{const t=new ke,n=e instanceof Blob?await Pe(e):e;return t.update(n),Ae(await t.digest())},Ue=({accessLevel:e,targetIdentityId:t})=>"private"===e?(h(!!t,p.NoIdentityId),`private/${t}/`):"protected"===e?(h(!!t,p.NoIdentityId),`protected/${t}/`):"public/",Oe=async(e,t)=>{const{options:n}=t??{},{identityId:o}=await e.Auth.fetchAuthSession(),{bucket:r,region:a,dangerouslyConnectToHttpEndpointForTesting:i,buckets:s}=e.getConfig()?.Storage?.S3??{},{bucket:c=r,region:u=a}=n?.bucket&&Me(n,s)||{};h(!!c,p.NoBucket),h(!!u,p.NoRegion);const{defaultAccessLevel:d,prefixResolver:l=Ue,isObjectLockEnabled:f}=e.libraryOptions?.Storage?.S3??{},g=n?.accessLevel??d??m,b="protected"===g?n?.targetIdentityId??o:o,w=await l({accessLevel:g,targetIdentityId:b});return{s3Config:{credentials:async o=>{Te(n)&&Ne(t);const{credentials:r}=Te(n)?await n.locationCredentialsProvider(o):await e.Auth.fetchAuthSession();return h(!!r,p.NoCredentials),r},region:u,useAccelerateEndpoint:n?.useAccelerateEndpoint,...n?.customEndpoint?{customEndpoint:n.customEndpoint}:{},...i?{customEndpoint:y,forcePathStyle:!0}:{}},bucket:c,keyPrefix:w,identityId:o,isObjectLockEnabled:f}},Te=e=>!!e?.locationCredentialsProvider,Ne=e=>{if((e=>Re(e)||Le(e)||Be(e))(e)||(e=>e?.path&&"function"==typeof e.path||e?.destination?.path&&"function"==typeof e.destination?.path||e?.source?.path&&"function"==typeof e.source?.path)(e))throw new g({name:"InvalidStorageInput",message:"The input needs to have a path as a string value.",recoverySuggestion:"Please provide a valid path as a string value for the input."})},Re=e=>!("string"!=typeof e.key),Le=e=>!("string"!=typeof e.prefix),Be=e=>!("string"!=typeof e.source?.key&&"string"!=typeof e.destination?.key),Me=(e,t)=>{if("string"==typeof e.bucket){const n=t?.[e.bucket];return h(!!n,p.InvalidStorageBucket),{bucket:n.bucketName,region:n.region}}if("object"==typeof e.bucket)return{bucket:e.bucket.bucketName,region:e.bucket.region}},De=/^\d{12}/,$e=e=>{void 0!==e&&h(De.test(e),p.InvalidAWSAccountID)},Ke=e=>void 0!==e.path,ze=e=>(h(!!e,p.NoIdentityId),e),je=(e,t)=>{if(h(!!e.key&&!e.path||!e.key&&!!e.path,p.InvalidStorageOperationInput),Ke(e)){const{path:n}=e,o="string"==typeof n?n:n({identityId:ze(t)});return h(!o.startsWith("/"),p.InvalidStoragePathInput),{inputType:S,objectKey:o}}return{inputType:k,objectKey:e.key}},Ge=e=>{const{headers:t,statusCode:n}=e;return{...We(e)?e.$metadata:{},httpStatusCode:n,requestId:t["x-amzn-requestid"]??t["x-amzn-request-id"]??t["x-amz-request-id"],extendedRequestId:t["x-amz-id-2"],cfId:t["x-amz-cf-id"]}},We=e=>"object"==typeof e?.$metadata,Ve=URL,qe=URLSearchParams,Fe=(e,t,n,o)=>async(r,a)=>{const i={...o,...r},s=await i.endpointResolver(i,a),c=await t(a,s),u=await e(c,{...i});return n(u)},He=(e,t)=>{if(t?.aborted)return Promise.resolve();let n,o;const r=new Promise((t=>{o=t,n=setTimeout(t,e)}));return t?.addEventListener("abort",(function e(r){clearTimeout(n),t?.removeEventListener("abort",e),o()})),r},Je=(e,t)=>{"[object Object]"===Object.prototype.toString.call(e)&&(e.$metadata={...e.$metadata??{},attempts:t})},Xe=e=>Object.keys(e).map((e=>e.toLowerCase())).sort().join(";"),Qe="X-Amz-Algorithm",Ye="X-Amz-Date",Ze="X-Amz-Credential",et="X-Amz-Expires",tt="X-Amz-SignedHeaders",nt="X-Amz-Security-Token",ot="host",rt=Ye.toLowerCase(),at=nt.toLowerCase(),it="aws4_request",st="AWS4-HMAC-SHA256",ct="e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",ut=({credentials:e,signingDate:t=new Date,signingRegion:n,signingService:o,uriEscapePath:r=!0})=>{const{accessKeyId:a,secretAccessKey:i,sessionToken:s}=e,{longDate:c,shortDate:u}=(e=>{const t=e.toISOString().replace(/[:-]|\.\d{3}/g,"");return{longDate:t,shortDate:t.slice(0,8)}})(t);return{accessKeyId:a,credentialScope:`${u}/${n}/${o}/${it}`,longDate:c,secretAccessKey:i,sessionToken:s,shortDate:u,signingRegion:n,signingService:o,uriEscapePath:r}},dt=(e,t)=>{const n=new ne(e??void 0);return n.update(t),n.digestSync()},lt=(e,t)=>function(e){let t="";for(let n=0;n<e.byteLength;n++)t+=oe[e[n]];return t}(dt(e,t)),pt=e=>Object.entries(e).map((([e,t])=>({key:e.toLowerCase(),value:t?.trim().replace(/\s+/g," ")??""}))).sort(((e,t)=>e.key<t.key?-1:1)).map((e=>`${e.key}:${e.value}\n`)).join(""),ft=e=>encodeURIComponent(e).replace(/[!'()*]/g,gt),gt=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`,ht=(e,t=!0)=>e?t?encodeURIComponent(e).replace(/%2F/g,"/"):e:"/",yt=e=>null==e?ct:mt(e)?lt(null,e):"UNSIGNED-PAYLOAD",mt=e=>"string"==typeof e||ArrayBuffer.isView(e)||bt(e),bt=e=>"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(e),wt=(e,{credentialScope:t,longDate:n,secretAccessKey:o,shortDate:r,signingRegion:a,signingService:i,uriEscapePath:s})=>{const c=(({body:e,headers:t,method:n,url:o},r=!0)=>{return[n,ht(o.pathname,r),(a=o.searchParams,Array.from(a).sort((([e,t],[n,o])=>e===n?t<o?-1:1:e<n?-1:1)).map((([e,t])=>`${ft(e)}=${ft(t)}`)).join("&")),pt(t),Xe(t),yt(e)].join("\n");var a})(e,s),u=((e,t,n)=>[st,e,t,n].join("\n"))(n,t,lt(null,c)),d=lt(((e,t,n,o)=>{const r=dt(`AWS4${e}`,t),a=dt(r,n),i=dt(a,o);return dt(i,it)})(o,r,a,i),u);return d},Ct=e=>new Date(Date.now()+e),kt="Network Error",St="Request aborted",xt="x-amz-content-sha256",Et=e=>{let t;return()=>(t||(t=e()),t)},vt=new c("xhr-http-handler"),It=e=>({transferredBytes:e.loaded,totalBytes:e.lengthComputable?e.total:void 0}),At=["host"],Pt=(_t=(e,t)=>{const{url:n,method:o,headers:r,body:a}=e,{onDownloadProgress:i,onUploadProgress:s,responseType:c,abortSignal:u}=t;return new Promise(((e,t)=>{let d=new XMLHttpRequest;if(d.open(o.toUpperCase(),n.toString()),Object.entries(r).filter((([e])=>!At.includes(e))).forEach((([e,t])=>{d.setRequestHeader(e,t)})),d.responseType=c,i&&d.addEventListener("progress",(e=>{i(It(e)),vt.debug(e)})),s&&d.upload.addEventListener("progress",(e=>{s(It(e)),vt.debug(e)})),d.addEventListener("error",(()=>{const e=new g({message:kt,name:"ERR_NETWORK"});vt.error(kt),t(e),d=null})),d.addEventListener("abort",(()=>{if(!d||u?.aborted)return;const e=((e,t)=>{const n=new Error(e);return n.name=t,n})(St,"ERR_ABORTED");vt.error(St),t(e),d=null})),d.addEventListener("readystatechange",(()=>{d&&d.readyState===d.DONE&&setTimeout((()=>{if(!d)return;const t=(s=d.getAllResponseHeaders())?s.split("\r\n").reduce(((e,t)=>{const n=t.split(": "),o=n.shift(),r=n.join(": ");return e[o.toLowerCase()]=r,e}),{}):{},{responseType:n}=d,o=d.response,r="text"===n?d.responseText:"",a={blob:()=>Promise.resolve(o),text:Et((()=>"blob"===n?(e=>{const t=new FileReader;return new Promise(((n,o)=>{t.onloadend=()=>{t.readyState===FileReader.DONE&&n(t.result)},t.onerror=()=>{o(t.error)},t.readAsText(e)}))})(o):Promise.resolve(r))),json:()=>Promise.reject(new Error("Parsing response to JSON is not implemented. Please use response.text() instead."))},i={statusCode:d.status,headers:t,body:"blob"===d.responseType?Object.assign(o,a):a};var s;e(i),d=null}))})),u){const e=()=>{if(!d)return;const e=new E({name:"ERR_CANCELED",message:"canceled"});t(e),d.abort(),d=null};u.aborted?e():u.addEventListener("abort",e)}if("function"==typeof ReadableStream&&a instanceof ReadableStream)throw new Error("ReadableStream request payload is not supported.");d.send(a??null)}))},Ut=[()=>e=>async function(t){if(t.headers[xt])return e(t);{const n=await yt(t.body);return t.headers[xt]=n,e(t)}},({userAgentHeader:e="x-amz-user-agent",userAgentValue:t=""})=>n=>async function(o){if(0===t.trim().length)return await n(o);{const r=e.toLowerCase();return o.headers[r]=o.headers[r]?`${o.headers[r]} ${t}`:t,await n(o)}},({maxAttempts:e=3,retryDecider:t,computeDelay:n,abortSignal:o})=>{if(e<1)throw new Error("maxAttempts must be greater than 0");return(r,a)=>async function(i){let s,c,u=a.attemptsCount??0;const d=()=>{if(c)return Je(c,u),c;throw Je(s,u),s};for(;!o?.aborted&&u<e;){try{c=await r(i),s=void 0}catch(e){s=e,c=void 0}u=(a.attemptsCount??0)>u?a.attemptsCount??0:u+1,a.attemptsCount=u;const{isCredentialsExpiredError:l,retryable:p}=await t(c,s,a);if(!p)return d();if(a.isCredentialsExpired=!!l,!o?.aborted&&u<e){const e=n(u);await He(e,o)}}if(o?.aborted)throw new Error("Request aborted.");return d()}},({credentials:e,region:t,service:n,uriEscapePath:o=!0})=>{let r;return(a,i)=>async function(s){r=r??0;const c={credentials:"function"==typeof e?await e({forceRefresh:!!i?.isCredentialsExpired}):e,signingDate:Ct(r),signingRegion:t,signingService:n,uriEscapePath:o},u=await((e,t)=>{const n=ut(t),{accessKeyId:o,credentialScope:r,longDate:a,sessionToken:i}=n,s={...e.headers};s[ot]=e.url.host,s[rt]=a,i&&(s[at]=i);const c={...e,headers:s},u=wt(c,n),d=`Credential=${o}/${r}`,l=`SignedHeaders=${Xe(s)}`,p=`Signature=${u}`;return s.authorization=`${st} ${d}, ${l}, ${p}`,c})(s,c),d=await a(u),l=(({headers:e}={})=>e?.date??e?.Date??e?.["x-amz-date"])(d);return l&&(r=((e,t)=>((e,t)=>Math.abs(Ct(t).getTime()-e)>=3e5)(e,t)?e-Date.now():t)(Date.parse(l),r)),d}}],(e,t)=>{const n={};let o=e=>_t(e,t);for(let e=Ut.length-1;e>=0;e--)o=(0,Ut[e])(t)(o,n);return o(e)});var _t,Ut;n(493),n(551);const Ot=(e,t)=>{const n={};for(const[o,r]of Object.entries(t)){const[t,a]=Array.isArray(r)?r:[r];Object.prototype.hasOwnProperty.call(e,t)&&(n[o]=a?a(e[t]):String(e[t]))}return n},Tt=e=>e?Number(e):void 0,Nt=e=>e?"true"===e:void 0,Rt=e=>e?new Date(e):void 0,Lt=(e,t)=>""===e?[]:t((Array.isArray(e)?e:[e]).filter((e=>null!=e))),Bt=e=>{const t="x-amz-meta-",n=Object.keys(e).filter((e=>e.startsWith(t))).reduce(((n,o)=>(n[o.replace(t,"")]=e[o],n)),{});return Object.keys(n).length>0?n:void 0},Mt=(e,t)=>{const n=new g({name:e.name,message:e.message});return 404===t&&(n.recoverySuggestion="Please add the object with this key to the bucket as the key is not found."),n},Dt=e=>e.map((e=>Ot(e,{PartNumber:["PartNumber",Tt],ETag:"ETag",ChecksumCRC32:"ChecksumCRC32"}))),$t=e=>encodeURIComponent(e).replace(/[!'()*]/g,Kt),Kt=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`,zt=e=>{const t={};for(const[n,o]of Object.entries(e))null!=o&&(t[n]=o.toString());return t},jt=async e=>({...zt({"x-amz-acl":e.ACL,"cache-control":e.CacheControl,"content-disposition":e.ContentDisposition,"content-language":e.ContentLanguage,"content-encoding":e.ContentEncoding,"content-type":e.ContentType,expires:e.Expires?.toUTCString(),"x-amz-tagging":e.Tagging,...Gt(e.Metadata)})}),Gt=(e={})=>Object.keys(e).reduce(((t,n)=>(t[`x-amz-meta-${n.toLowerCase()}`]=e[n],t)),{}),Wt=(e,t)=>e.pathname.replace(/\/$/,"")+`/${t.split("/").map($t).join("/")}`;function Vt(t,n){if(!t)throw new g({name:e.Unknown,message:"An unknown error has occurred.",underlyingError:new TypeError(`Expected a non-null value for S3 parameter ${n}`),recoverySuggestion:"This is likely to be a bug. Please reach out to library authors."})}class qt extends g{constructor(t={name:e.Unknown,message:"An unknown error has occurred.",recoverySuggestion:"This may be a bug. Please reach out to library authors."}){super(t),this.constructor=qt,Object.setPrototypeOf(this,qt.prototype)}}function Ft({bucketName:e,key:t,objectURL:n}){if(!e||!t||!n)throw new qt;const o=e.includes("."),r=$t(e),a=t.split("/").map($t).join("/"),i=n.pathname===`/${r}/${a}`,s=n.hostname.startsWith(`${r}.`)&&n.pathname===`/${a}`;if(!(i||!o&&s))throw new qt}const Ht="6.10.2",Jt=()=>"undefined"!=typeof global,Xt=()=>"undefined"!=typeof window,Qt=()=>"undefined"!=typeof document,Yt=()=>"undefined"!=typeof process,Zt=(e,t)=>!!Object.keys(e).find((e=>e.startsWith(t))),en=[{platform:ie.Expo,detectionMethod:function(){return Jt()&&void 0!==global.expo}},{platform:ie.ReactNative,detectionMethod:function(){return"undefined"!=typeof navigator&&void 0!==navigator.product&&"ReactNative"===navigator.product}},{platform:ie.NextJs,detectionMethod:function(){return Xt()&&window.next&&"object"==typeof window.next}},{platform:ie.Nuxt,detectionMethod:function(){return Xt()&&(void 0!==window.__NUXT__||void 0!==window.$nuxt)}},{platform:ie.Angular,detectionMethod:function(){const e=Boolean(Qt()&&document.querySelector("[ng-version]")),t=Boolean(Xt()&&void 0!==window.ng);return e||t}},{platform:ie.React,detectionMethod:function(){const e=e=>e.startsWith("_react")||e.startsWith("__react");return Qt()&&Array.from(document.querySelectorAll("[id]")).some((t=>Object.keys(t).find(e)))}},{platform:ie.VueJs,detectionMethod:function(){return Xt()&&Zt(window,"__VUE")}},{platform:ie.Svelte,detectionMethod:function(){return Xt()&&Zt(window,"__SVELTE")}},{platform:ie.WebUnknown,detectionMethod:function(){return Xt()}},{platform:ie.NextJsSSR,detectionMethod:function(){return Jt()&&(Zt(global,"__next")||Zt(global,"__NEXT"))}},{platform:ie.NuxtSSR,detectionMethod:function(){return Jt()&&void 0!==global.__NUXT_PATHS__}},{platform:ie.ReactSSR,detectionMethod:function(){return Yt()&&void 0!==process.env&&!!Object.keys(process.env).find((e=>e.includes("react")))}},{platform:ie.VueJsSSR,detectionMethod:function(){return Jt()&&Zt(global,"__VUE")}},{platform:ie.AngularSSR,detectionMethod:function(){return Yt()&&"object"==typeof process.env&&process.env.npm_lifecycle_script?.startsWith("ng ")||!1}},{platform:ie.SvelteSSR,detectionMethod:function(){return Yt()&&void 0!==process.env&&!!Object.keys(process.env).find((e=>e.includes("svelte")))}}];let tn;const nn=[];let on=!1;const rn=()=>{if(!tn){if(tn=en.find((e=>e.detectionMethod()))?.platform||ie.ServerSideUnknown,on)for(;nn.length;)nn.pop()?.();else nn.forEach((e=>{e()}));an(ie.ServerSideUnknown,10),an(ie.WebUnknown,10)}return tn};function an(e,t){tn!==e||on||setTimeout((()=>{tn=void 0,on=!0,setTimeout(rn,1e3)}),t)}const sn={},cn="aws-amplify",un=e=>e.replace(/\+.*/,"");new class{constructor(){this.userAgent=`${cn}/${un(Ht)}`}get framework(){return rn()}get isReactNative(){return this.framework===ie.ReactNative||this.framework===ie.Expo}observeFrameworkChanges(e){(e=>{on||nn.push(e)})(e)}};const dn=e=>(({category:e,action:t}={})=>{const n=[[cn,un(Ht)]];if(e&&n.push([e,t]),n.push(["framework",rn()]),e&&t){const o=((e,t)=>sn[e]?.[t]?.additionalDetails)(e,t);o&&o.forEach((e=>{n.push(e)}))}return n})(e).map((([e,t])=>e&&t?`${e}/${t}`:e)).join(" "),ln={id:"aws",outputs:{dnsSuffix:"amazonaws.com"},regionRegex:"^(us|eu|ap|sa|ca|me|af)\\-\\w+\\-\\d+$",regions:["aws-global"]},pn={partitions:[ln,{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn"},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:["aws-cn-global"]}]},fn=e=>{const{partitions:t}=pn;for(const{regions:n,outputs:o,regionRegex:r}of t){const t=new RegExp(r);if(n.includes(e)||t.test(e))return o.dnsSuffix}return ln.outputs.dnsSuffix},gn=3e5,hn=e=>{const t=(new DOMParser).parseFromString(e,"text/xml"),n=yn(t);return n[Object.keys(n)[0]]},yn=e=>{if(bn(e))return{[e.documentElement.nodeName]:yn(e.documentElement)};if(e.nodeType===Node.TEXT_NODE)return e.nodeValue?.trim();if(mn(e)){if(wn(e))return e.childNodes[0].nodeValue;const t={};for(const n of e.attributes)kn(n.nodeName)||(t[n.nodeName]=n.nodeValue);if(e.children.length>0)for(const n of e.children){const e=yn(n);if(void 0===e)continue;const o=n.nodeName;void 0===t[o]?t[o]=e:Array.isArray(t[o])?t[o].push(e):t[o]=[t[o],e]}return 0===Object.keys(t).length?"":t}},mn=e=>e.nodeType===Node.ELEMENT_NODE,bn=e=>e.nodeType===Node.DOCUMENT_NODE,wn=e=>Cn(e)&&0===e.children.length&&e.firstChild?.nodeType===Node.TEXT_NODE,Cn=e=>{for(const t of e.attributes)if(!kn(t.nodeName))return!1;return!0},kn=e=>"xmlns"===e||e.startsWith("xmlns:");n(214);const Sn=async e=>{if(!e.body)throw new Error("S3 aborted request.");const t=await e.body.text();if(t?.length>0)try{return hn(t)}catch(e){throw new Error(`Failed to parse XML response: ${e}`)}return{}},xn=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch","BadRequestException"],En=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException"],vn=["TimeoutError","RequestTimeout","RequestTimeoutException"],In=(e,t)=>429===e||!!t&&En.includes(t),An=t=>[e.NetworkError,"ERR_NETWORK"].includes(t?.name),Pn=(e,t)=>!!e&&[500,502,503,504].includes(e)||!!t&&vn.includes(t),_n=["RequestExpired","ExpiredTokenException","ExpiredToken"],Un=/^[a-z0-9][a-z0-9.-]{1,61}[a-z0-9]$/,On=/(\d+\.){3}\d+/,Tn=/\.\./,Nn=(({noErrorWrapping:e=!1}={})=>async t=>{if(!t||t.statusCode<300)return;const{statusCode:n}=t,o=await Sn(t),r=e?o:o.Error,a=r?.Code?r.Code:404===n?"NotFound":n.toString(),i=new Error(r?.message??r?.Message??a);return Object.assign(i,{name:a,$metadata:Ge(t)})})({noErrorWrapping:!0}),Rn=(Ln=Nn,async(e,t,n)=>{const o=(e=>async(t,n)=>{const o=n??await e(t)??void 0,r=o?.code||o?.name,a=t?.statusCode;return{retryable:An(n)||In(a,r)||(e=>!!e&&xn.includes(e))(r)||Pn(a,r)}})(Ln),r=await o(e,t);if(!e)return{retryable:r.retryable};const a=await Ln(e),i=a?.name,s=a?.message,c=((e,t)=>{const n=!!e&&_n.includes(e),o=!!e&&!!t&&e.includes("Signature")&&t.includes("expired");return n||o})(i,s);return{retryable:r.retryable||!(!c||n?.isCredentialsExpired),isCredentialsExpiredError:c}});var Ln;const Bn={service:"s3",endpointResolver:(e,t)=>{const{region:n,useAccelerateEndpoint:o,customEndpoint:r,forcePathStyle:a}=e;let i;return r?(r===y&&(i=new Ve(r)),h(!r.includes("://"),p.InvalidCustomEndpoint),i=new Ve(`http://${r}`)):o?(h(!a,p.ForcePathStyleEndpointNotSupported),i=new Ve(`https://s3-accelerate.${fn(n)}`)):i=new Ve(`https://s3.${n}.${fn(n)}`),t?.Bucket&&(h((s=t.Bucket,Un.test(s)&&!On.test(s)&&!Tn.test(s)),p.DnsIncompatibleBucketName),a||t.Bucket.includes(".")?i.pathname=`/${t.Bucket}`:i.host=`${t.Bucket}.${i.host}`),{url:i};var s},retryDecider:Rn,computeDelay:e=>{const t=function(e=3e5){return t=>{const n=2**t*100+100*Math.random();return!(n>e)&&n}}(gn),n=t(e);return!1===n?gn:n},userAgentValue:dn(),useAccelerateEndpoint:!1,uriEscapePath:!1},Mn=Fe(Pt,(async(e,t)=>{const n={...await jt({...e,ContentType:e.ContentType??"application/octet-stream"}),...zt({"content-md5":e.ContentMD5,"x-amz-checksum-crc32":e.ChecksumCRC32,"x-amz-expected-bucket-owner":e.ExpectedBucketOwner,"If-None-Match":e.IfNoneMatch})},o=new Ve(t.url.toString());return Vt(!!e.Key,"Key"),o.pathname=Wt(o,e.Key),Ft({bucketName:e.Bucket,key:e.Key,objectURL:o}),{method:"PUT",headers:n,url:o,body:e.Body}}),(async e=>{if(e.statusCode>=300){const t=await Nn(e);throw Mt(t,e.statusCode)}return{...Ot(e.headers,{ETag:"etag",VersionId:"x-amz-version-id"}),$metadata:Ge(e)}}),{...Bn,responseType:"text"});function Dn(e){return dn({category:se.Storage,action:e})}var $n=n(637);const Kn=e=>new Uint8Array((e.match(/\w{2}/g)??[]).map((e=>parseInt(e,16)))),zn=e=>Ae(Kn(e)),jn=1048576,Gn=async(e,t=0)=>{let n=t;if(e instanceof ArrayBuffer||ArrayBuffer.isView(e)){let t;t=e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength);let o=0;for(;o<t.length;){const e=Math.min(o+jn,t.length),r=t.slice(o,e);n=$n.buf(r,n)>>>0,o=e}}else{let t;t=e instanceof Blob?e:new Blob([e]);let o=0;for(;o<t.size;){const e=Math.min(o+jn,t.size),r=t.slice(o,e),a=await Pe(r),i=new Uint8Array(a);n=$n.buf(i,n)>>>0,o=e}}const o=n.toString(16).padStart(8,"0");return{checksumArrayBuffer:(r=o,Kn(r).buffer),checksum:zn(o),seed:n};var r},Wn=e=>{if(!e)return;if("string"==typeof e)return e;const{type:t,filename:n}=e;return void 0!==n?`${t}; filename="${n}"`:t};n(685),n(127),n(981);const Vn=e=>null==e,qn=(e,t)=>Vn(e)&&Vn(t)||e===t,Fn=e=>null!=e&&"object"==typeof e&&!Array.isArray(e),Hn=(e,t)=>{if(Array.isArray(e)&&!Array.isArray(t))return!1;if(!Array.isArray(e)&&Array.isArray(t))return!1;if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every(((e,n)=>Hn(e,t[n])));if(!Fn(e)||!Fn(t))return e===t;const n=Object.keys(e),o=Object.keys(t);return n.length===o.length&&n.every((n=>o.includes(n)&&Hn(e[n],t[n])))},Jn="Invalid parameter for ComplteMultipartUpload API",Xn=e=>{if(!e.ETag||null==e.PartNumber)throw new Error(`${Jn}: ${e}`);return`<Part><ETag>${e.ETag}</ETag><PartNumber>${e.PartNumber}</PartNumber>${e.ChecksumCRC32?`<ChecksumCRC32>${e.ChecksumCRC32}</ChecksumCRC32>`:""}</Part>`},Qn=Fe(Pt,(async(e,t)=>{const n={"content-type":"application/xml",...zt({"x-amz-checksum-crc32":e.ChecksumCRC32,"x-amz-expected-bucket-owner":e.ExpectedBucketOwner,"If-None-Match":e.IfNoneMatch})},o=new Ve(t.url.toString());Vt(!!e.Key,"Key"),o.pathname=Wt(o,e.Key),Vt(!!e.UploadId,"UploadId"),o.search=new qe({uploadId:e.UploadId}).toString(),Vt(!!e.MultipartUpload,"MultipartUpload"),Ft({bucketName:e.Bucket,key:e.Key,objectURL:o});const r=(e=>{if(!e.Parts?.length)throw new Error(`${Jn}: ${e}`);return`<CompleteMultipartUpload xmlns="http://s3.amazonaws.com/doc/2006-03-01/">${e.Parts.map(Xn).join("")}</CompleteMultipartUpload>`})(e.MultipartUpload);return function(e,t){if(!e.Parts)throw new qt;const n=hn(t),o=Ot(n,{Parts:["Part",e=>Lt(e,Dt)]});if(!Hn(e,o))throw new qt}(e.MultipartUpload,r),{method:"POST",headers:n,url:o,body:'<?xml version="1.0" encoding="UTF-8"?>'+r}}),(async e=>{if(e.statusCode>=300){const t=await Nn(e);throw Mt(t,e.statusCode)}{const t=await(async e=>{const t=await Sn(e);if(void 0!==t.Code&&void 0!==t.Message){const t=await Nn({...e,statusCode:500});throw Mt(t,e.statusCode)}return t})(e),n=Ot(t,{ETag:"ETag",Key:"Key",Location:"Location"});return{$metadata:Ge(e),...n}}}),{...Bn,responseType:"text",retryDecider:async(e,t,n)=>{if(!e)return{retryable:!1};if(200===e.statusCode){if(!e.body)return{retryable:!0};const t=await Sn(e);return void 0!==t.Code&&void 0!==t.Message?{retryable:!0}:{retryable:!1}}return Rn(e,t,n)}}),Yn=Fe(Pt,((e,t)=>{const n=new Ve(t.url.toString());return Vt(!!e.Key,"Key"),n.pathname=Wt(n,e.Key),Vt(!!e.UploadId,"UploadId"),n.search=new qe({uploadId:e.UploadId}).toString(),Ft({bucketName:e.Bucket,key:e.Key,objectURL:n}),{method:"DELETE",headers:{...zt({"x-amz-expected-bucket-owner":e.ExpectedBucketOwner})},url:n}}),(async e=>{if(e.statusCode>=300){const t=await Nn(e);throw Mt(t,e.statusCode)}return{$metadata:Ge(e)}}),{...Bn,responseType:"text"}),Zn=Fe(Pt,(async(e,t)=>{const n=new Ve(t.url.toString());return Vt(!!e.Key,"Key"),n.pathname=Wt(n,e.Key),Ft({bucketName:e.Bucket,key:e.Key,objectURL:n}),{method:"HEAD",headers:zt({"x-amz-expected-bucket-owner":e.ExpectedBucketOwner}),url:n}}),(async e=>{if(e.statusCode>=300){const t=await Nn(e);throw Mt(t,e.statusCode)}{const t={...Ot(e.headers,{ContentLength:["content-length",Tt],ContentType:"content-type",ETag:"etag",LastModified:["last-modified",Rt],VersionId:"x-amz-version-id"}),Metadata:Bt(e.headers)};return{$metadata:Ge(e),...t}}}),{...Bn,responseType:"text"}),eo=Fe(Pt,(async(e,t)=>{const n={...zt({"x-amz-checksum-crc32":e.ChecksumCRC32,"content-md5":e.ContentMD5,"x-amz-expected-bucket-owner":e.ExpectedBucketOwner}),"content-type":"application/octet-stream"},o=new Ve(t.url.toString());return Vt(!!e.Key,"Key"),o.pathname=Wt(o,e.Key),Vt(!!e.PartNumber,"PartNumber"),Vt(!!e.UploadId,"UploadId"),o.search=new qe({partNumber:e.PartNumber+"",uploadId:e.UploadId}).toString(),Ft({bucketName:e.Bucket,key:e.Key,objectURL:o}),{method:"PUT",headers:n,url:o,body:e.Body}}),(async e=>{if(e.statusCode>=300){const t=await Nn(e);throw Mt(t,e.statusCode)}return{...Ot(e.headers,{ETag:"etag"}),$metadata:Ge(e)}}),{...Bn,responseType:"text"}),to=async({dataChunkerGenerator:e,completedPartNumberSet:t,s3Config:n,abortSignal:o,bucket:r,finalKey:a,uploadId:i,onPartUploadCompletion:s,onProgress:c,isObjectLockEnabled:u,useCRC32Checksum:d,expectedBucketOwner:l})=>{let p=0;for(const{data:f,partNumber:g,size:h}of e){if(o.aborted){v.debug("upload executor aborted.");break}if(t.has(g))v.debug(`part ${g} already uploaded.`),p+=h,c?.({transferredBytes:p});else{let e;d&&(e=await Gn(f));const t=!e&&u?await _e(f):void 0,{ETag:y}=await eo({...n,abortSignal:o,onUploadProgress:e=>{const{transferredBytes:t}=e;c?.({transferredBytes:p+t})}},{Bucket:r,Key:a,UploadId:i,Body:f,PartNumber:g,ChecksumCRC32:e?.checksum,ContentMD5:t,ExpectedBucketOwner:l});p+=h,s(g,y,e?.checksum)}}},no=Fe(Pt,(async(e,t)=>{const n=new Ve(t.url.toString());return Vt(!!e.Key,"Key"),n.pathname=Wt(n,e.Key),Vt(!!e.UploadId,"UploadId"),n.search=new qe({uploadId:e.UploadId}).toString(),{method:"GET",headers:{},url:n}}),(async e=>{if(e.statusCode>=300){const t=await Nn(e);throw Mt(t,e.statusCode)}{const t=await Sn(e),n=Ot(t,{UploadId:"UploadId",Parts:["Part",e=>Lt(e,Dt)]});return{$metadata:Ge(e),...n}}}),{...Bn,responseType:"text"}),oo=async e=>{try{return JSON.parse(await e.getItem(w)??"{}")}catch(e){return v.debug("failed to parse cached uploads record."),{}}},ro=({file:e,size:t,contentType:n,bucket:o,accessLevel:r,key:a,optionsHash:i})=>{let s;s=void 0===r?"custom":"guest"===r?"public":r;const c=`${i}_${t}_${n??e?.type??"application/octet-stream"}_${o}_${s}_${a}`;return e?`${e.name}_${e.lastModified}_${c}`:c},ao=async(e,t)=>{const n=await oo(e);delete n[t],await e.setItem(w,JSON.stringify(n))},io=Fe(Pt,(async(e,t)=>{const n={...await jt(e),...zt({"x-amz-checksum-algorithm":e.ChecksumAlgorithm,"x-amz-expected-bucket-owner":e.ExpectedBucketOwner})},o=new Ve(t.url.toString());return Vt(!!e.Key,"Key"),o.pathname=Wt(o,e.Key),o.search="uploads",Ft({bucketName:e.Bucket,key:e.Key,objectURL:o}),{method:"POST",headers:n,url:o}}),(async e=>{if(e.statusCode>=300){const t=await Nn(e);throw Mt(t,e.statusCode)}{const t=await Sn(e),n=Ot(t,{UploadId:"UploadId"});return{$metadata:Ge(e),...n}}}),{...Bn,responseType:"text"}),so=e=>{if(!e)return b;let t=b,n=Math.ceil(e/t);for(;n>1e4;)t*=2,n=Math.ceil(e/t);return t},co=(e,t)=>{const n=so(t);if(e instanceof Blob)return uo(e,0,e.size,n);if(ArrayBuffer.isView(e))return uo(e.buffer,e.byteOffset,e.byteLength,n);if(e instanceof ArrayBuffer)return uo(e,0,e.byteLength,n);if("string"==typeof e){const t=new Blob([e]);return co(t,t.size)}throw new g({name:p.InvalidUploadSource,...f[p.InvalidUploadSource]})},uo=function*(e,t,n,o){let r=1,a=t,i=t+Math.min(o,n);for(;i<n+t;)yield{partNumber:r,data:e.slice(a,i),size:o},r+=1,a=i,i=a+o;yield{partNumber:r,data:e.slice(a,n+t),size:n+t-a}},lo=(e,t)=>{let n,o,r,a,i,s,c,u,d,l,p,f,h=!1;const{resumableUploadsCache:y}=e.options??{},m=()=>(async()=>{const{options:n,data:o}=e,m=await Oe(ae,e);i=new AbortController,h=!1,a=m.s3Config,c=m.bucket,d=m.identityId,f=n?.expectedBucketOwner;const{inputType:b,objectKey:C}=je(e,d),{contentDisposition:S,contentEncoding:E,contentType:I="application/octet-stream",metadata:A,preventOverwrite:P,onProgress:_}=n??{};if(p=C,b===k){const e=n?.accessLevel;u=m.keyPrefix,p=u+C,s=po(e)}const U=(await Gn(JSON.stringify(n))).checksum;if(!r){const{uploadId:e,cachedParts:d,finalCrc32:l}=await(async({s3Config:e,data:t,size:n,contentType:o,bucket:r,accessLevel:a,keyPrefix:i,key:s,contentDisposition:c,contentEncoding:u,metadata:d,abortSignal:l,checksumAlgorithm:p,optionsHash:f,resumableUploadsCache:g,expectedBucketOwner:h})=>{const y=void 0!==i?i+s:s;let m;if(g){const i=ro({size:n,contentType:o,file:t instanceof File?t:void 0,bucket:r,accessLevel:a,key:s,optionsHash:f}),c=await(async({resumableUploadsCache:e,cacheKey:t,s3Config:n,bucket:o,finalKey:r})=>{const a=await oo(e);if(!a[t]||a[t].lastTouched<Date.now()-36e5)return null;const i=a[t];i.lastTouched=Date.now(),await e.setItem(w,JSON.stringify(a));try{const{Parts:e=[]}=await no(n,{Bucket:o,Key:r,UploadId:i.uploadId});return{parts:e,uploadId:i.uploadId,finalCrc32:i.finalCrc32}}catch(n){return v.debug("failed to list cached parts, removing cached upload."),await ao(e,t),null}})({s3Config:e,cacheKey:i,bucket:r,finalKey:y,resumableUploadsCache:g});m=c?{...c,uploadCacheKey:i}:void 0}else v.debug("uploaded cache instance cannot be determined, skipping cache."),m=void 0;if(m)return{uploadId:m.uploadId,cachedParts:m.parts,finalCrc32:m.finalCrc32};{const i=p===x?await(async(e,t)=>{const n=[],o=co(e,t);let r=0;for(const{data:e}of o){const t=new Uint8Array((await Gn(e)).checksumArrayBuffer);r+=t.length,n.push(t)}const a=new Uint8Array(r);let i=0;for(const e of n)a.set(e,i),i+=e.length;return`${(await Gn(a.buffer)).checksum}-${n.length}`})(t,n):void 0,{UploadId:m}=await io({...e,abortSignal:l},{Bucket:r,Key:y,ContentType:o,ContentDisposition:Wn(c),ContentEncoding:u,Metadata:d,ChecksumAlgorithm:i?"CRC32":void 0,ExpectedBucketOwner:h});if(g){const e=ro({size:n,contentType:o,file:t instanceof File?t:void 0,bucket:r,accessLevel:a,key:s,optionsHash:f});await(async(e,t,n)=>{const o=await oo(e);o[t]={...n,lastTouched:Date.now()},await e.setItem(w,JSON.stringify(o))})(g,e,{uploadId:m,bucket:r,key:s,finalCrc32:i,fileName:t instanceof File?t.name:""})}return{uploadId:m,cachedParts:[],finalCrc32:i}}})({s3Config:a,accessLevel:s,bucket:c,keyPrefix:u,key:C,contentType:I,contentDisposition:S,contentEncoding:E,metadata:A,data:o,size:t,abortSignal:i.signal,checksumAlgorithm:n?.checksumAlgorithm,optionsHash:U,resumableUploadsCache:y,expectedBucketOwner:f});r={uploadId:e,completedParts:d,finalCrc32:l}}l=t?ro({file:o instanceof File?o:void 0,accessLevel:s,contentType:n?.contentType,bucket:c,size:t,key:C,optionsHash:U}):void 0;const O=co(o,t),T=new Set(r.completedParts.map((({PartNumber:e})=>e))),N=(e,t,n)=>{r?.completedParts.push({PartNumber:e,ETag:t,...n?{ChecksumCRC32:n}:{}})},R=(({size:e,onProgress:t})=>{const n=[];return{getOnProgressListener:()=>{n.push(0);const o=n.length-1;return r=>{const{transferredBytes:a}=r;n[o]=a,t?.({transferredBytes:n.reduce(((e,t)=>e+t),0),totalBytes:e})}}}})({size:t,onProgress:_}),L=[];for(let e=0;e<4;e++)L.push(to({dataChunkerGenerator:O,completedPartNumberSet:T,s3Config:a,abortSignal:i.signal,bucket:c,finalKey:p,uploadId:r.uploadId,onPartUploadCompletion:N,onProgress:R.getOnProgressListener(),isObjectLockEnabled:m.isObjectLockEnabled,useCRC32Checksum:Boolean(r.finalCrc32),expectedBucketOwner:f}));await Promise.all(L),fo(r.completedParts,t);const{ETag:B}=await Qn({...a,abortSignal:i.signal,userAgentValue:Dn(we.UploadData)},{Bucket:c,Key:p,UploadId:r.uploadId,ChecksumCRC32:r.finalCrc32,IfNoneMatch:P?"*":void 0,MultipartUpload:{Parts:go(r.completedParts)},ExpectedBucketOwner:f});if(t){const{ContentLength:e}=await Zn(a,{Bucket:c,Key:p,ExpectedBucketOwner:f});if(e&&e!==t)throw new g({name:"Error",message:`Upload failed. Expected object size ${t}, but got ${e}.`})}y&&l&&await ao(y,l);const M={eTag:B,contentType:I,metadata:A};return b===k?{key:C,...M}:{path:C,...M}})().then(n).catch((e=>{const t=i?.signal;t?.aborted&&h?v.debug("upload paused."):o(e)}));return{multipartUploadJob:()=>new Promise(((e,t)=>{n=e,o=t,m()})),onPause:()=>{h=!0,i?.abort()},onResume:()=>{m()},onCancel:e=>{i?.abort(e),(async()=>{l&&y&&await ao(y,l),await Yn(a,{Bucket:c,Key:p,UploadId:r?.uploadId,ExpectedBucketOwner:f})})().catch((e=>{v.debug("error when cancelling upload task.",e)})),o(new E(e?{message:e}:void 0))}}},po=e=>e??ae.libraryOptions.Storage?.S3?.defaultAccessLevel??m,fo=(e,t)=>{const n=Math.ceil(t/so(t)),o=e.length===n,r=go(e).every(((e,t)=>e.PartNumber===t+1));if(!o||!r)throw new qt},go=e=>[...e].sort(((e,t)=>e.PartNumber-t.PartNumber)),ho=e=>{const{data:t}=e,n=(e=>null==e?0:"string"==typeof e?new Blob([e]).size:"number"==typeof e.byteLength?e.byteLength:"number"==typeof e.size?e.size:void 0)(t);if(h(void 0!==n,p.InvalidUploadSource),h(n<=5497558138880,p.ObjectIsTooLarge),n<=b){const t=new AbortController;return P({isMultipartUpload:!1,job:(o=e,r=t.signal,a=n,async()=>{const{options:e,data:t}=o,{bucket:n,keyPrefix:i,s3Config:s,isObjectLockEnabled:c,identityId:u}=await Oe(ae,o),{inputType:d,objectKey:l}=je(o,u);$e(e?.expectedBucketOwner);const p=d===k?i+l:l,{contentDisposition:f,contentEncoding:g,contentType:h="application/octet-stream",preventOverwrite:y,metadata:m,checksumAlgorithm:b,onProgress:w,expectedBucketOwner:C}=e??{},S=b===x?await Gn(t):void 0,E=!S&&c?await _e(t):void 0,{ETag:v,VersionId:I}=await Mn({...s,abortSignal:r,onUploadProgress:w,userAgentValue:Dn(we.UploadData)},{Bucket:n,Key:p,Body:t,ContentType:h,ContentDisposition:Wn(f),ContentEncoding:g,Metadata:m,ContentMD5:E,ChecksumCRC32:S?.checksum,ExpectedBucketOwner:C,IfNoneMatch:y?"*":void 0}),A={eTag:v,versionId:I,contentType:h,metadata:m,size:a};return d===k?{key:l,...A}:{path:l,...A}}),onCancel:e=>{t.abort(e)}})}{const{multipartUploadJob:t,onPause:o,onResume:r,onCancel:a}=lo(e,n);return P({isMultipartUpload:!0,job:t,onCancel:e=>{a(e)},onPause:o,onResume:r})}var o,r,a};function yo(e){return ho({...e,options:{...e?.options,resumableUploadsCache:l}})}n(992),n(616);const mo=async(e,t)=>{const n=new Ve(t.url.toString());return Vt(!!e.Key,"Key"),n.pathname=Wt(n,e.Key),Ft({bucketName:e.Bucket,key:e.Key,objectURL:n}),{method:"GET",headers:{...e.Range&&{Range:e.Range},...zt({"x-amz-expected-bucket-owner":e.ExpectedBucketOwner})},url:n}},bo=Fe(Pt,mo,(async e=>{if(e.statusCode>=300){const t=await Nn(e);throw Mt(t,e.statusCode)}return{...Ot(e.headers,{DeleteMarker:["x-amz-delete-marker",Nt],AcceptRanges:"accept-ranges",Expiration:"x-amz-expiration",Restore:"x-amz-restore",LastModified:["last-modified",Rt],ContentLength:["content-length",Tt],ETag:"etag",ChecksumCRC32:"x-amz-checksum-crc32",ChecksumCRC32C:"x-amz-checksum-crc32c",ChecksumSHA1:"x-amz-checksum-sha1",ChecksumSHA256:"x-amz-checksum-sha256",MissingMeta:["x-amz-missing-meta",Tt],VersionId:"x-amz-version-id",CacheControl:"cache-control",ContentDisposition:"content-disposition",ContentEncoding:"content-encoding",ContentLanguage:"content-language",ContentRange:"content-range",ContentType:"content-type",Expires:["expires",Rt],WebsiteRedirectLocation:"x-amz-website-redirect-location",ServerSideEncryption:"x-amz-server-side-encryption",SSECustomerAlgorithm:"x-amz-server-side-encryption-customer-algorithm",SSECustomerKeyMD5:"x-amz-server-side-encryption-customer-key-md5",SSEKMSKeyId:"x-amz-server-side-encryption-aws-kms-key-id",BucketKeyEnabled:["x-amz-server-side-encryption-bucket-key-enabled",Nt],StorageClass:"x-amz-storage-class",RequestCharged:"x-amz-request-charged",ReplicationStatus:"x-amz-replication-status",PartsCount:["x-amz-mp-parts-count",Tt],TagCount:["x-amz-tagging-count",Tt],ObjectLockMode:"x-amz-object-lock-mode",ObjectLockRetainUntilDate:["x-amz-object-lock-retain-until-date",Rt],ObjectLockLegalHoldStatus:"x-amz-object-lock-legal-hold"}),Metadata:Bt(e.headers),$metadata:Ge(e),Body:e.body}}),{...Bn,responseType:"blob"}),wo=async(e,t)=>{const n=Bn.endpointResolver(e,t),{url:o,headers:r,method:a}=await mo(t,n);o.searchParams.append(xt,ct),e.userAgentValue&&o.searchParams.append(e.userAgentHeader??"x-amz-user-agent",e.userAgentValue),t.ResponseContentType&&o.searchParams.append("response-content-type",t.ResponseContentType),t.ResponseContentDisposition&&o.searchParams.append("response-content-disposition",t.ResponseContentDisposition);for(const[e,t]of Object.entries(r).sort((([e],[t])=>e.localeCompare(t))))o.searchParams.append(e,t);return(({body:e,method:t="GET",url:n},{expiration:o,...r})=>{const a=ut(r),{accessKeyId:i,credentialScope:s,longDate:c,sessionToken:u}=a,d=new Ve(n);Object.entries({[Qe]:st,[Ze]:`${i}/${s}`,[Ye]:c,[tt]:ot,...o&&{[et]:o.toString()},...u&&{[nt]:u}}).forEach((([e,t])=>{d.searchParams.append(e,t)}));const l={body:e,headers:{[ot]:n.host},method:t,url:d},p=wt(l,a);return d.searchParams.append("X-Amz-Signature",p),d})({method:a,url:o,body:void 0},{signingService:Bn.service,signingRegion:e.region,...Bn,...e})},Co=e=>{const t=new AbortController;return A({job:ko(e,t.signal),onCancel:e=>{t.abort(e)}})},ko=(e,t)=>async()=>{const{options:n}=e,{bucket:o,keyPrefix:r,s3Config:a,identityId:i}=await Oe(ae,e),{inputType:s,objectKey:c}=je(e,i);$e(n?.expectedBucketOwner);const u=s===k?r+c:c;v.debug(`download ${c} from ${u}.`);const{Body:d,LastModified:l,ContentLength:p,ETag:f,Metadata:g,VersionId:h,ContentType:y}=await bo({...a,abortSignal:t,onDownloadProgress:n?.onProgress,userAgentValue:Dn(we.DownloadData)},{Bucket:o,Key:u,...n?.bytesRange&&{Range:`bytes=${n.bytesRange.start}-${n.bytesRange.end}`},ExpectedBucketOwner:n?.expectedBucketOwner}),m={body:d,lastModified:l,size:p,contentType:y,eTag:f,metadata:g,versionId:h};return s===k?{key:c,...m}:{path:c,...m}};function So(e){return Co(e)}const xo=Fe(Pt,((e,t)=>{const n=new Ve(t.url.toString());return Vt(!!e.Key,"Key"),n.pathname=Wt(n,e.Key),Ft({bucketName:e.Bucket,key:e.Key,objectURL:n}),{method:"DELETE",headers:zt({"x-amz-expected-bucket-owner":e.ExpectedBucketOwner}),url:n}}),(async e=>{if(e.statusCode>=300){const t=await Nn(e);throw Mt(t,e.statusCode)}return{...Ot(e.headers,{DeleteMarker:["x-amz-delete-marker",Nt],VersionId:"x-amz-version-id",RequestCharged:"x-amz-request-charged"}),$metadata:Ge(e)}}),{...Bn,responseType:"text"}),Eo=async(e,t)=>{const{s3Config:n,keyPrefix:o,bucket:r,identityId:a}=await Oe(e,t),{inputType:i,objectKey:s}=je(t,a);let c;return $e(t.options?.expectedBucketOwner),i===k?(c=`${o}${s}`,v.debug(`remove "${s}" from "${c}".`)):(c=s,v.debug(`removing object in path "${c}"`)),await xo({...n,userAgentValue:Dn(we.Remove)},{Bucket:r,Key:c,ExpectedBucketOwner:t.options?.expectedBucketOwner}),i===k?{key:s}:{path:s}};function vo(e){return Eo(ae,e)}const Io=e=>decodeURIComponent(e.replace(/\+/g," ")),Ao=e=>e.map(Po),Po=e=>Ot(e,{Prefix:"Prefix"}),_o=e=>e.map(Uo),Uo=e=>Ot(e,{Key:"Key",LastModified:["LastModified",Rt],ETag:"ETag",ChecksumAlgorithm:["ChecksumAlgorithm",e=>Lt(e,Oo)],Size:["Size",Tt],StorageClass:"StorageClass",Owner:["Owner",To]}),Oo=e=>e.map((e=>String(e))),To=e=>Ot(e,{DisplayName:"DisplayName",ID:"ID"}),No=Fe(Pt,((e,t)=>{const n=zt({"x-amz-request-payer":e.RequestPayer,"x-amz-expected-bucket-owner":e.ExpectedBucketOwner}),o=zt({"list-type":"2","continuation-token":e.ContinuationToken,delimiter:e.Delimiter,"encoding-type":e.EncodingType,"fetch-owner":e.FetchOwner,"max-keys":e.MaxKeys,prefix:e.Prefix,"start-after":e.StartAfter}),r=new Ve(t.url.toString());return r.search=new qe(o).toString(),{method:"GET",headers:n,url:r}}),(async e=>{if(e.statusCode>=300){const t=await Nn(e);throw Mt(t,e.statusCode)}{const t=await Sn(e),n=Ot(t,{CommonPrefixes:["CommonPrefixes",e=>Lt(e,Ao)],Contents:["Contents",e=>Lt(e,_o)],ContinuationToken:"ContinuationToken",Delimiter:"Delimiter",EncodingType:"EncodingType",IsTruncated:["IsTruncated",Nt],KeyCount:["KeyCount",Tt],MaxKeys:["MaxKeys",Tt],Name:"Name",NextContinuationToken:"NextContinuationToken",Prefix:"Prefix",StartAfter:"StartAfter"}),o={$metadata:Ge(e),...n};return(e=>{const{IsTruncated:t,KeyCount:n,Contents:o=[],CommonPrefixes:r=[],NextContinuationToken:a}=e,i=t&&!!a||!t&&!a,s=n===o.length+r.length;if(!i||!s)throw new qt})(o),o}}),{...Bn,responseType:"text"}),Ro=1e3,Lo=async(e,t)=>{const{options:n={}}=t,{s3Config:o,bucket:r,keyPrefix:a,identityId:i}=await Oe(e,t),{inputType:s,objectKey:c}=((e,t)=>{if(h(!(e.prefix&&e.path),p.InvalidStorageOperationPrefixInput),(e=>void 0!==e.path)(e)){const{path:n}=e,o="string"==typeof n?n:n({identityId:ze(t)});return h(!o.startsWith("/"),p.InvalidStoragePathInput),{inputType:S,objectKey:o}}return{inputType:C,objectKey:e.prefix??""}})(t,i);$e(n.expectedBucketOwner);const u=s===C;if(n?.listAll&&(n?.pageSize||n?.nextToken)){const e=n;v.debug(`listAll is set to true, ignoring ${e?.pageSize?`pageSize: ${e?.pageSize}`:""} ${e?.nextToken?`nextToken: ${e?.nextToken}`:""}.`)}const d={Bucket:r,Prefix:u?`${a}${c}`:c,MaxKeys:n?.listAll?void 0:n?.pageSize,ContinuationToken:n?.listAll?void 0:n?.nextToken,Delimiter:zo(n),ExpectedBucketOwner:n?.expectedBucketOwner,EncodingType:"url"};v.debug(`listing items from "${d.Prefix}"`);const l={s3Config:o,listParams:d};return n.listAll?u?Bo({...l,generatedPrefix:a}):Do(l):u?Mo({...l,generatedPrefix:a}):$o(l)},Bo=async({s3Config:e,listParams:t,generatedPrefix:n})=>{const o=[];let r=t.ContinuationToken;do{const{items:a,nextToken:i}=await Mo({generatedPrefix:n,s3Config:e,listParams:{...t,ContinuationToken:r,MaxKeys:Ro}});o.push(...a),r=i}while(r);return{items:o}},Mo=async({s3Config:e,listParams:t,generatedPrefix:n})=>{const o={...t};(!o.MaxKeys||o.MaxKeys>Ro)&&(v.debug("defaulting pageSize to 1000."),o.MaxKeys=Ro);const r=await No({...e,userAgentValue:Dn(we.List)},o),a=Go(r);return jo(o,a),a?.Contents?{items:a.Contents.map((e=>({key:n?e.Key.substring(n.length):e.Key,eTag:e.ETag,lastModified:e.LastModified,size:e.Size}))),nextToken:a.NextContinuationToken}:{items:[]}},Do=async({s3Config:e,listParams:t})=>{const n=[],o=[];let r=t.ContinuationToken;do{const{items:a,excludedSubpaths:i,nextToken:s}=await $o({s3Config:e,listParams:{...t,ContinuationToken:r,MaxKeys:Ro}});n.push(...a),o.push(...i??[]),r=s}while(r);return{items:n,excludedSubpaths:o}},$o=async({s3Config:e,listParams:t})=>{const n={...t};(!n.MaxKeys||n.MaxKeys>Ro)&&(v.debug("defaulting pageSize to 1000."),n.MaxKeys=Ro);const o=await No({...e,userAgentValue:Dn(we.List)},n),r=Go(o);jo(n,r);const{Contents:a,NextContinuationToken:i,CommonPrefixes:s}=r,c=s&&Ko(s);return a?{items:a.map((e=>({path:e.Key,eTag:e.ETag,lastModified:e.LastModified,size:e.Size}))),nextToken:i,excludedSubpaths:c}:{items:[],nextToken:i,excludedSubpaths:c}},Ko=e=>e.reduce(((e,{Prefix:t})=>(t&&e.push(t),e)),[]),zo=e=>{if("exclude"===e?.subpathStrategy?.strategy)return e?.subpathStrategy?.delimiter??"/"},jo=(e,t)=>{if(e.Bucket!==t.Name||e.Delimiter!==t.Delimiter||e.MaxKeys!==t.MaxKeys||e.Prefix!==t.Prefix||e.ContinuationToken!==t.ContinuationToken)throw new qt},Go=e=>{if("url"!==e.EncodingType)return e;const t={...e};return["Delimiter","Prefix","StartAfter"].forEach((n=>{const o=e[n];"string"==typeof o&&(t[n]=Io(o))})),e.Contents&&(t.Contents=e.Contents.map((e=>({...e,Key:e.Key?Io(e.Key):e.Key})))),e.CommonPrefixes&&(t.CommonPrefixes=e.CommonPrefixes.map((e=>({...e,Prefix:e.Prefix?Io(e.Prefix):e.Prefix})))),t};function Wo(e){return Lo(ae,e??{})}const Vo=async(e,t,n)=>{const{s3Config:o,bucket:r,keyPrefix:a,identityId:i}=await Oe(e,t),{inputType:s,objectKey:c}=je(t,i);$e(t.options?.expectedBucketOwner);const u=s===k?a+c:c;v.debug(`get properties of ${c} from ${u}`);const d=await Zn({...o,userAgentValue:Dn(n??we.GetProperties)},{Bucket:r,Key:u,ExpectedBucketOwner:t.options?.expectedBucketOwner}),l={contentType:d.ContentType,size:d.ContentLength,eTag:d.ETag,lastModified:d.LastModified,metadata:d.Metadata,versionId:d.VersionId};return s===k?{key:c,...l}:{path:c,...l}};function qo(e){return Vo(ae,e)}const Fo=Fe(Pt,(async(e,t)=>{const n={...await jt(e),...zt({"x-amz-copy-source":e.CopySource,"x-amz-metadata-directive":e.MetadataDirective,"x-amz-copy-source-if-match":e.CopySourceIfMatch,"x-amz-copy-source-if-unmodified-since":e.CopySourceIfUnmodifiedSince?.toUTCString(),"x-amz-source-expected-bucket-owner":e.ExpectedSourceBucketOwner,"x-amz-expected-bucket-owner":e.ExpectedBucketOwner})};((e,t)=>{if([t["x-amz-copy-source"]===e.CopySource,qn(e.MetadataDirective,t["x-amz-metadata-directive"]),qn(e.CopySourceIfMatch,t["x-amz-copy-source-if-match"]),qn(e.CopySourceIfUnmodifiedSince?.toUTCString(),t["x-amz-copy-source-if-unmodified-since"])].some((e=>!e)))throw new qt})(e,n);const o=new Ve(t.url.toString());return Vt(!!e.Key,"Key"),o.pathname=Wt(o,e.Key),Ft({bucketName:e.Bucket,key:e.Key,objectURL:o}),{method:"PUT",headers:n,url:o}}),(async e=>{if(e.statusCode>=300){const t=await Nn(e);throw Mt(t,e.statusCode)}return await Sn(e),{$metadata:Ge(e)}}),{...Bn,responseType:"text"}),Ho=(e,t)=>{h(void 0!==e&&void 0!==t||!t&&!e,p.InvalidCopyOperationStorageBucket)},Jo=async(e,t)=>(e=>Ke(e.source))(t)?Xo(e,t):Qo(e,t),Xo=async(e,t)=>{const{source:n,destination:o}=t;Ho(n.bucket,o.bucket);const{bucket:r}=await Oe(e,{path:t.source.path,options:{locationCredentialsProvider:t.options?.locationCredentialsProvider,...t.source}}),{s3Config:a,bucket:i,identityId:s}=await Oe(e,{path:t.destination.path,options:{locationCredentialsProvider:t.options?.locationCredentialsProvider,customEndpoint:t.options?.customEndpoint,...t.destination}});h(!!n.path,p.NoSourcePath),h(!!o.path,p.NoDestinationPath);const{objectKey:c}=je(n,s),{objectKey:u}=je(o,s);$e(n.expectedBucketOwner),$e(o.expectedBucketOwner);const d=`${r}/${c}`,l=u;return v.debug(`copying "${d}" to "${l}".`),await Yo({source:d,destination:l,bucket:i,s3Config:a,notModifiedSince:t.source.notModifiedSince,eTag:t.source.eTag,expectedSourceBucketOwner:t.source?.expectedBucketOwner,expectedBucketOwner:t.destination?.expectedBucketOwner}),{path:l}},Qo=async(e,t)=>{const{source:n,destination:o}=t;Ho(n.bucket,o.bucket),h(!!n.key,p.NoSourceKey),h(!!o.key,p.NoDestinationKey),$e(n.expectedBucketOwner),$e(o.expectedBucketOwner);const{bucket:r,keyPrefix:a}=await Oe(e,{...t,options:{locationCredentialsProvider:t.options?.locationCredentialsProvider,...t.source}}),{s3Config:i,bucket:s,keyPrefix:c}=await Oe(e,{...t,options:{locationCredentialsProvider:t.options?.locationCredentialsProvider,...t.destination}}),u=`${r}/${a}${n.key}`,d=`${c}${o.key}`;return v.debug(`copying "${u}" to "${d}".`),await Yo({source:u,destination:d,bucket:s,s3Config:i,notModifiedSince:t.source.notModifiedSince,eTag:t.source.eTag,expectedSourceBucketOwner:t.source?.expectedBucketOwner,expectedBucketOwner:t.destination?.expectedBucketOwner}),{key:o.key}},Yo=async({source:e,destination:t,bucket:n,s3Config:o,notModifiedSince:r,eTag:a,expectedSourceBucketOwner:i,expectedBucketOwner:s})=>{await Fo({...o,userAgentValue:Dn(we.Copy)},{Bucket:n,CopySource:e,Key:t,MetadataDirective:"COPY",CopySourceIfMatch:a,CopySourceIfUnmodifiedSince:r,ExpectedSourceBucketOwner:i,ExpectedBucketOwner:s})};function Zo(e){return Jo(ae,e)}const er=async(e,t)=>{const{options:n}=t,{s3Config:o,keyPrefix:r,bucket:a,identityId:i}=await Oe(e,t),{inputType:s,objectKey:c}=je(t,i);$e(n?.expectedBucketOwner);const u=s===k?r+c:c;n?.validateObjectExistence&&await Vo(e,t,we.GetUrl);let d=n?.expiresIn??900;const l="function"==typeof o.credentials?await o.credentials():o.credentials,f=l.expiration;if(f){const e=Math.floor((f.getTime()-Date.now())/1e3);d=Math.min(e,d)}return h(d<=604800,p.UrlExpirationMaxLimitExceed),{url:await wo({...o,credentials:l,expiration:d},{Bucket:a,Key:u,...n?.contentDisposition&&{ResponseContentDisposition:Wn(n.contentDisposition)},...n?.contentType&&{ResponseContentType:n.contentType},ExpectedBucketOwner:n?.expectedBucketOwner}),expiresAt:new Date(Date.now()+1e3*d)}};function tr(e){return er(ae,e)}})(),o})()));
//# sourceMappingURL=aws-amplify.min.js.map